var QRCode=function(){var n=function(C,s){var K=236;var J=17;var w=C;var y=i[s];var u=null;var F=0;var q=null;var A=new Array();var G={};var D=function(M,L){F=w*4+17;u=function(Q){var O=new Array(Q);for(var P=0;P<Q;P+=1){O[P]=new Array(Q);for(var N=0;N<Q;N+=1){O[P][N]=null;}}return O;}(F);z(0,0);z(F-7,0);z(0,F-7);B();r();I(M,L);if(w>=7){x(M);}if(q==null){q=t(w,y,A);}E(q,L);};var z=function(N,L){for(var M=-1;M<=7;M+=1){if(N+M<=-1||F<=N+M){continue;}for(var O=-1;O<=7;O+=1){if(L+O<=-1||F<=L+O){continue;}if((0<=M&&M<=6&&(O==0||O==6))||(0<=O&&O<=6&&(M==0||M==6))||(2<=M&&M<=4&&2<=O&&O<=4)){u[N+M][L+O]=true;}else{u[N+M][L+O]=false;}}}};var v=function(){var O=0;var N=0;for(var M=0;M<8;M+=1){D(true,M);var L=h.getLostPoint(G);if(M==0||O>L){O=L;N=M;}}return N;};var r=function(){for(var L=8;L<F-8;L+=1){if(u[L][6]!=null){continue;}u[L][6]=(L%2==0);}for(var M=8;M<F-8;M+=1){if(u[6][M]!=null){continue;}u[6][M]=(M%2==0);}};var B=function(){var R=h.getPatternPosition(w);for(var N=0;N<R.length;N+=1){for(var M=0;M<R.length;M+=1){var P=R[N];var L=R[M];if(u[P][L]!=null){continue;}for(var O=-2;O<=2;O+=1){for(var Q=-2;Q<=2;Q+=1){if(O==-2||O==2||Q==-2||Q==2||(O==0&&Q==0)){u[P+O][L+Q]=true;}else{u[P+O][L+Q]=false;}}}}}};var x=function(O){var N=h.getBCHTypeNumber(w);for(var M=0;M<18;M+=1){var L=(!O&&((N>>M)&1)==1);u[Math.floor(M/3)][M%3+F-8-3]=L;}for(var M=0;M<18;M+=1){var L=(!O&&((N>>M)&1)==1);u[M%3+F-8-3][Math.floor(M/3)]=L;}};var I=function(Q,P){var O=(y<<3)|P;var N=h.getBCHTypeInfo(O);for(var M=0;M<15;M+=1){var L=(!Q&&((N>>M)&1)==1);if(M<6){u[M][8]=L;}else{if(M<8){u[M+1][8]=L;}else{u[F-15+M][8]=L;}}}for(var M=0;M<15;M+=1){var L=(!Q&&((N>>M)&1)==1);if(M<8){u[8][F-M-1]=L;}else{if(M<9){u[8][15-M-1+1]=L;}else{u[8][15-M-1]=L;}}}u[F-8][8]=(!Q);};var E=function(Q,M){var O=-1;var V=F-1;var P=7;var L=0;var T=h.getMaskFunction(M);for(var N=F-1;N>0;N-=2){if(N==6){N-=1;}while(true){for(var S=0;S<2;S+=1){if(u[V][N-S]==null){var R=false;if(L<Q.length){R=(((Q[L]>>>P)&1)==1);}var U=T(V,N-S);if(U){R=!R;}u[V][N-S]=R;P-=1;if(P==-1){L+=1;P=7;}}}V+=O;if(V<0||F<=V){V-=O;O=-O;break;}}}};var H=function(V,Y){var N=0;var ab=0;var Z=0;var M=new Array(Y.length);var Q=new Array(Y.length);for(var T=0;T<Y.length;T+=1){var U=Y[T].dataCount;var L=Y[T].totalCount-U;ab=Math.max(ab,U);Z=Math.max(Z,L);M[T]=new Array(U);for(var W=0;W<M[T].length;W+=1){M[T][W]=255&V.getBuffer()[W+N];}N+=U;var R=h.getErrorCorrectPolynomial(L);var aa=e(M[T],R.getLength()-1);var O=aa.mod(R);Q[T]=new Array(R.getLength()-1);for(var W=0;W<Q[T].length;W+=1){var S=W+O.getLength()-Q[T].length;Q[T][W]=(S>=0)?O.get(S):0;}}var X=0;for(var W=0;W<Y.length;W+=1){X+=Y[W].totalCount;}var ac=new Array(X);var P=0;for(var W=0;W<ab;W+=1){for(var T=0;T<Y.length;T+=1){if(W<M[T].length){ac[P]=M[T][W];P+=1;}}}for(var W=0;W<Z;W+=1){for(var T=0;T<Y.length;T+=1){if(W<Q[T].length){ac[P]=Q[T][W];P+=1;}}}return ac;};var t=function(S,R,O){var M=g.getRSBlocks(S,R);var L=f();for(var N=0;N<O.length;N+=1){var Q=O[N];L.put(Q.getMode(),4);L.put(Q.getLength(),h.getLengthInBits(Q.getMode(),S));Q.write(L);}var P=0;for(var N=0;N<M.length;N+=1){P+=M[N].dataCount;}if(L.getLengthInBits()>P*8){throw new Error("code length overflow. ("+L.getLengthInBits()+">"+P*8+")");}if(L.getLengthInBits()+4<=P*8){L.put(0,4);}while(L.getLengthInBits()%8!=0){L.putBit(false);}while(true){if(L.getLengthInBits()>=P*8){break;}L.put(K,8);if(L.getLengthInBits()>=P*8){break;}L.put(J,8);}return H(L,M);};G.addData=function(M){var L=m(M);A.push(L);q=null;};G.isDark=function(M,L){if(M<0||F<=M||L<0||F<=L){throw new Error(M+","+L);}return u[M][L];};G.getModuleCount=function(){return F;};G.make=function(){D(false,v());};G.createTableTag=function(P,N){P=P||2;N=(typeof N=="undefined")?P*4:N;var L="";L+='<table style="';L+=" border-width: 0px; border-style: none;";L+=" border-collapse: collapse;";L+=" padding: 0px; margin: "+N+"px;";L+='">';L+="<tbody>";for(var M=0;M<G.getModuleCount();M+=1){L+="<tr>";for(var O=0;O<G.getModuleCount();O+=1){L+='<td style="';L+=" border-width: 0px; border-style: none;";L+=" border-collapse: collapse;";L+=" padding: 0px; margin: 0px;";L+=" width: "+P+"px;";L+=" height: "+P+"px;";L+=" background-color: ";L+=G.isDark(M,O)?"#000000":"#ffffff";L+=";";L+='"/>';}L+="</tr>";}L+="</tbody>";L+="</table>";return L;};G.createImgTag=function(P,O){P=P||2;O=(typeof O=="undefined")?P*4:O;var N=G.getModuleCount()*P+O*2;var M=O;var L=N-O;return d(N,N,function(Q,T){if(M<=Q&&Q<L&&M<=T&&T<L){var S=Math.floor((Q-M)/P);var R=Math.floor((T-M)/P);return G.isDark(R,S)?0:1;}else{return 1;}});};G.createBase64=function(P,O){P=P||2;O=(typeof O=="undefined")?P*4:O;var N=G.getModuleCount()*P+O*2;var M=O;var L=N-O;return[o(N,N,function(Q,T){if(M<=Q&&Q<L&&M<=T&&T<L){var S=Math.floor((Q-M)/P);var R=Math.floor((T-M)/P);return G.isDark(R,S)?0:1;}else{return 1;}}),N];};return G;};n.stringToBytes=function(t){var q=new Array();for(var r=0;r<t.length;r+=1){var u=t.charCodeAt(r);q.push(u&255);}return q;};n.createStringToBytes=function(t,s){var r=function(){var E=a(t);var u=function(){var v=E.read();if(v==-1){throw new Error();}return v;};var x=0;var y={};while(true){var C=E.read();if(C==-1){break;}var B=u();var A=u();var z=u();var w=String.fromCharCode((C<<8)|B);var D=(A<<8)|z;y[w]=D;x+=1;}if(x!=s){throw new Error(x+" != "+s);}return y;}();var q="?".charCodeAt(0);return function(x){var v=new Array();for(var w=0;w<x.length;w+=1){var y=x.charCodeAt(w);if(y<128){v.push(y);}else{var u=r[x.charAt(w)];if(typeof u=="number"){if((u&255)==u){v.push(u);}else{v.push(u>>>8);v.push(u&255);}}else{v.push(q);}}}return v;};};var j={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var i={L:1,M:0,Q:3,H:2};var c={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var h=function(){var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];var q=(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0);var v=(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0);var s=(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1);var u={};var r=function(w){var x=0;while(w!=0){x+=1;w>>>=1;}return x;};u.getBCHTypeInfo=function(w){var x=w<<10;while(r(x)-r(q)>=0){x^=(q<<(r(x)-r(q)));}return((w<<10)|x)^s;};u.getBCHTypeNumber=function(w){var x=w<<12;while(r(x)-r(v)>=0){x^=(v<<(r(x)-r(v)));}return(w<<12)|x;};u.getPatternPosition=function(w){return t[w-1];};u.getMaskFunction=function(w){switch(w){case c.PATTERN000:return function(y,x){return(y+x)%2==0;};case c.PATTERN001:return function(y,x){return y%2==0;};case c.PATTERN010:return function(y,x){return x%3==0;};case c.PATTERN011:return function(y,x){return(y+x)%3==0;};case c.PATTERN100:return function(y,x){return(Math.floor(y/2)+Math.floor(x/3))%2==0;};case c.PATTERN101:return function(y,x){return(y*x)%2+(y*x)%3==0;};case c.PATTERN110:return function(y,x){return((y*x)%2+(y*x)%3)%2==0;};case c.PATTERN111:return function(y,x){return((y*x)%3+(y+x)%2)%2==0;};default:throw new Error("bad maskPattern:"+w);}};u.getErrorCorrectPolynomial=function(x){var w=e([1],0);for(var y=0;y<x;y+=1){w=w.multiply(e([1,p.gexp(y)],0));}return w;};u.getLengthInBits=function(x,w){if(1<=w&&w<10){switch(x){case j.MODE_NUMBER:return 10;case j.MODE_ALPHA_NUM:return 9;case j.MODE_8BIT_BYTE:return 8;case j.MODE_KANJI:return 8;default:throw new Error("mode:"+x);}}else{if(w<27){switch(x){case j.MODE_NUMBER:return 12;case j.MODE_ALPHA_NUM:return 11;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 10;default:throw new Error("mode:"+x);}}else{if(w<41){switch(x){case j.MODE_NUMBER:return 14;case j.MODE_ALPHA_NUM:return 13;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 12;default:throw new Error("mode:"+x);}}else{throw new Error("type:"+w);}}}};u.getLostPoint=function(F){var y=F.getModuleCount();var z=0;for(var H=0;H<y;H+=1){for(var x=0;x<y;x+=1){var E=0;var D=F.isDark(H,x);for(var w=-1;w<=1;w+=1){if(H+w<0||y<=H+w){continue;}for(var C=-1;C<=1;C+=1){if(x+C<0||y<=x+C){continue;}if(w==0&&C==0){continue;}if(D==F.isDark(H+w,x+C)){E+=1;}}}if(E>5){z+=(3+E-5);}}}for(var H=0;H<y-1;H+=1){for(var x=0;x<y-1;x+=1){var A=0;if(F.isDark(H,x)){A+=1;}if(F.isDark(H+1,x)){A+=1;}if(F.isDark(H,x+1)){A+=1;}if(F.isDark(H+1,x+1)){A+=1;}if(A==0||A==4){z+=3;}}}for(var H=0;H<y;H+=1){for(var x=0;x<y-6;x+=1){if(F.isDark(H,x)&&!F.isDark(H,x+1)&&F.isDark(H,x+2)&&F.isDark(H,x+3)&&F.isDark(H,x+4)&&!F.isDark(H,x+5)&&F.isDark(H,x+6)){z+=40;}}}for(var x=0;x<y;x+=1){for(var H=0;H<y-6;H+=1){if(F.isDark(H,x)&&!F.isDark(H+1,x)&&F.isDark(H+2,x)&&F.isDark(H+3,x)&&F.isDark(H+4,x)&&!F.isDark(H+5,x)&&F.isDark(H+6,x)){z+=40;}}}var G=0;for(var x=0;x<y;x+=1){for(var H=0;H<y;H+=1){if(F.isDark(H,x)){G+=1;}}}var B=Math.abs(100*G/y/y-50)/5;z+=B*10;return z;};return u;}();var p=function(){var q=new Array(256);var s=new Array(256);for(var r=0;r<8;r+=1){q[r]=1<<r;}for(var r=8;r<256;r+=1){q[r]=q[r-4]^q[r-5]^q[r-6]^q[r-8];}for(var r=0;r<255;r+=1){s[q[r]]=r;}var t={};t.glog=function(u){if(u<1){throw new Error("glog("+u+")");}return s[u];};t.gexp=function(u){while(u<0){u+=255;}while(u>=256){u-=255;}return q[u];};return t;}();function e(r,q){if(typeof r.length=="undefined"){throw new Error(r.length+"/"+q);}var s=function(){var w=0;while(w<r.length&&r[w]==0){w+=1;}var v=new Array(r.length-w+q);for(var u=0;u<r.length-w;u+=1){v[u]=r[u+w];}return v;}();var t={};t.get=function(u){return s[u];};t.getLength=function(){return s.length;};t.multiply=function(x){var v=new Array(t.getLength()+x.getLength()-1);for(var w=0;w<t.getLength();w+=1){for(var u=0;u<x.getLength();u+=1){v[w+u]^=p.gexp(p.glog(t.get(w))+p.glog(x.get(u)));}}return e(v,0);};t.mod=function(x){if(t.getLength()-x.getLength()<0){return t;}var w=p.glog(t.get(0))-p.glog(x.get(0));var u=new Array(t.getLength());for(var v=0;v<t.getLength();v+=1){u[v]=t.get(v);}for(var v=0;v<x.getLength();v+=1){u[v]^=p.gexp(p.glog(x.get(v))+w);}return e(u,0).mod(x);};return t;}var g=function(){var r=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16]];var q=function(u,v){var w={};w.totalCount=u;w.dataCount=v;return w;};var t={};var s=function(v,u){switch(u){case i.L:return r[(v-1)*4+0];case i.M:return r[(v-1)*4+1];case i.Q:return r[(v-1)*4+2];case i.H:return r[(v-1)*4+3];default:return undefined;}};t.getRSBlocks=function(w,C){var v=s(w,C);if(typeof v=="undefined"){throw new Error("bad rs block @ typeNumber:"+w+"/errorCorrectLevel:"+C);}var u=v.length/3;var A=new Array();for(var y=0;y<u;y+=1){var z=v[y*3+0];var D=v[y*3+1];var B=v[y*3+2];for(var x=0;x<z;x+=1){A.push(q(D,B));}}return A;};return t;}();var f=function(){var q=new Array();var s=0;var r={};r.getBuffer=function(){return q;};r.get=function(t){var u=Math.floor(t/8);return((q[u]>>>(7-t%8))&1)==1;};r.put=function(t,v){for(var u=0;u<v;u+=1){r.putBit(((t>>>(v-u-1))&1)==1);}};r.getLengthInBits=function(){return s;};r.putBit=function(u){var t=Math.floor(s/8);if(q.length<=t){q.push(0);}if(u){q[t]|=(128>>>(s%8));}s+=1;};return r;};var m=function(t){var s=j.MODE_8BIT_BYTE;var q=t;var r=n.stringToBytes(t);var u={};u.getMode=function(){return s;};u.getLength=function(v){return r.length;};u.write=function(v){for(var w=0;w<r.length;w+=1){v.put(r[w],8);}};return u;};var k=function(){var q=new Array();var r={};r.writeByte=function(s){q.push(s&255);};r.writeShort=function(s){r.writeByte(s);r.writeByte(s>>>8);};r.writeBytes=function(t,v,s){v=v||0;s=s||t.length;for(var u=0;u<s;u+=1){r.writeByte(t[u+v]);}};r.writeString=function(u){for(var t=0;t<u.length;t+=1){r.writeByte(u.charCodeAt(t));}};r.toByteArray=function(){return q;};r.toString=function(){var u="";u+="[";for(var t=0;t<q.length;t+=1){if(t>0){u+=",";}u+=q[t];}u+="]";return u;};return r;};var b=function(){var r=0;var u=0;var w=0;var q="";var v={};var t=function(x){q+=String.fromCharCode(s(x&63));};var s=function(x){if(x<0){}else{if(x<26){return 65+x;}else{if(x<52){return 97+(x-26);}else{if(x<62){return 48+(x-52);}else{if(x==62){return 43;}else{if(x==63){return 47;}}}}}}throw new Error("n:"+x);};v.writeByte=function(x){r=(r<<8)|(x&255);u+=8;w+=1;while(u>=6){t(r>>>(u-6));u-=6;}};v.flush=function(){if(u>0){t(r<<(6-u));r=0;u=0;}if(w%3!=0){var y=3-w%3;for(var x=0;x<y;x+=1){q+="=";}}};v.toString=function(){return q;};return v;};var a=function(u){var w=u;var q=0;var r=0;var s=0;var v={};v.read=function(){while(s<8){if(q>=w.length){if(s==0){return -1;}throw new Error("unexpected end of file./"+s);}var y=w.charAt(q);q+=1;if(y=="="){s=0;return -1;}else{if(y.match(/^\s$/)){continue;}}r=(r<<6)|t(y.charCodeAt(0));s+=6;}var x=(r>>>(s-8))&255;s-=8;return x;};var t=function(x){if(65<=x&&x<=90){return x-65;}else{if(97<=x&&x<=122){return x-97+26;}else{if(48<=x&&x<=57){return x-48+52;}else{if(x==43){return 62;}else{if(x==47){return 63;}else{throw new Error("c:"+x);}}}}}};return v;};var l=function(q,x){var t=q;var u=x;var r=new Array(q*x);var v={};v.setPixel=function(z,B,A){r[B*t+z]=A;};v.write=function(A){A.writeString("GIF87a");A.writeShort(t);A.writeShort(u);A.writeByte(128);A.writeByte(0);A.writeByte(0);A.writeByte(0);A.writeByte(0);A.writeByte(0);A.writeByte(255);A.writeByte(255);A.writeByte(255);A.writeString(",");A.writeShort(0);A.writeShort(0);A.writeShort(t);A.writeShort(u);A.writeByte(0);var B=2;var z=s(B);A.writeByte(B);var C=0;while(z.length-C>255){A.writeByte(255);A.writeBytes(z,C,255);C+=255;}A.writeByte(z.length-C);A.writeBytes(z,C,z.length-C);A.writeByte(0);A.writeString(";");};var w=function(A){var B=A;var C=0;var z=0;var D={};D.write=function(F,E){if((F>>>E)!=0){throw new Error("length over");}while(C+E>=8){B.writeByte(255&((F<<C)|z));E-=(8-C);F>>>=(8-C);z=0;C=0;}z=(F<<C)|z;C=C+E;};D.flush=function(){if(C>0){B.writeByte(z);}};return D;};var s=function(A){var E=1<<A;var C=(1<<A)+1;var G=A+1;var I=y();for(var D=0;D<E;D+=1){I.add(String.fromCharCode(D));}I.add(String.fromCharCode(E));I.add(String.fromCharCode(C));var B=k();var z=w(B);z.write(E,G);var H=0;var J=String.fromCharCode(r[H]);H+=1;while(H<r.length){var F=String.fromCharCode(r[H]);H+=1;if(I.contains(J+F)){J=J+F;}else{z.write(I.indexOf(J),G);if(I.size()<4095){if(I.size()==(1<<G)){G+=1;}I.add(J+F);}J=F;}}z.write(I.indexOf(J),G);z.write(C,G);z.flush();return B.toByteArray();};var y=function(){var A={};var z=0;var B={};B.add=function(C){if(B.contains(C)){throw new Error("dup key:"+C);}A[C]=z;z+=1;};B.size=function(){return z;};B.indexOf=function(C){return A[C];};B.contains=function(C){return typeof A[C]!="undefined";};return B;};return v;};var o=function(q,B,v){var t=l(q,B);for(var w=0;w<B;w+=1){for(var A=0;A<q;A+=1){t.setPixel(A,w,v(A,w));}}var z=k();t.write(z);var u=b();var C=z.toByteArray();for(var s=0;s<C.length;s+=1){u.writeByte(C[s]);}u.flush();var r="";r+="data:image/gif;base64,";r+=u;return r;};var d=function(t,q,v,u){var r=o(t,q,v);var s="";s+="<img";s+='\u0020src="';s+=r;s+='"';s+='\u0020width="';s+=t;s+='"';s+='\u0020height="';s+=q;s+='"';if(u){s+='\u0020alt="';s+=u;s+='"';}s+="/>";return s;};return n;}();Ext.define("Ext.device.communicator.Default",{SERVER_URL:"http://localhost:3000",callbackDataMap:{},callbackIdMap:{},idSeed:0,globalScopeId:"0",generateId:function(){return String(++this.idSeed);},getId:function(a){var b=a.$callbackId;if(!b){a.$callbackId=b=this.generateId();}return b;},getCallbackId:function(h,d){var c=this.callbackIdMap,b=this.callbackDataMap,g,a,f,e;if(!d){a=this.globalScopeId;}else{if(d.isIdentifiable){a=d.getId();}else{a=this.getId(d);}}f=this.getId(h);if(!c[a]){c[a]={};}if(!c[a][f]){g=this.generateId();e={callback:h,scope:d};c[a][f]=g;b[g]=e;}return c[a][f];},getCallbackData:function(a){return this.callbackDataMap[a];},invoke:function(c,a){var b=this.getCallbackData(c);b.callback.apply(b.scope,a);},send:function(b){var d,c,a,e;if(!b){b={};}else{if(b.callbacks){d=b.callbacks;c=b.scope;delete b.callbacks;delete b.scope;for(a in d){if(d.hasOwnProperty(a)){e=d[a];if(typeof e=="function"){b[a]=this.getCallbackId(e,c);}}}}}this.doSend(b);},doSend:function(a){var b=new XMLHttpRequest();b.open("GET",this.SERVER_URL+"?"+Ext.Object.toQueryString(a),false);b.send(null);}});Ext.define("Ext.device.communicator.Android",{extend:"Ext.device.communicator.Default",doSend:function(a){window.Sencha.action(JSON.stringify(a));}});Ext.define("Ext.device.Communicator",{requires:["Ext.device.communicator.Default","Ext.device.communicator.Android"],singleton:true,constructor:function(){if(Ext.os.is.Android){return new Ext.device.communicator.Android();}return new Ext.device.communicator.Default();}});Ext.define("Ext.device.camera.Abstract",{source:{library:0,camera:1,album:2},destination:{data:0,file:1},encoding:{jpeg:0,jpg:0,png:1},capture:Ext.emptyFn});Ext.define("Ext.device.camera.PhoneGap",{extend:"Ext.device.camera.Abstract",capture:function(j){var h=j.success,d=j.failure,l=j.scope,b=this.source,f=this.destination,i=this.encoding,a=j.source,k=j.destination,c=j.encoding,m={};if(l){h=Ext.Function.bind(h,l);d=Ext.Function.bind(d,l);}if(a!==undefined){m.sourceType=b.hasOwnProperty(a)?b[a]:a;}if(k!==undefined){m.destinationType=f.hasOwnProperty(k)?f[k]:k;}if(c!==undefined){m.encodingType=i.hasOwnProperty(c)?i[c]:c;}if("quality" in j){m.quality=j.quality;}if("width" in j){m.targetWidth=j.width;}if("height" in j){m.targetHeight=j.height;}try{navigator.camera.getPicture(h,d,m);}catch(g){alert(g);}}});Ext.define("Ext.device.camera.Sencha",{extend:"Ext.device.camera.Abstract",requires:["Ext.device.Communicator"],capture:function(d){var c=this.source,b=this.destination,f=this.encoding,g=d.source,a=d.destination,e=d.encoding;if(c.hasOwnProperty(g)){g=c[g];}if(b.hasOwnProperty(a)){a=b[a];}if(f.hasOwnProperty(e)){e=f[e];}Ext.device.Communicator.send({command:"Camera#capture",callbacks:{success:d.success,failure:d.failure},scope:d.scope,quality:d.quality,width:d.width,height:d.height,source:g,destination:a,encoding:e});}});Ext.define("Ext.device.camera.Simulator",{extend:"Ext.device.camera.Abstract",config:{samples:[{success:"http://www.sencha.com/img/sencha-large.png"}]},constructor:function(a){this.initConfig(a);},updateSamples:function(a){this.sampleIndex=0;},capture:function(d){var c=this.sampleIndex,b=this.getSamples(),g=b.length,f=b[c],e=d.scope,h=d.success,a=d.failure;if("success" in f){if(h){h.call(e,f.success);}}else{if(a){a.call(e,f.failure);}}if(++c>g-1){c=0;}this.sampleIndex=c;}});Ext.define("Ext.device.connection.Abstract",{extend:"Ext.Evented",config:{online:false,type:null},UNKNOWN:"Unknown connection",ETHERNET:"Ethernet connection",WIFI:"WiFi connection",CELL_2G:"Cell 2G connection",CELL_3G:"Cell 3G connection",CELL_4G:"Cell 4G connection",NONE:"No network connection",isOnline:function(){return this.getOnline();}});Ext.define("Ext.device.connection.PhoneGap",{extend:"Ext.device.connection.Abstract",syncOnline:function(){var a=navigator.network.connection.type;this._type=a;this._online=a!=Connection.NONE;},getOnline:function(){this.syncOnline();return this._online;},getType:function(){this.syncOnline();return this._type;}});Ext.define("Ext.device.connection.Sencha",{extend:"Ext.device.connection.Abstract",initialize:function(){Ext.device.Communicator.send({command:"Connection#watch",callbacks:{callback:this.onConnectionChange},scope:this});},onConnectionChange:function(a){this.setOnline(Boolean(a.online));this.setType(this[a.type]);this.fireEvent("onlinechange",this.getOnline(),this.getType());}});Ext.define("Ext.device.connection.Simulator",{extend:"Ext.device.connection.Abstract",getOnline:function(){this._online=navigator.onLine;this._type=Ext.device.Connection.UNKNOWN;return this._online;}});Ext.define("Ext.device.notification.Abstract",{show:function(a){if(!a.message){throw ("[Ext.device.Notification#show] You passed no message");}if(!a.buttons){a.buttons="OK";}if(!Ext.isArray(a.buttons)){a.buttons=[a.buttons];}if(!a.scope){a.scope=this;}return a;},vibrate:Ext.emptyFn});Ext.define("Ext.device.notification.PhoneGap",{extend:"Ext.device.notification.Abstract",requires:["Ext.device.Communicator"],show:function(){var b=this.callParent(arguments),c=(b.buttons)?b.buttons.join(","):null,a=function(d){if(b.callback){b.callback.apply(b.scope,(b.buttons)?[b.buttons[d-1]]:[]);}};navigator.notification.confirm(b.message,a,b.title,c);},vibrate:function(){navigator.notification.vibrate(2000);}});Ext.define("Ext.device.notification.Sencha",{extend:"Ext.device.notification.Abstract",requires:["Ext.device.Communicator"],show:function(){var a=this.callParent(arguments);Ext.device.Communicator.send({command:"Notification#show",callbacks:{callback:a.callback},scope:a.scope,title:a.title,message:a.message,buttons:a.buttons.join(",")});},vibrate:function(){Ext.device.Communicator.send({command:"Notification#vibrate"});}});Ext.define("Ext.device.notification.Simulator",{extend:"Ext.device.notification.Abstract",requires:["Ext.MessageBox"],msg:null,show:function(){var a=this.callParent(arguments),e=[],d=a.buttons.length,c,b,g,f;for(b=0;b<d;b++){c=a.buttons[b];if(Ext.isString(c)){c={text:a.buttons[b],itemId:a.buttons[b].toLowerCase()};}e.push(c);}this.msg=Ext.create("Ext.MessageBox");f=this.msg;g=function(h){if(a.callback){a.callback.apply(a.scope,[h]);}};this.msg.show({title:a.title,message:a.message,scope:this.msg,buttons:e,fn:g});},vibrate:function(){var c=["@-webkit-keyframes vibrate{","    from {","        -webkit-transform: rotate(-2deg);","    }","    to{","        -webkit-transform: rotate(2deg);","    }","}","body {","    -webkit-animation: vibrate 50ms linear 10 alternate;","}"];var b=document.getElementsByTagName("head")[0];var a=document.createElement("style");a.innerHTML=c.join("\n");b.appendChild(a);setTimeout(function(){b.removeChild(a);},400);}});Ext.define("Ext.device.orientation.Abstract",{extend:"Ext.EventedBase",onDeviceOrientation:function(a){this.doFireEvent("orientationchange",[a]);}});Ext.define("Ext.device.orientation.HTML5",{extend:"Ext.device.orientation.Abstract",initialize:function(){this.onDeviceOrientation=Ext.Function.bind(this.onDeviceOrientation,this);window.addEventListener("deviceorientation",this.onDeviceOrientation,true);}});Ext.define("Ext.device.orientation.Sencha",{extend:"Ext.device.orientation.Abstract",requires:["Ext.device.Communicator"],initialize:function(){Ext.device.Communicator.send({command:"Orientation#watch",callbacks:{callback:this.onDeviceOrientation},scope:this});}});Ext.define("Ext.device.Notification",{singleton:true,requires:["Ext.device.Communicator","Ext.device.notification.PhoneGap","Ext.device.notification.Sencha","Ext.device.notification.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.notification.PhoneGap");}else{return Ext.create("Ext.device.notification.Sencha");}}else{return Ext.create("Ext.device.notification.Simulator");}}});Ext.define("Ext.device.Connection",{singleton:true,requires:["Ext.device.Communicator","Ext.device.connection.Sencha","Ext.device.connection.PhoneGap","Ext.device.connection.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.connection.PhoneGap");}else{return Ext.create("Ext.device.connection.Sencha");}}else{return Ext.create("Ext.device.connection.Simulator");}}});Ext.define("Ext.device.Camera",{singleton:true,requires:["Ext.device.Communicator","Ext.device.camera.PhoneGap","Ext.device.camera.Sencha","Ext.device.camera.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.camera.PhoneGap");}else{return Ext.create("Ext.device.camera.Sencha");}}else{return Ext.create("Ext.device.camera.Simulator");}}});Ext.define("Ext.device.Orientation",{singleton:true,requires:["Ext.device.Communicator","Ext.device.orientation.HTML5","Ext.device.orientation.Sencha"],constructor:function(){var a=Ext.browser.is;if(a.Sencha){return Ext.create("Ext.device.orientation.Sencha");}else{return Ext.create("Ext.device.orientation.HTML5");}}});(function(){var a=window.PhoneGap||window.Cordova||window.cordova;BarcodeScanner=function(){};BarcodeScanner.Encode={TEXT_TYPE:"TEXT_TYPE",EMAIL_TYPE:"EMAIL_TYPE",PHONE_TYPE:"PHONE_TYPE",SMS_TYPE:"SMS_TYPE",CONTACT_TYPE:"CONTACT_TYPE",LOCATION_TYPE:"LOCATION_TYPE"};BarcodeScanner.prototype.scan=function(e,b,c){function d(f){f.cancelled=(f.cancelled==1);e.call(null,f);}if(!b){b=function(){};}if(typeof b!="function"){console.log("BarcodeScanner.scan failure: failure parameter not a function");return;}if(typeof e!="function"){b("success callback parameter must be a function");return;}if(null==c){c=[];}a.exec(d,b,"BarCodeScanner","scan",c);};BarcodeScanner.prototype.encode=function(d,e,f,b,c){if(!b){b=function(){};}if(typeof b!="function"){console.log("BarcodeScanner.scan failure: failure parameter not a function");return;}if(typeof f!="function"){b("success callback parameter must be a function");return;}return a.exec(f,b,"BarCodeScanner","encode",[{type:d,data:e,options:c}]);};a.addConstructor(function(){if(!window.plugins){window.plugins={};}window.plugins.barcodeScanner=new BarcodeScanner();});})();(function(){var a=window.PhoneGap||window.Cordova||window.cordova;QRCodeReader=function(){};QRCodeReader.ErrorResultType={Cancelled:0,Failed:1,Success:2};QRCodeReader.prototype.scanType="Default";QRCodeReader.prototype.getCode=function(b,c,d){if(typeof b!="function"){console.log("QRCodeReader Error: successCallback is not a function");return;}if(c&&(typeof c!="function")){console.log("QRCodeReader Error: errorCallback is not a function");return;}console.log("ScanType is ["+this.scanType+"]");switch(this.scanType){case"RL":case"Nigma":a.exec(b,c,"QRCodeReader"+this.scanType,"getCode",[]);break;case"Default":window.plugins.barcodeScanner.scan(b,c,d);break;default:a.exec(b,c,"QRCodeReaderRL","getCode",[]);break;}};QRCodeReader.prototype._didNotFinishWithResult=function(b){console.log("ErrorCode = "+b);pluginResult.message=b;return pluginResult;};QRCodeReader.prototype._didFinishWithResult=function(c){var b={response:decodeURIComponent(c.message.response)};c.message=b;return c;};a.addConstructor(function(){if(!window.plugins){window.plugins={};}window.plugins.qrCodeReader=new QRCodeReader();});})();function EmailComposer(){this.resultCallback=null;}EmailComposer.ComposeResultType={Cancelled:0,Saved:1,Sent:2,Failed:3,NotSent:4};EmailComposer.prototype.showEmailComposer=function(e,b,h,g,f,c,a){var d={};if(h){d.toRecipients=h;}if(g){d.ccRecipients=g;}if(f){d.bccRecipients=f;}if(e){d.subject=e;}if(b){d.body=b;}if(c){d.bIsHTML=c;}if(a){d.images=a;}cordova.exec(null,null,"EmailComposer","showEmailComposer",[d]);};EmailComposer.prototype.showEmailComposerWithCB=function(e,d,b,h,g,f,c,a){this.resultCallback=e;this.showEmailComposer.apply(this,[d,b,h,g,f,c,a]);};EmailComposer.prototype._didFinishWithResult=function(a){this.resultCallback(a);};cordova.addConstructor(function(){if(!window.plugins){window.plugins={};}if(!window.Cordova){window.Cordova=cordova;}window.plugins.emailComposer=new EmailComposer();});var LowLatencyAudio={preloadFX:function(d,b,c,a){return cordova.exec(c,a,"LowLatencyAudio","preloadFX",[d,b]);},preloadAudio:function(e,c,b,d,a){return cordova.exec(d,a,"LowLatencyAudio","preloadAudio",[e,c,b]);},play:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","play",[c]);},stop:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","stop",[c]);},loop:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","loop",[c]);},unload:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","unload",[c]);}};Ext.ns("Genesis.constants");Genesis.constants={host:"http://www.getkickbak.com",themeName:"v1",sign_in_path:"/sign_in",sign_out_path:"/sign_out",site:"www.getkickbak.com",fbScope:"email,user_birthday,publish_stream,read_friendlists,publish_actions,offline_access",fbConnectErrorMsg:"Cannot retrive Facebook account information!",fbConnectReqestMsg:"Connection to Facebook is required to complete this action",connectingToFBMsg:"Connecting to Facebook ...",debugPrivKey:"MiQj6tNWvjdPGh2Qlr7gdBIsJAadvAUk",redeemDBSize:10000,isNative:function(){return phoneGapAvailable;},addCRLF:function(){return((!this.isNative())?"<br/>":"\n");},getIconPath:function(b,a){return"resources/themes/images/"+this.themeName+"/"+b+"/"+a+".png";},getLocalStorage:function(){return window.localStorage;},getRedeemIndexDB:function(b){var a=this.getLocalStorage().getItem("kickbakRedeemIndex");return((a)?(b?Ext.decode(a)[b]:Ext.decode(a)):{});},addRedeemIndexDB:function(a){this.getLocalStorage().setItem("kickbakRedeemIndex",Ext.encode(db));},setRedeemIndexDB:function(a){this.getLocalStorage().setItem("kickbakRedeemIndex",Ext.encode(a));},addRedeemSortedDB:function(a){var b=this.getRedeemSortedDB();if(b.length>=this.redeemDBSize){console.debug("Database Entry is full, discarded oldest Entry with timestamp ("+Date(b[0][1])+")");b=b.splice(0,1);}else{b.currCount=(Ext.isDefined(b.currCount))?(b.currCount+1):0;}b.push(a);b=Ext.Array.sort(b,function(d,c){return(d[1]-c[1]);});this.setRedeemSortedDB(b);},getRedeemSortedDB:function(b){var a=this.getLocalStorage().getItem("kickbakRedeemSorted");return((a)?(b?Ext.decode(a)[b]:Ext.decode(a)):[]);},setRedeemSortedDB:function(a){this.getLocalStorage().setItem("kickbakRedeemSorted",Ext.encode(a));},redeemDBCleanup:function(){console.log("================================");console.log("Redeem Database has been Started");console.log("================================");var b=Date.now();dbI=this.getRedeemIndexDB();dbS=this.getRedeemSortedDB();var c=0;var a=dbS.currCount||-1;console.debug("currCount = "+a);while((a>=0)&&(dbS.length>0)){if(dbS[0][1]>b){c++;a--;delete dbI[dbS[0]];dbS=dbS.splice(0,1);dbS.currCount=a;}else{break;}}Genesis.constants.setRedeemIndexDB(dbI);Genesis.constants.setRedeemSortedDB(dbS);console.debug("currCount = "+dbS.currCount+", total = "+c);console.log("=================================");console.log("Redeem Database has been resetted");console.log("=================================");},getLocalDB:function(){var a=this.getLocalStorage().getItem("kickbak");return((a)?Ext.decode(a):{});},setLocalDB:function(a){console.debug("Setting KickBak DB["+Ext.encode(a)+"]");this.getLocalStorage().setItem("kickbak",Ext.encode(a));},setLocalDBAttrib:function(c,b){console.debug("Setting KickBak Attrib["+c+"] to ["+b+"]");var a=this.getLocalDB();a[c]=b;this.setLocalDB(a);},removeLocalDBAttrib:function(b){var a=this.getLocalDB();delete a[b];this.setLocalDB(a);},resetStorage:function(){this.facebook_onLogout(null,false);Genesis.constants.removeLocalDBAttrib("auth_code");},getPrivKey:function(d){var c=this;if(!c.privKey){if(c.isNative()){var a=function(f){var g={};g[FileError.NOT_FOUND_ERR]="File not found";g[FileError.SECURITY_ERR]="Security error";g[FileError.ABORT_ERR]="Abort error";g[FileError.NOT_READABLE_ERR]="Not readable";g[FileError.ENCODING_ERR]="Encoding error";g[FileError.NO_MODIFICATION_ALLOWED_ERR]="No mobification allowed";g[FileError.INVALID_STATE_ERR]="Invalid state";g[FileError.SYFNTAX_ERR]="Syntax error";g[FileError.INVALID_MODIFICATION_ERR]="Invalid modification";g[FileError.QUOTA_EXCEEDED_ERR]="Quota exceeded";g[FileError.TYPE_MISMATCH_ERR]="Type mismatch";g[FileError.PATH_EXISTS_ERR]="Path does not exist";var e={};e[FileTransferError.FILE_NOT_FOUND_ERR]="File not found";e[FileTransferError.INVALID_URL_ERR]="Invalid URL Error";e[FileTransferError.CONNECTION_ERR]="Connection Error";console.log("Reading License File Error - ["+g[f.code]+"]");};window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(f){var e=f.root.fullPath+"/../"+appName+".app/www/resources/keys.txt";console.debug("License File - ["+e+"]");f.root.getFile(e,null,function(g){g.file(function(i){var h=new FileReader();h.onloadend=function(j){c.privKey=Ext.decode(j.target.result);for(var k in c.privKey){console.debug("Encryption Key["+k+"] = ["+c.privKey[k]+"]");}};h.readAsText(i);},a);},a);},a);return null;}else{c.privKey={v1:c.debugPrivKey};for(var b in c.privKey){console.debug("Encryption Key["+b+"] = ["+c.privKey[b]+"]");}}}return(d)?c.privKey["v"+d]:c.privKey;},initFb:function(){var b=this;var a=b.getLocalDB();delete a.fbExpiresIn;b.setLocalDB(a);FB.Event.monitor("auth.authResponseChange",function(d){if(d&&(d.status!="not_authorized")&&(d.status!="notConnected")){console.log("Got FB user's session: "+d.status);var c=d.authResponse.accessToken;if(c){a.fbExpiresIn=Date.now()+(1000*d.authResponse.expiresIn);b.setLocalDB(a);if(b.cb){b.facebook_loginCallback(b.cb);delete b.cb;}}else{delete a.fbExpiresIn;b.setLocalDB(a);b.facebook_onLogout(null,false);}}else{if((d===undefined)||(d&&d.status=="not_authorized")){if(d){b.facebook_onLogout(null,(d)?true:false);}}}});},getFriendsList:function(f){var c="id";var a="name";var e=this;var b=e.getLocalDB();var d=function(g){return"We found "+g+" Friends from your social network!";};FB.api("/me/friends&fields="+a+","+c,function(g){var k="";e.friendsList=[];if(g&&g.data&&(g.data.length>0)){var j=g.data;for(var h=0;h<j.length;h++){if(j[h][c]!=b.currFbId){e.friendsList.push({label:j[h][a],value:j[h][c]});k+=((k.length>0)?",":"")+j[h][c];}}e.friendsList.sort(function(l,i){return l[c]-i[c];});console.log(d(e.friendsList.length));}else{Ext.device.Notification.show({title:"Facebook Connect",message:"You cannot retrieve your Friends List from Facebook. Login and Try Again.",buttons:["Relogin","Cancel"],callback:function(i){if(i=="Relogin"){e.facebook_onLogout(function(){e.fbLogin(cb,false,false);},true);}else{}}});}});},createFbResponse:function(a){var b=a.birthday.split("/");b=b[2]+"-"+b[0]+"-"+b[1];var c={name:a.name,email:a.email,facebook_email:a.email,facebook_id:a.id,facebook_uid:a.username,gender:(a.gender=="male")?"m":"f",birthday:b,photoURL:"http://graph.facebook.com/"+a.id+"/picture?type=square"};return c;},fbLogin:function(a,c,e){var d=this;var b=d.getLocalDB();a=a||Ext.emptyFn;if(!c&&!e){console.debug("Logging into Facebook ...");Ext.Viewport.setMasked({xtype:"loadmask",message:"Logging into Facebook ..."});}else{console.debug("Refresh Connectivity or Logging to Facebook ... refreshConn="+c);}d.cb=a;FB[(c)?"getLoginStatus":"login"](function(f){if((f.status=="connected")&&f.authResponse){console.debug("Logged into Facebook!");b.fbExpiresIn=Date.now()+(1000*f.authResponse.expiresIn);d.setLocalDB(b);if(d.cb){d.facebook_loginCallback(d.cb);delete d.cb;}}else{delete b.fbExpiresIn;d.setLocalDB(b);if(!c){console.debug("Login Failed! ...");if(!e){Ext.Viewport.setMasked(false);Ext.device.Notification.show({title:"Facebook Connect",message:"Failed to login to Facebook!"});}}else{console.debug("Failed to refresh connection to Facebook ...");Ext.defer(d.fbLogin,1,d,[a,false,e]);}}},{scope:d.fbScope});},facebook_onLogin:function(a,h,b,g){var f=this;var c=f.getLocalDB();a=a||Ext.emptyFn;var d=(c.currFbId>0);console.debug("facebook_onLogin - FbId = ["+c.currFbId+"]");if(!b||d){var e=(!c.fbExpiresIn)?0:new Date(c.fbExpiresIn).getTime();console.debug("FB ExpiryDate TimeStamp = "+Date(e));if((d||g)&&(e<Date.now())){Ext.device.Notification.show({title:"Facebook Connect",message:g||f.fbConnectReqestMsg,buttons:["Proceed","Cancel"],callback:function(i){if(i.toLowerCase()=="proceed"){f.fbLogin(a,d,h);}}});}else{Ext.Viewport.setMasked({xtype:"loadmask",message:f.connectingToFBMsg});f.fbLogin(a,d,h);}}},facebook_loginCallback:function(a,d){var c=this;var b=c.getLocalDB();console.debug("Retrieving Facebook profile information ...");d=d||0;a=a||Ext.emptyFn;FB.api("/me",function(e){if(!e.error){if(d>=5){Ext.Viewport.setMasked(false);Ext.device.Notification.show({title:"Facebook Connect",message:c.fbConnectErrorMsg});c.facebook_onLogout(null,true);return;}var f=e.id;if(!f||(f==0)){console.debug("Missing Facebook Session information, Retrying ...");++d;Ext.defer(function(h){c.facebook_loginCallback(a,h);},d*1000,c,[d]);return;}Ext.Viewport.setMasked(false);if(b.currFbId==f){console.debug("Session information same as previous session["+f+"]");}else{console.debug("Session ID["+f+"]");}b.currFbId=f;b.fbAccountId=e.email;var g=c.createFbResponse(e);b.fbResponse=g;Genesis.constants.setLocalDB(b);console.debug("You`ve logged into Facebook! \nEmail("+b.fbAccountId+")\nID("+f+")\n");c._fb_connect();if(a){a(g);}}else{c.facebook_onLogout(null,false);}});},_fb_connect:function(){},facebook_onLogout:function(a,c){var d=this;var b=d.getLocalDB();a=a||Ext.emptyFn;d._fb_disconnect();b.currFbId=0;delete b.fbAccountId;delete b.fbResponse;Genesis.constants.setLocalDB(b);Ext.Viewport.setMasked(false);try{if(c){FB.logout(function(e){a();});}else{a();}}catch(f){a();}}};Genesis.constants._fb_disconnect=Genesis.constants._fb_connect;Genesis.fn={weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],convertDateCommon:function(d,a,h){var e;var g=a||this.dateFormat;if(!(d instanceof Date)){if(typeof(JSON)!="undefined"){}if(Ext.isEmpty(d)){e=new Date();}else{if(g){e=Date.parse(d,g);if(Ext.isEmpty(e)){e=new Date(d).format(g);}return[e,e];}e=new Date(d);if(e.toString()=="Invalid Date"){e=Date.parse(d,g);}}}else{e=d;}if(!h){var c=new Date().getTime();var f=Genesis.constants.currentDateTime(c);var b=(f-e.getTime())/1000;if(b>-10){if((b)<2){return[b,"a second ago"];}if((b)<60){return[b,parseInt(b)+" secs ago"];}b=b/60;if((b)<2){return[b,"a minute ago"];}if((b)<60){return[b,parseInt(b)+" minutes ago"];}b=b/60;if((b)<2){return[e,"an hour ago"];}if((b)<24){return[e,parseInt(b)+" hours ago"];}b=b/24;if(((b)<2)&&((new Date().getDay()-e.getDay())==1)){return[e,"Yesterday at "+e.format("g:i A")];}if((b)<7){return[e,Genesis.fn.weekday[e.getDay()]+" at "+e.format("g:i A")];}b=b/7;if(((b)<2)&&(b%7==0)){return[e,"a week ago"];}if(((b)<5)&&(b%7==0)){return[e,parseInt(b)+" weeks ago"];}if(b<5){return[e,parseInt(b*7)+" days ago"];}return[e,null];}else{}}return[e,-1];},convertDateFullTime:function(a){return a.format("D, M d, Y \\a\\t g:i A");},convertDateReminder:function(c){var b=new Date();var a=b.getDate();var g=b.getMonth();var e=b.getFullYear();var d=c.getDate();var h=c.getMonth();var f=c.getFullYear();if(a==d&&g==h&&e==f){return"Today "+c.format("g:i A");}return c.format("D g:i A");},convertDate:function(b,a){var c=Genesis.fn.convertDateCommon.call(this,b,a);if(c[1]!=-1){return(c[1]==null)?c[0].format("M d, Y"):c[1];}else{return c[0].format("D, M d, Y \\a\\t g:i A");}},convertDateNoTime:function(a){var b=Genesis.fn.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){return(b[1]==null)?b[0].format("D, M d, Y"):b[1];}else{return b[0].format("D, M d, Y");}},convertDateNoTimeNoWeek:function(a){var b=Genesis.fn.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){b=(b[1]==null)?b[0].format("M d, Y"):b[1];}else{b=b[0].format("M d, Y");}return b;},convertDateInMins:function(a){var b=Genesis.fn.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){return(b[1]==null)?b[0].format("h:ia T"):b[1];}else{return b[0].format("h:ia T");}},currentDateTime:function(a){return systemTime+(a-clientTime);},addUnit:function(a){return a+"px";},_removeUnitRegex:/(\d+)px/,removeUnit:function(a){return a.match(this._removeUnitRegex)[1];}};Ext.define("Genesis.dom.Element",{override:"Ext.dom.Element",setMargin:function(b,a){if(b||b===0){b=this.self.unitizeBox((b===true)?5:b,a);}else{b=null;}this.dom.style.margin=b;},setPadding:function(b,a){if(b||b===0){b=this.self.unitizeBox((b===true)?5:b,a);}else{b=null;}this.dom.style.padding=b;},});Ext.define("Genesis.Component",{override:"Ext.Component",updatePadding:function(a){this.innerElement.setPadding(a,this.getInitialConfig().defaultUnit);},updateMargin:function(a){this.element.setMargin(a,this.getInitialConfig().defaultUnit);}});Ext.define("Genesis.util.Collection",{override:"Ext.util.Collection",clear:function(){this.callParent(arguments);this.indices={};}});Ext.define("Genesis.data.reader.Json",{override:"Ext.data.reader.Json",getResponseData:function(a){var b=this.callParent(arguments);if(!b.metaData){delete this.metaData;}return b;}});Ext.define("Genesis.data.proxy.OfflineServer",{override:"Ext.data.proxy.Server",processResponse:function(m,c,f,d,l,o){var j=this,b=c.getAction(),h=j.getReader(),k;var a=_application;var n=a.getController("Viewport");var g=function(){var p=((k&&Ext.isDefined(k.getMessage))?(Ext.isArray(k.getMessage())?k.getMessage().join(Genesis.constants.addCRLF()):k.getMessage()):"Error Connecting to Server");var e=h.metaData||{};Ext.Viewport.setMasked(false);switch(e.rescode){case"server_error":Ext.device.Notification.show({title:"Server Error(s)",message:p,callback:function(){if(e.session_timeout){Genesis.constants.removeLocalDBAttrib("auth_code");n.setLoggedIn(false);n.onFeatureTap("MainPage","login");return;}else{}}});break;case"login_invalid_facebook_info":Ext.device.Notification.show({title:"Create Account",message:"Create user account using Facebook Profile information",callback:function(r){n.setLoggedIn(false);Genesis.constants.removeLocalDBAttrib("auth_code");var q=a.getController("MainPage");a.dispatch({action:"onCreateAccountTap",args:[null,null,null,null],controller:q,scope:q});}});return;case"update_account_invalid_info":case"signup_invalid_info":case"update_account_invalid_facebook_info":case"login_invalid_info":Ext.device.Notification.show({title:"Error",message:p,callback:function(){n.setLoggedIn(false);Genesis.constants.resetStorage();n.onFeatureTap("MainPage","login");}});return;default:Ext.device.Notification.show({title:"Error",message:p});break;}console.debug("Ajax Call Error Handler called. Operation("+c.wasSuccessful()+")");j.fireEvent("exception",j,d,c);};if((m===true)||(Genesis.constants.isNative()===true)){try{k=h.process(d);}catch(i){console.debug("Ajax call is failed message=["+i.message+"] url=["+f.getUrl()+"]");c.setException(c,{status:null,statusText:i.message});g();return;}if(c.process(b,k,f,d)===false){g();}}else{console.debug("Ajax call is failed status=["+d.status+"] url=["+f.getUrl()+"]");j.setException(c,d);g();}if(typeof l=="function"){l.call(o||j,c);}j.afterRequest(f,m);},buildRequest:function(b){var a=Genesis.constants.getLocalDB();if(a.auth_code){this.setExtraParam("auth_token",a.auth_code);}else{delete this.getExtraParams()["auth_token"];}var c=this.callParent(arguments);if(b.initialConfig.jsonData){c.setJsonData(b.initialConfig.jsonData);}return c;}});Ext.define("Genesis.data.Connection",{override:"Ext.data.Connection",parseStatus:function(a){a=a==1223?204:a;var c=(a>=200&&a<300)||a==304,b=false;if(Genesis.constants.isNative()&&(a===0)){c=true;}if(!c){switch(a){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:b=true;break;}}return({success:c,isException:b});}});Ext.define("Genesis.data.association.BelongsTo",{override:"Ext.data.association.BelongsTo",read:function(b,a,c){b[this.getInstanceName()]=a.read(c).getRecords()[0];}});Ext.define("Genesis.field.Select",{override:"Ext.field.Select",getListPanel:function(){if(!this.listPanel){this.listPanel=Ext.create("Ext.Panel",{top:0,left:0,height:"9em",modal:true,cls:Ext.baseCSSPrefix+"select-overlay",layout:"fit",hideOnMaskTap:true,items:{xtype:"list",store:this.getStore(),itemTpl:'<span class="x-list-label">{'+this.getDisplayField()+"}</span>",listeners:{select:this.onListSelect,itemtap:this.onListTap,scope:this}}});}return this.listPanel;}});Ext.define("Genesis.dataview.element.List",{override:"Ext.dataview.element.List",updateListItem:function(b,j){var g=this,c=g.dataview,i=Ext.fly(j),f=i.down(g.labelClsCache,true),a=b.getData(true),d=a&&a.hasOwnProperty("disclosure"),k=a&&a.hasOwnProperty("iconSrc"),e,h;f.innerHTML=c.getItemTpl().apply(a);if(d&&c.getOnItemDisclosure()){e=i.down(g.disclosureClsCache);if(!e){e=i.down(g.disclosureClsCache+g.hiddenDisplayCache);e[d?"removeCls":"addCls"](g.disclosureClsCache+g.hiddenDisplayCache);e.addCls(g.disclosureClsCache);}else{e[d?"removeCls":"addCls"](g.hiddenDisplayCache);}}if(c.getIcon()){h=i.down(g.iconClsCache,true);h.style.backgroundImage=k?'url("'+k+'")':"";}}});Ext.define("Genesis.tab.Bar",{override:"Ext.tab.Bar",doSetActiveTab:function(b,a){this.callParent(arguments);this.fireAction("tabchange",[this,b,a]);}});Ext.define("Genesis.device.connection.PhoneGap",{override:"Ext.device.connection.PhoneGap",syncOnline:function(){var a=navigator.network.connection.type;this._type=a;this._online=(a!=Connection.NONE)&&(a!=Connection.UNKNOWN);}});Ext.define("Genesis.plugin.PullRefresh",{override:"Ext.plugin.PullRefresh",resetRefreshState:function(){Ext.device.Notification.beep(1);this.callParent(arguments);}});Ext.merge(Array.prototype,{binarySearch:function(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=Math.floor((a+e)/2);d=b(this[c],f);if(d<0){a=c+1;continue;}if(d>0){e=c-1;continue;}return c;}return null;}});Ext.merge(String.prototype,{getFuncBody:function(){var a=this.toString();a=a.replace(/[^{]+\{/,"");a=a.substring(0,a.length-1);a=a.replace(/\n/gi,"");if(!a.match(/\(.*\)/gi)){a+=")";}return a;},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");},stripScripts:function(){return this.replace(new RegExp("<noscript[^>]*?>([\\S\\s]*?)</noscript>","img"),"").replace(new RegExp("<script[^>]*?>([\\S\\s]*?)<\/script>","img"),"").replace(new RegExp("<link[^>]*?>([\\S\\s]*?)</link>","img"),"").replace(new RegExp("<link[^>]*?>","img"),"").replace(new RegExp("<iframe[^>]*?>([\\S\\s]*?)</iframe>","img"),"").replace(new RegExp("<iframe[^>]*?>","img"),"").replace(new RegExp("<embed[^>]*?>([\\S\\s]*?)</embed>","img"),"").replace(new RegExp("<embed[^>]*?>","img"),"").replace(new RegExp("<object[^>]*?>([\\S\\s]*?)</object>","img"),"").replace(new RegExp("<object[^>]*?>","img"),"").replace(new RegExp("<applet[^>]*?>([\\S\\s]*?)</applet>","img"),"").replace(new RegExp("<applet[^>]*?>","img"),"").replace(new RegExp("<button[^>]*?>([\\S\\s]*?)</button>","img"),"").replace(new RegExp("<button[^>]*?>","img"),"").replace(new RegExp("<input[^>]*?>([\\S\\s]*?)</input>","img"),"").replace(new RegExp("<input[^>]*?>","img"),"").replace(new RegExp("<style[^>]*?>([\\S\\s]*?)</style>","img"),"").replace(new RegExp("<style[^>]*?>","img"),"");},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"");},stripComments:function(){return this.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/g,"");},times:function(c){var b="";for(var a=0;a<c;a++){b+=this;}return b;},zp:function(a){return("0".times(a-this.length)+this);},capitalize:function(){return this.replace(/\w+/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1);});},uncapitalize:function(){return this.replace(/\w+/g,function(b){return b.charAt(0).toLowerCase()+b.substr(1);});},trim:function(a){if(a=="left"){return this.replace(/^\s*/,"");}if(a=="right"){return this.replace(/\s*$/,"");}if(a=="normalize"){return this.replace(/\s{2,}/g," ").trim();}return this.trim("left").trim("right");},trunc:function(a){return(this.length>(a-4))?this.substring(0,a-4)+" ...":this;},htmlEncode:(function(){var d={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},b=[],c,a;for(c in d){b.push(c);}a=new RegExp("("+b.join("|")+")","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){return d[f];});};})(),htmlDecode:(function(){var d={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'},b=[],c,a;for(c in d){b.push(c);}a=new RegExp("("+b.join("|")+"|&#[0-9]{1,5};)","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){if(f in d){return d[f];}else{return String.fromCharCode(parseInt(f.substr(2),10));}});};})()});