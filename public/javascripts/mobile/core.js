function QR8bitByte(a){this.mode=QRMode.MODE_8BIT_BYTE;this.data=a;}QR8bitByte.prototype={getLength:function(a){return this.data.length;},write:function(a){for(var b=0;b<this.data.length;b++){a.put(this.data.charCodeAt(b),8);}}};function QRCode(b,a){this.typeNumber=b;this.errorCorrectLevel=a;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=new Array();}QRCode.prototype={addData:function(b){var a=new QR8bitByte(b);this.dataList.push(a);this.dataCache=null;},isDark:function(b,a){if(b<0||this.moduleCount<=b||a<0||this.moduleCount<=a){throw new Error(b+","+a);}return this.modules[b][a];},getModuleCount:function(){return this.moduleCount;},make:function(){this.makeImpl(false,this.getBestMaskPattern());},makeImpl:function(d,c){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var b=0;b<this.moduleCount;b++){this.modules[b]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[b][a]=null;}}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(d,c);if(this.typeNumber>=7){this.setupTypeNumber(d);}if(this.dataCache==null){this.dataCache=QRCode.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);}this.mapData(this.dataCache,c);},setupPositionProbePattern:function(d,a){for(var b=-1;b<=7;b++){if(d+b<=-1||this.moduleCount<=d+b){continue;}for(var e=-1;e<=7;e++){if(a+e<=-1||this.moduleCount<=a+e){continue;}if((0<=b&&b<=6&&(e==0||e==6))||(0<=e&&e<=6&&(b==0||b==6))||(2<=b&&b<=4&&2<=e&&e<=4)){this.modules[d+b][a+e]=true;}else{this.modules[d+b][a+e]=false;}}}},getBestMaskPattern:function(){var d=0;var c=0;for(var b=0;b<8;b++){this.makeImpl(true,b);var a=QRUtil.getLostPoint(this);if(b==0||d>a){d=a;c=b;}}return c;},createMovieClip:function(e,a,c){var j=e.createEmptyMovieClip(a,c);var d=1;this.make();for(var k=0;k<this.modules.length;k++){var g=k*d;for(var b=0;b<this.modules[k].length;b++){var h=b*d;var f=this.modules[k][b];if(f){j.beginFill(0,100);j.moveTo(h,g);j.lineTo(h+d,g);j.lineTo(h+d,g+d);j.lineTo(h,g+d);j.endFill();}}}return j;},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++){if(this.modules[a][6]!=null){continue;}this.modules[a][6]=(a%2==0);}for(var b=8;b<this.moduleCount-8;b++){if(this.modules[6][b]!=null){continue;}this.modules[6][b]=(b%2==0);}},setupPositionAdjustPattern:function(){var h=QRUtil.getPatternPosition(this.typeNumber);for(var d=0;d<h.length;d++){for(var b=0;b<h.length;b++){var f=h[d];var a=h[b];if(this.modules[f][a]!=null){continue;}for(var e=-2;e<=2;e++){for(var g=-2;g<=2;g++){if(e==-2||e==2||g==-2||g==2||(e==0&&g==0)){this.modules[f+e][a+g]=true;}else{this.modules[f+e][a+g]=false;}}}}}},setupTypeNumber:function(d){var c=QRUtil.getBCHTypeNumber(this.typeNumber);for(var b=0;b<18;b++){var a=(!d&&((c>>b)&1)==1);this.modules[Math.floor(b/3)][b%3+this.moduleCount-8-3]=a;}for(var b=0;b<18;b++){var a=(!d&&((c>>b)&1)==1);this.modules[b%3+this.moduleCount-8-3][Math.floor(b/3)]=a;}},setupTypeInfo:function(f,e){var d=(this.errorCorrectLevel<<3)|e;var c=QRUtil.getBCHTypeInfo(d);for(var b=0;b<15;b++){var a=(!f&&((c>>b)&1)==1);if(b<6){this.modules[b][8]=a;}else{if(b<8){this.modules[b+1][8]=a;}else{this.modules[this.moduleCount-15+b][8]=a;}}}for(var b=0;b<15;b++){var a=(!f&&((c>>b)&1)==1);if(b<8){this.modules[8][this.moduleCount-b-1]=a;}else{if(b<9){this.modules[8][15-b-1+1]=a;}else{this.modules[8][15-b-1]=a;}}}this.modules[this.moduleCount-8][8]=(!f);},mapData:function(g,b){var e=-1;var l=this.moduleCount-1;var f=7;var a=0;for(var d=this.moduleCount-1;d>0;d-=2){if(d==6){d--;}while(true){for(var j=0;j<2;j++){if(this.modules[l][d-j]==null){var h=false;if(a<g.length){h=(((g[a]>>>f)&1)==1);}var k=QRUtil.getMask(b,l,d-j);if(k){h=!h;}this.modules[l][d-j]=h;f--;if(f==-1){a++;f=7;}}}l+=e;if(l<0||this.moduleCount<=l){l-=e;e=-e;break;}}}}};QRCode.PAD0=236;QRCode.PAD1=17;QRCode.createData=function(h,g,d){var b=QRRSBlock.getRSBlocks(h,g);var a=new QRBitBuffer();for(var c=0;c<d.length;c++){var f=d[c];a.put(f.mode,4);a.put(f.getLength(),QRUtil.getLengthInBits(f.mode,h));f.write(a);}var e=0;for(var c=0;c<b.length;c++){e+=b[c].dataCount;}if(a.getLengthInBits()>e*8){throw new Error("code length overflow. ("+a.getLengthInBits()+">"+e*8+")");}if(a.getLengthInBits()+4<=e*8){a.put(0,4);}while(a.getLengthInBits()%8!=0){a.putBit(false);}while(true){if(a.getLengthInBits()>=e*8){break;}a.put(QRCode.PAD0,8);if(a.getLengthInBits()>=e*8){break;}a.put(QRCode.PAD1,8);}return QRCode.createBytes(a,b);};QRCode.createBytes=function(l,o){var c=0;var s=0;var p=0;var b=new Array(o.length);var f=new Array(o.length);for(var j=0;j<o.length;j++){var k=o[j].dataCount;var a=o[j].totalCount-k;s=Math.max(s,k);p=Math.max(p,a);b[j]=new Array(k);for(var m=0;m<b[j].length;m++){b[j][m]=255&l.buffer[m+c];}c+=k;var g=QRUtil.getErrorCorrectPolynomial(a);var q=new QRPolynomial(b[j],g.getLength()-1);var d=q.mod(g);f[j]=new Array(g.getLength()-1);for(var m=0;m<f[j].length;m++){var h=m+d.getLength()-f[j].length;f[j][m]=(h>=0)?d.get(h):0;}}var n=0;for(var m=0;m<o.length;m++){n+=o[m].totalCount;}var t=new Array(n);var e=0;for(var m=0;m<s;m++){for(var j=0;j<o.length;j++){if(m<b[j].length){t[e++]=b[j][m];}}}for(var m=0;m<p;m++){for(var j=0;j<o.length;j++){if(m<f[j].length){t[e++]=f[j][m];}}}return t;};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0),G18:(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0),G15_MASK:(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1),getBCHTypeInfo:function(a){var b=a<<10;while(QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G15)>=0){b^=(QRUtil.G15<<(QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G15)));}return((a<<10)|b)^QRUtil.G15_MASK;},getBCHTypeNumber:function(a){var b=a<<12;while(QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G18)>=0){b^=(QRUtil.G18<<(QRUtil.getBCHDigit(b)-QRUtil.getBCHDigit(QRUtil.G18)));}return(a<<12)|b;},getBCHDigit:function(a){var b=0;while(a!=0){b++;a>>>=1;}return b;},getPatternPosition:function(a){return QRUtil.PATTERN_POSITION_TABLE[a-1];},getMask:function(c,b,a){switch(c){case QRMaskPattern.PATTERN000:return(b+a)%2==0;case QRMaskPattern.PATTERN001:return b%2==0;case QRMaskPattern.PATTERN010:return a%3==0;case QRMaskPattern.PATTERN011:return(b+a)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(b/2)+Math.floor(a/3))%2==0;case QRMaskPattern.PATTERN101:return(b*a)%2+(b*a)%3==0;case QRMaskPattern.PATTERN110:return((b*a)%2+(b*a)%3)%2==0;case QRMaskPattern.PATTERN111:return((b*a)%3+(b+a)%2)%2==0;default:throw new Error("bad maskPattern:"+c);}},getErrorCorrectPolynomial:function(c){var b=new QRPolynomial([1],0);for(var d=0;d<c;d++){b=b.multiply(new QRPolynomial([1,QRMath.gexp(d)],0));}return b;},getLengthInBits:function(b,a){if(1<=a&&a<10){switch(b){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+b);}}else{if(a<27){switch(b){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+b);}}else{if(a<41){switch(b){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+b);}}else{throw new Error("type:"+a);}}}},getLostPoint:function(b){var e=b.getModuleCount();var f=0;for(var n=0;n<e;n++){for(var d=0;d<e;d++){var l=0;var k=b.isDark(n,d);for(var a=-1;a<=1;a++){if(n+a<0||e<=n+a){continue;}for(var j=-1;j<=1;j++){if(d+j<0||e<=d+j){continue;}if(a==0&&j==0){continue;}if(k==b.isDark(n+a,d+j)){l++;}}}if(l>5){f+=(3+l-5);}}}for(var n=0;n<e-1;n++){for(var d=0;d<e-1;d++){var g=0;if(b.isDark(n,d)){g++;}if(b.isDark(n+1,d)){g++;}if(b.isDark(n,d+1)){g++;}if(b.isDark(n+1,d+1)){g++;}if(g==0||g==4){f+=3;}}}for(var n=0;n<e;n++){for(var d=0;d<e-6;d++){if(b.isDark(n,d)&&!b.isDark(n,d+1)&&b.isDark(n,d+2)&&b.isDark(n,d+3)&&b.isDark(n,d+4)&&!b.isDark(n,d+5)&&b.isDark(n,d+6)){f+=40;}}}for(var d=0;d<e;d++){for(var n=0;n<e-6;n++){if(b.isDark(n,d)&&!b.isDark(n+1,d)&&b.isDark(n+2,d)&&b.isDark(n+3,d)&&b.isDark(n+4,d)&&!b.isDark(n+5,d)&&b.isDark(n+6,d)){f+=40;}}}var m=0;for(var d=0;d<e;d++){for(var n=0;n<e;n++){if(b.isDark(n,d)){m++;}}}var h=Math.abs(100*m/e/e-50)/5;f+=h*10;return f;}};var QRMath={glog:function(a){if(a<1){throw new Error("glog("+a+")");}return QRMath.LOG_TABLE[a];},gexp:function(a){while(a<0){a+=255;}while(a>=256){a-=255;}return QRMath.EXP_TABLE[a];},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i;}for(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];}for(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;}function QRPolynomial(b,a){if(b.length==undefined){throw new Error(b.length+"/"+a);}var d=0;while(d<b.length&&b[d]==0){d++;}this.num=new Array(b.length-d+a);for(var c=0;c<b.length-d;c++){this.num[c]=b[c+d];}}QRPolynomial.prototype={get:function(a){return this.num[a];},getLength:function(){return this.num.length;},multiply:function(d){var b=new Array(this.getLength()+d.getLength()-1);for(var c=0;c<this.getLength();c++){for(var a=0;a<d.getLength();a++){b[c+a]^=QRMath.gexp(QRMath.glog(this.get(c))+QRMath.glog(d.get(a)));}}return new QRPolynomial(b,0);},mod:function(d){if(this.getLength()-d.getLength()<0){return this;}var c=QRMath.glog(this.get(0))-QRMath.glog(d.get(0));var a=new Array(this.getLength());for(var b=0;b<this.getLength();b++){a[b]=this.get(b);}for(var b=0;b<d.getLength();b++){a[b]^=QRMath.gexp(QRMath.glog(d.get(b))+c);}return new QRPolynomial(a,0).mod(d);}};function QRRSBlock(a,b){this.totalCount=a;this.dataCount=b;}QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(c,k){var b=QRRSBlock.getRsBlockTable(c,k);if(b==undefined){throw new Error("bad rs block @ typeNumber:"+c+"/errorCorrectLevel:"+k);}var a=b.length/3;var g=new Array();for(var e=0;e<a;e++){var f=b[e*3+0];var l=b[e*3+1];var h=b[e*3+2];for(var d=0;d<f;d++){g.push(new QRRSBlock(l,h));}}return g;};QRRSBlock.getRsBlockTable=function(b,a){switch(a){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(b-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(b-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(b-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(b-1)*4+3];default:return undefined;}};function QRBitBuffer(){this.buffer=new Array();this.length=0;}QRBitBuffer.prototype={get:function(a){var b=Math.floor(a/8);return((this.buffer[b]>>>(7-a%8))&1)==1;},put:function(a,c){for(var b=0;b<c;b++){this.putBit(((a>>>(c-b-1))&1)==1);}},getLengthInBits:function(){return this.length;},putBit:function(b){var a=Math.floor(this.length/8);if(this.buffer.length<=a){this.buffer.push(0);}if(b){this.buffer[a]|=(128>>>(this.length%8));}this.length++;}};Ext.define("Ext.device.communicator.Default",{SERVER_URL:"http://localhost:3000",callbackDataMap:{},callbackIdMap:{},idSeed:0,globalScopeId:"0",generateId:function(){return String(++this.idSeed);},getId:function(a){var b=a.$callbackId;if(!b){a.$callbackId=b=this.generateId();}return b;},getCallbackId:function(h,d){var c=this.callbackIdMap,b=this.callbackDataMap,g,a,f,e;if(!d){a=this.globalScopeId;}else{if(d.isIdentifiable){a=d.getId();}else{a=this.getId(d);}}f=this.getId(h);if(!c[a]){c[a]={};}if(!c[a][f]){g=this.generateId();e={callback:h,scope:d};c[a][f]=g;b[g]=e;}return c[a][f];},getCallbackData:function(a){return this.callbackDataMap[a];},invoke:function(c,a){var b=this.getCallbackData(c);b.callback.apply(b.scope,a);},send:function(b){var d,c,a,e;if(!b){b={};}else{if(b.callbacks){d=b.callbacks;c=b.scope;delete b.callbacks;delete b.scope;for(a in d){if(d.hasOwnProperty(a)){e=d[a];if(typeof e=="function"){b[a]=this.getCallbackId(e,c);}}}}}this.doSend(b);},doSend:function(a){var b=new XMLHttpRequest();b.open("GET",this.SERVER_URL+"?"+Ext.Object.toQueryString(a),false);b.send(null);}});Ext.define("Ext.device.communicator.Android",{extend:"Ext.device.communicator.Default",doSend:function(a){window.Sencha.action(JSON.stringify(a));}});Ext.define("Ext.device.Communicator",{requires:["Ext.device.communicator.Default","Ext.device.communicator.Android"],singleton:true,constructor:function(){if(Ext.os.is.Android){return new Ext.device.communicator.Android();}return new Ext.device.communicator.Default();}});Ext.define("Ext.device.camera.Abstract",{source:{library:0,camera:1,album:2},destination:{data:0,file:1},encoding:{jpeg:0,jpg:0,png:1},capture:Ext.emptyFn});Ext.define("Ext.device.camera.PhoneGap",{extend:"Ext.device.camera.Abstract",capture:function(k){var h=k.success,d=k.failure,m=k.scope,b=this.source,f=this.destination,j=this.encoding,a=k.source,l=k.destination,c=k.encoding,n={};if(m){h=Ext.Function.bind(h,m);d=Ext.Function.bind(d,m);}if(a!==undefined){n.sourceType=b.hasOwnProperty(a)?b[a]:a;}if(l!==undefined){n.destinationType=f.hasOwnProperty(l)?f[l]:l;}if(c!==undefined){n.encodingType=j.hasOwnProperty(c)?j[c]:c;}if("quality" in k){n.quality=k.quality;}if("width" in k){n.targetWidth=k.width;}if("height" in k){n.targetHeight=k.height;}try{navigator.camera.getPicture(h,d,n);}catch(g){alert(g);}}});Ext.define("Ext.device.camera.Sencha",{extend:"Ext.device.camera.Abstract",requires:["Ext.device.Communicator"],capture:function(d){var c=this.source,b=this.destination,f=this.encoding,g=d.source,a=d.destination,e=d.encoding;if(c.hasOwnProperty(g)){g=c[g];}if(b.hasOwnProperty(a)){a=b[a];}if(f.hasOwnProperty(e)){e=f[e];}Ext.device.Communicator.send({command:"Camera#capture",callbacks:{success:d.success,failure:d.failure},scope:d.scope,quality:d.quality,width:d.width,height:d.height,source:g,destination:a,encoding:e});}});Ext.define("Ext.device.camera.Simulator",{extend:"Ext.device.camera.Abstract",config:{samples:[{success:"http://www.sencha.com/img/sencha-large.png"}]},constructor:function(a){this.initConfig(a);},updateSamples:function(a){this.sampleIndex=0;},capture:function(d){var c=this.sampleIndex,b=this.getSamples(),g=b.length,f=b[c],e=d.scope,h=d.success,a=d.failure;if("success" in f){if(h){h.call(e,f.success);}}else{if(a){a.call(e,f.failure);}}if(++c>g-1){c=0;}this.sampleIndex=c;}});Ext.define("Ext.device.connection.Abstract",{extend:"Ext.Evented",config:{online:false,type:null},UNKNOWN:"Unknown connection",ETHERNET:"Ethernet connection",WIFI:"WiFi connection",CELL_2G:"Cell 2G connection",CELL_3G:"Cell 3G connection",CELL_4G:"Cell 4G connection",NONE:"No network connection",isOnline:function(){return this.getOnline();}});Ext.define("Ext.device.connection.PhoneGap",{extend:"Ext.device.connection.Abstract",syncOnline:function(){var a=navigator.network.connection.type;this._type=a;this._online=a!=Connection.NONE;},getOnline:function(){this.syncOnline();return this._online;},getType:function(){this.syncOnline();return this._type;}});Ext.define("Ext.device.connection.Sencha",{extend:"Ext.device.connection.Abstract",initialize:function(){Ext.device.Communicator.send({command:"Connection#watch",callbacks:{callback:this.onConnectionChange},scope:this});},onConnectionChange:function(a){this.setOnline(Boolean(a.online));this.setType(this[a.type]);this.fireEvent("onlinechange",this.getOnline(),this.getType());}});Ext.define("Ext.device.connection.Simulator",{extend:"Ext.device.connection.Abstract",getOnline:function(){this._online=navigator.onLine;this._type=Ext.device.Connection.UNKNOWN;return this._online;}});Ext.define("Ext.device.notification.Abstract",{show:function(a){if(!a.message){throw ("[Ext.device.Notification#show] You passed no message");}if(!a.buttons){a.buttons="OK";}if(!Ext.isArray(a.buttons)){a.buttons=[a.buttons];}if(!a.scope){a.scope=this;}return a;},vibrate:Ext.emptyFn});Ext.define("Ext.device.notification.PhoneGap",{extend:"Ext.device.notification.Abstract",requires:["Ext.device.Communicator"],show:function(){var b=this.callParent(arguments),c=(b.buttons)?b.buttons.join(","):null,a=function(d){if(b.callback){b.callback.apply(b.scope,(b.buttons)?[b.buttons[d-1]]:[]);}};navigator.notification.confirm(b.message,a,b.title,c);},vibrate:function(){navigator.notification.vibrate(2000);}});Ext.define("Ext.device.notification.Sencha",{extend:"Ext.device.notification.Abstract",requires:["Ext.device.Communicator"],show:function(){var a=this.callParent(arguments);Ext.device.Communicator.send({command:"Notification#show",callbacks:{callback:a.callback},scope:a.scope,title:a.title,message:a.message,buttons:a.buttons.join(",")});},vibrate:function(){Ext.device.Communicator.send({command:"Notification#vibrate"});}});Ext.define("Ext.device.notification.Simulator",{extend:"Ext.device.notification.Abstract",requires:["Ext.MessageBox"],msg:null,show:function(){var a=this.callParent(arguments),e=[],d=a.buttons.length,c,b,g,f;for(b=0;b<d;b++){c=a.buttons[b];if(Ext.isString(c)){c={text:a.buttons[b],itemId:a.buttons[b].toLowerCase()};}e.push(c);}this.msg=Ext.create("Ext.MessageBox");f=this.msg;g=function(h){if(a.callback){a.callback.apply(a.scope,[h]);}};this.msg.show({title:a.title,message:a.message,scope:this.msg,buttons:e,fn:g});},vibrate:function(){var c=["@-webkit-keyframes vibrate{","    from {","        -webkit-transform: rotate(-2deg);","    }","    to{","        -webkit-transform: rotate(2deg);","    }","}","body {","    -webkit-animation: vibrate 50ms linear 10 alternate;","}"];var b=document.getElementsByTagName("head")[0];var a=document.createElement("style");a.innerHTML=c.join("\n");b.appendChild(a);setTimeout(function(){b.removeChild(a);},400);}});Ext.define("Ext.device.orientation.Abstract",{extend:"Ext.EventedBase",onDeviceOrientation:function(a){this.doFireEvent("orientationchange",[a]);}});Ext.define("Ext.device.orientation.HTML5",{extend:"Ext.device.orientation.Abstract",initialize:function(){this.onDeviceOrientation=Ext.Function.bind(this.onDeviceOrientation,this);window.addEventListener("deviceorientation",this.onDeviceOrientation,true);}});Ext.define("Ext.device.orientation.Sencha",{extend:"Ext.device.orientation.Abstract",requires:["Ext.device.Communicator"],initialize:function(){Ext.device.Communicator.send({command:"Orientation#watch",callbacks:{callback:this.onDeviceOrientation},scope:this});}});Ext.define("Ext.device.Notification",{singleton:true,requires:["Ext.device.Communicator","Ext.device.notification.PhoneGap","Ext.device.notification.Sencha","Ext.device.notification.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.notification.PhoneGap");}else{return Ext.create("Ext.device.notification.Sencha");}}else{return Ext.create("Ext.device.notification.Simulator");}}});Ext.define("Ext.device.Connection",{singleton:true,requires:["Ext.device.Communicator","Ext.device.connection.Sencha","Ext.device.connection.PhoneGap","Ext.device.connection.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.connection.PhoneGap");}else{return Ext.create("Ext.device.connection.Sencha");}}else{return Ext.create("Ext.device.connection.Simulator");}}});Ext.define("Ext.device.Camera",{singleton:true,requires:["Ext.device.Communicator","Ext.device.camera.PhoneGap","Ext.device.camera.Sencha","Ext.device.camera.Simulator"],constructor:function(){var a=Ext.browser.is;if(a.WebView){if(a.PhoneGap){return Ext.create("Ext.device.camera.PhoneGap");}else{return Ext.create("Ext.device.camera.Sencha");}}else{return Ext.create("Ext.device.camera.Simulator");}}});Ext.define("Ext.device.Orientation",{singleton:true,requires:["Ext.device.Communicator","Ext.device.orientation.HTML5","Ext.device.orientation.Sencha"],constructor:function(){var a=Ext.browser.is;if(a.Sencha){return Ext.create("Ext.device.orientation.Sencha");}else{return Ext.create("Ext.device.orientation.HTML5");}}});(function(){var a=window.PhoneGap||window.Cordova||window.cordova;BarcodeScanner=function(){};BarcodeScanner.Encode={TEXT_TYPE:"TEXT_TYPE",EMAIL_TYPE:"EMAIL_TYPE",PHONE_TYPE:"PHONE_TYPE",SMS_TYPE:"SMS_TYPE",CONTACT_TYPE:"CONTACT_TYPE",LOCATION_TYPE:"LOCATION_TYPE"};BarcodeScanner.prototype.scan=function(e,b,c){function d(f){f.cancelled=(f.cancelled==1);e.call(null,f);}if(!b){b=function(){};}if(typeof b!="function"){console.log("BarcodeScanner.scan failure: failure parameter not a function");return;}if(typeof e!="function"){b("success callback parameter must be a function");return;}if(null==c){c=[];}a.exec(d,b,"BarCodeScanner","scan",c);};BarcodeScanner.prototype.encode=function(d,e,f,b,c){if(!b){b=function(){};}if(typeof b!="function"){console.log("BarcodeScanner.scan failure: failure parameter not a function");return;}if(typeof f!="function"){b("success callback parameter must be a function");return;}return a.exec(f,b,"BarCodeScanner","encode",[{type:d,data:e,options:c}]);};a.addConstructor(function(){if(!window.plugins){window.plugins={};}window.plugins.barcodeScanner=new BarcodeScanner();});})();(function(){var a=window.PhoneGap||window.Cordova||window.cordova;QRCodeReader=function(){};QRCodeReader.ErrorResultType={Cancelled:0,Failed:1,Success:2};QRCodeReader.prototype.scanType="Default";QRCodeReader.prototype.getCode=function(b,c,d){if(typeof b!="function"){console.log("QRCodeReader Error: successCallback is not a function");return;}if(c&&(typeof c!="function")){console.log("QRCodeReader Error: errorCallback is not a function");return;}console.log("ScanType is ["+this.scanType+"]");switch(this.scanType){case"RL":case"Nigma":a.exec(b,c,"QRCodeReader"+this.scanType,"getCode",[]);break;case"Default":window.plugins.barcodeScanner.scan(b,c,d);break;default:a.exec(b,c,"QRCodeReaderRL","getCode",[]);break;}};QRCodeReader.prototype._didNotFinishWithResult=function(b){console.log("ErrorCode = "+b);pluginResult.message=b;return pluginResult;};QRCodeReader.prototype._didFinishWithResult=function(c){var b={response:decodeURIComponent(c.message.response)};c.message=b;return c;};a.addConstructor(function(){if(!window.plugins){window.plugins={};}window.plugins.qrCodeReader=new QRCodeReader();});})();var LowLatencyAudio={preloadFX:function(d,b,c,a){return cordova.exec(c,a,"LowLatencyAudio","preloadFX",[d,b]);},preloadAudio:function(e,c,b,d,a){return cordova.exec(d,a,"LowLatencyAudio","preloadAudio",[e,c,b]);},play:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","play",[c]);},stop:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","stop",[c]);},loop:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","loop",[c]);},unload:function(c,b,a){return cordova.exec(b,a,"LowLatencyAudio","unload",[c]);}};Ext.ns("Genesis.constants");Genesis.constants={host:"http://www.getkickbak.com",themeName:"v1",sign_in_path:"/sign_in",sign_out_path:"/sign_out",site:"www.getkickbak.com",weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],fbScope:"email,user_birthday,publish_stream,read_friendlists,publish_actions,offline_access",fbConnectErrorMsg:"Cannot retrive Facebook account information!",fbConnectReqestMsg:"Connection to Facebook is required to complete this action",debugPrivKey:"Po2CFD4Sndq0jRs1t5sRpOCIpUvCCnFx",redeemDBSize:10000,isNative:function(){return phoneGapAvailable;},addCRLF:function(){return((!this.isNative())?"<br/>":"\n");},getIconPath:function(b,a){return"resources/themes/images/"+this.themeName+"/"+b+"/"+a+".png";},getLocalStorage:function(){return window.localStorage;},getRedeemIndexDB:function(b){var a=this.getLocalStorage().getItem("kickbakRedeemIndex");return((a)?(b?Ext.decode(a)[b]:Ext.decode(a)):{});},addRedeemIndexDB:function(a){this.getLocalStorage().setItem("kickbakRedeemIndex",Ext.encode(db));},setRedeemIndexDB:function(a){this.getLocalStorage().setItem("kickbakRedeemIndex",Ext.encode(a));},addRedeemSortedDB:function(a){var b=this.getRedeemSortedDB();b.push(a);if(!Ext.isDefined(b.lastCount)){b.lastCount=0;}b.currCount=(Ext.isDefined(b.currCount))?((b.currCount+1)%this.redeemDBSize):0;this.setRedeemSortedDB(b);},getRedeemSortedDB:function(b){var a=this.getLocalStorage().getItem("kickbakRedeemSorted");return((a)?(b?Ext.decode(a)[b]:Ext.decode(a)):{});},setRedeemSortedDB:function(a){this.getLocalStorage().setItem("kickbakRedeemSorted",Ext.encode(a));},redeemDBCleanup:function(){console.log("================================");console.log("Redeem Database has been Started");console.log("================================");var c=Date.now();dbI=this.getRedeemIndexDB();dbS=this.getRedeemSortedDB();var d=0;var b=dbS.lastCount||-1;var a=dbS.currCount||-1;console.debug("\nlastCount = "+b+"\ncurrCount = "+a);while(b!=a){if(!dbS[b]||(dbI[dbS[b]]>c)){break;}delete dbI[dbS[b]];delete dbS[b];b=(b+1)%this.redeemDBSize;d++;}if(d>0){dbS.lastCount=(dbS.lastCount+d)%this.redeemDBSize;}Genesis.constants.setRedeemIndexDB(dbI);Genesis.constants.setRedeemSortedDB(dbS);console.debug("lastCount = "+dbS.lastCount+" total = "+d);console.log("=================================");console.log("Redeem Database has been resetted");console.log("=================================");},getLocalDB:function(){var a=this.getLocalStorage().getItem("kickbak");return((a)?Ext.decode(a):{});},setLocalDB:function(a){console.debug("Setting KickBak DB["+Ext.encode(a)+"]");this.getLocalStorage().setItem("kickbak",Ext.encode(a));},setLocalDBAttrib:function(c,b){console.debug("Setting KickBak Attrib["+c+"] to ["+b+"]");var a=this.getLocalDB();a[c]=b;this.setLocalDB(a);},removeLocalDBAttrib:function(b){var a=this.getLocalDB();delete a[b];this.setLocalDB(a);},resetStorage:function(){this.facebook_onLogout(null,false);Genesis.constants.removeLocalDBAttrib("auth_code");},getPrivKey:function(d){var c=this;if(!c.privKey){if(c.isNative()){var a=function(f){var g={};g[FileError.NOT_FOUND_ERR]="File not found";g[FileError.SECURITY_ERR]="Security error";g[FileError.ABORT_ERR]="Abort error";g[FileError.NOT_READABLE_ERR]="Not readable";g[FileError.ENCODING_ERR]="Encoding error";g[FileError.NO_MODIFICATION_ALLOWED_ERR]="No mobification allowed";g[FileError.INVALID_STATE_ERR]="Invalid state";g[FileError.SYFNTAX_ERR]="Syntax error";g[FileError.INVALID_MODIFICATION_ERR]="Invalid modification";g[FileError.QUOTA_EXCEEDED_ERR]="Quota exceeded";g[FileError.TYPE_MISMATCH_ERR]="Type mismatch";g[FileError.PATH_EXISTS_ERR]="Path does not exist";var e={};e[FileTransferError.FILE_NOT_FOUND_ERR]="File not found";e[FileTransferError.INVALID_URL_ERR]="Invalid URL Error";e[FileTransferError.CONNECTION_ERR]="Connection Error";console.log("Reading License File Error - ["+g[f.code]+"]");};window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(f){var e=f.root.fullPath+"/../"+appName+".app/www/resources/keys.txt";console.debug("License File - ["+e+"]");f.root.getFile(e,null,function(g){g.file(function(j){var h=new FileReader();h.onloadend=function(k){c.privKey=Ext.decode(k.target.result);for(var l in c.privKey){console.debug("Encryption Key["+l+"] = ["+c.privKey[l]+"]");}};h.readAsText(j);},a);},a);},a);return null;}else{c.privKey={v1:c.debugPrivKey};for(var b in c.privKey){console.debug("Encryption Key["+b+"] = ["+c.privKey[b]+"]");}}}return(d)?c.privKey["v"+d]:c.privKey;},convertDateCommon:function(d,a,h){var e;var g=a||this.dateFormat;if(!(d instanceof Date)){if(typeof(JSON)!="undefined"){}if(Ext.isEmpty(d)){e=new Date();}else{if(g){e=Date.parse(d,g);if(Ext.isEmpty(e)){e=new Date(d).format(g);}return[e,e];}e=new Date(d);if(e.toString()=="Invalid Date"){e=Date.parse(d,g);}}}else{e=d;}if(!h){var c=new Date().getTime();var f=Genesis.constants.currentDateTime(c);var b=(f-e.getTime())/1000;if(b>-10){if((b)<2){return[b,"a second ago"];}if((b)<60){return[b,parseInt(b)+" secs ago"];}b=b/60;if((b)<2){return[b,"a minute ago"];}if((b)<60){return[b,parseInt(b)+" minutes ago"];}b=b/60;if((b)<2){return[e,"an hour ago"];}if((b)<24){return[e,parseInt(b)+" hours ago"];}b=b/24;if(((b)<2)&&((new Date().getDay()-e.getDay())==1)){return[e,"Yesterday at "+e.format("g:i A")];}if((b)<7){return[e,Genesis.constants.weekday[e.getDay()]+" at "+e.format("g:i A")];}b=b/7;if(((b)<2)&&(b%7==0)){return[e,"a week ago"];}if(((b)<5)&&(b%7==0)){return[e,parseInt(b)+" weeks ago"];}if(b<5){return[e,parseInt(b*7)+" days ago"];}return[e,null];}else{}}return[e,-1];},convertDateFullTime:function(a){return a.format("D, M d, Y \\a\\t g:i A");},convertDateReminder:function(c){var b=new Date();var a=b.getDate();var g=b.getMonth();var e=b.getFullYear();var d=c.getDate();var h=c.getMonth();var f=c.getFullYear();if(a==d&&g==h&&e==f){return"Today "+c.format("g:i A");}return c.format("D g:i A");},convertDate:function(b,a){var c=Genesis.constants.convertDateCommon.call(this,b,a);if(c[1]!=-1){return(c[1]==null)?c[0].format("M d, Y"):c[1];}else{return c[0].format("D, M d, Y \\a\\t g:i A");}},convertDateNoTime:function(a){var b=Genesis.constants.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){return(b[1]==null)?b[0].format("D, M d, Y"):b[1];}else{return b[0].format("D, M d, Y");}},convertDateNoTimeNoWeek:function(a){var b=Genesis.constants.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){b=(b[1]==null)?b[0].format("M d, Y"):b[1];}else{b=b[0].format("M d, Y");}return b;},convertDateInMins:function(a){var b=Genesis.constants.convertDateCommon.call(this,a,null,true);if(b[1]!=-1){return(b[1]==null)?b[0].format("h:ia T"):b[1];}else{return b[0].format("h:ia T");}},currentDateTime:function(a){return systemTime+(a-clientTime);},initFb:function(){var b=this;var a=b.getLocalDB();delete a.fbExpiresIn;b.setLocalDB(a);FB.Event.monitor("auth.authResponseChange",function(d){if(d&&(d.status!="not_authorized")&&(d.status!="notConnected")){console.log("Got FB user's session: "+d.status);var c=d.authResponse.accessToken;if(c){a.fbExpiresIn=d.authResponse.expiresIn;b.setLocalDB(a);if(b.cb){b.facebook_loginCallback(b.cb);delete b.cb;}}else{delete a.fbExpiresIn;b.setLocalDB(a);b.facebook_onLogout(null,false);}}else{if((d===undefined)||(d&&d.status=="not_authorized")){if(d){b.facebook_onLogout(null,(d)?true:false);}}}});},getFriendsList:function(f){var c="id";var a="name";var e=this;var b=e.getLocalDB();var d=function(g){return"We found "+g+" Friends from your social network!";};FB.api("/me/friends&fields="+a+","+c,function(g){var k="";e.friendsList=[];if(g&&g.data&&(g.data.length>0)){var j=g.data;for(var h=0;h<j.length;h++){if(j[h][c]!=b.currFbId){e.friendsList.push({label:j[h][a],value:j[h][c]});k+=((k.length>0)?",":"")+j[h][c];}}e.friendsList.sort(function(m,l){return m[c]-l[c];});console.log(d(e.friendsList.length));}else{Ext.device.Notification.show({title:"Facebook Connect",message:"You cannot retrieve your Friends List from Facebook. Login and Try Again.",buttons:["Relogin","Cancel"],callback:function(l){if(l=="Relogin"){e.facebook_onLogout(function(){e.fbLogin(cb,false,false);},true);}else{}}});}});},createFbResponse:function(a){var b=a.birthday.split("/");b=b[2]+"-"+b[0]+"-"+b[1];var c={name:a.name,email:a.email,facebook_email:a.email,facebook_id:a.id,facebook_uid:a.username,gender:(a.gender=="male")?"m":"f",birthday:b,photoURL:"http://graph.facebook.com/"+a.id+"/picture?type=square"};return c;},fbLogin:function(a,c,e){var d=this;var b=d.getLocalDB();a=a||Ext.emptyFn;if(!c&&!e){console.debug("Logging into Facebook ...");Ext.Viewport.setMasked({xtype:"loadmask",message:"Logging into Facebook ..."});}else{console.debug("Refresh Connectivity or Logging to Facebook ... refreshConn="+c);}d.cb=a;FB[(c)?"getLoginStatus":"login"](function(f){if((f.status=="connected")&&f.authResponse){console.debug("Logged into Facebook!");b.fbExpiresIn=f.authResponse.expiresIn;d.setLocalDB(b);if(d.cb){d.facebook_loginCallback(d.cb);delete d.cb;}}else{delete b.fbExpiresIn;d.setLocalDB(b);if(!c){console.debug("Login Failed! ...");if(!e){Ext.Viewport.setMasked(false);Ext.device.Notification.show({title:"Facebook Connect",message:"Failed to login to Facebook!"});}}else{console.debug("Failed to refresh connection to Facebook ...");Ext.defer(d.fbLogin,1,d,[a,false,e]);}}},{scope:d.fbScope});},facebook_onLogin:function(a,h,b,g){var f=this;var c=f.getLocalDB();a=a||Ext.emptyFn;var d=(c.currFbId>0);console.debug("facebook_onLogin - FbId = ["+c.currFbId+"]");if(!b||d){var e=(!c.fbExpiresIn)?0:new Date(c.fbExpiresIn).getTime();if((d||g)&&(e<Date.now())){Ext.device.Notification.show({title:"Facebook Connect",message:g||f.fbConnectReqestMsg,buttons:["Proceed","Cancel"],callback:function(j){if(j.toLowerCase()=="proceed"){f.fbLogin(a,d,h);}}});}else{f.fbLogin(a,d,h);}}},facebook_loginCallback:function(a,d){var c=this;var b=c.getLocalDB();console.debug("Retrieving Facebook profile information ...");d=d||0;a=a||Ext.emptyFn;FB.api("/me",function(e){if(!e.error){if(d>=5){Ext.Viewport.setMasked(false);Ext.device.Notification.show({title:"Facebook Connect",message:c.fbConnectErrorMsg});c.facebook_onLogout(null,true);return;}var f=e.id;if(!f||(f==0)){console.debug("Missing Facebook Session information, Retrying ...");++d;Ext.defer(function(h){c.facebook_loginCallback(a,h);},d*1000,c,[d]);return;}Ext.Viewport.setMasked(false);if(b.currFbId==f){console.debug("Session information same as previous session["+f+"]");}else{console.debug("Session ID["+f+"]");}b.currFbId=f;b.fbAccountId=e.email;var g=c.createFbResponse(e);b.fbResponse=g;Genesis.constants.setLocalDB(b);console.debug("You`ve logged into Facebook! \nEmail("+b.fbAccountId+")\nID("+f+")\n");c._fb_connect();if(a){a(g);}}else{c.facebook_onLogout(null,false);}});},_fb_connect:function(){},facebook_onLogout:function(a,c){var d=this;var b=d.getLocalDB();a=a||Ext.emptyFn;d._fb_disconnect();b.currFbId=0;delete b.fbAccountId;delete b.fbResponse;Genesis.constants.setLocalDB(b);Ext.Viewport.setMasked(false);try{if(c){FB.logout(function(e){a();});}else{a();}}catch(f){a();}}};Genesis.constants._fb_disconnect=Genesis.constants._fb_connect;Genesis.fn={addUnit:function(a){return a+"px";},_removeUnitRegex:/(\d+)px/,removeUnit:function(a){return a.match(this._removeUnitRegex)[1];}};Ext.define("Genesis.dom.Element",{override:"Ext.dom.Element",setMargin:function(b,a){if(b||b===0){b=this.self.unitizeBox((b===true)?5:b,a);}else{b=null;}this.dom.style.margin=b;},setPadding:function(b,a){if(b||b===0){b=this.self.unitizeBox((b===true)?5:b,a);}else{b=null;}this.dom.style.padding=b;},});Ext.define("Genesis.Component",{override:"Ext.Component",updatePadding:function(a){this.innerElement.setPadding(a,this.getInitialConfig().defaultUnit);},updateMargin:function(a){this.element.setMargin(a,this.getInitialConfig().defaultUnit);}});Ext.define("Genesis.util.Collection",{override:"Ext.util.Collection",clear:function(){this.callParent(arguments);this.indices={};}});Ext.define("Genesis.data.reader.Json",{override:"Ext.data.reader.Json",getResponseData:function(a){var b=this.callParent(arguments);if(!b.metaData){delete this.metaData;}return b;}});Ext.define("Genesis.data.proxy.OfflineServer",{override:"Ext.data.proxy.Server",processResponse:function(n,c,f,d,m,p){var k=this,b=c.getAction(),h=k.getReader(),l;var a=_application;var o=a.getController("Viewport");var g=function(){var q=((l&&Ext.isDefined(l.getMessage))?(Ext.isArray(l.getMessage())?l.getMessage().join(Genesis.constants.addCRLF()):l.getMessage()):"Error Connecting to Server");var e=h.metaData||{};Ext.Viewport.setMasked(false);switch(e.rescode){case"server_error":Ext.device.Notification.show({title:"Server Error(s)",message:q,callback:function(){if(e.session_timeout){Genesis.constants.removeLocalDBAttrib("auth_code");o.setLoggedIn(false);o.onFeatureTap("MainPage","login");}else{}}});break;case"login_invalid_facebook_info":Ext.device.Notification.show({title:"Create Account",message:"Create user account using Facebook Profile information",callback:function(s){o.setLoggedIn(false);Genesis.constants.removeLocalDBAttrib("auth_code");var r=a.getController("MainPage");a.dispatch({action:"onCreateAccountTap",args:[null,null,null,null],controller:r,scope:r});}});break;case"update_account_invalid_info":case"signup_invalid_info":case"update_account_invalid_facebook_info":case"login_invalid_info":Ext.device.Notification.show({title:"Error",message:q,callback:function(){o.setLoggedIn(false);Genesis.constants.resetStorage();o.onFeatureTap("MainPage","login");}});break;default:Ext.device.Notification.show({title:"Error",message:q});break;}};if((n===true)||(Genesis.constants.isNative()===true)){try{l=h.process(d);}catch(j){console.debug("Ajax call is failed message=["+j.message+"] url=["+f.getUrl()+"]");c.setException(c,{status:null,statusText:j.message});k.fireEvent("exception",this,d,c);g();return;}if(c.process(b,l,f,d)===false){this.fireEvent("exception",this,d,c);g();}}else{console.debug("Ajax call is failed status=["+d.status+"] url=["+f.getUrl()+"]");k.setException(c,d);k.fireEvent("exception",this,d,c);g();}if(typeof m=="function"){m.call(p||k,c);}k.afterRequest(f,n);},buildRequest:function(b){var a=Genesis.constants.getLocalDB();if(a.auth_code){this.setExtraParam("auth_token",a.auth_code);}else{delete this.getExtraParams()["auth_token"];}var c=this.callParent(arguments);if(b.initialConfig.jsonData){c.setJsonData(b.initialConfig.jsonData);}return c;}});Ext.define("Genesis.data.Connection",{override:"Ext.data.Connection",parseStatus:function(a){a=a==1223?204:a;var c=(a>=200&&a<300)||a==304,b=false;if(Genesis.constants.isNative()&&(a===0)){c=true;}if(!c){switch(a){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:b=true;break;}}return({success:c,isException:b});}});Ext.define("Genesis.data.association.BelongsTo",{override:"Ext.data.association.BelongsTo",read:function(b,a,c){b[this.getInstanceName()]=a.read(c).getRecords()[0];}});Ext.define("Genesis.field.Select",{override:"Ext.field.Select",getListPanel:function(){if(!this.listPanel){this.listPanel=Ext.create("Ext.Panel",{top:0,left:0,height:"9em",modal:true,cls:Ext.baseCSSPrefix+"select-overlay",layout:"fit",hideOnMaskTap:true,items:{xtype:"list",store:this.getStore(),itemTpl:'<span class="x-list-label">{'+this.getDisplayField()+"}</span>",listeners:{select:this.onListSelect,itemtap:this.onListTap,scope:this}}});}return this.listPanel;}});Ext.define("Genesis.dataview.element.List",{override:"Ext.dataview.element.List",updateListItem:function(b,k){var g=this,c=g.dataview,j=Ext.fly(k),f=j.down(g.labelClsCache,true),a=b.getData(true),d=a&&a.hasOwnProperty("disclosure"),l=a&&a.hasOwnProperty("iconSrc"),e,h;f.innerHTML=c.getItemTpl().apply(a);if(d&&c.getOnItemDisclosure()){e=j.down(g.disclosureClsCache);if(!e){e=j.down(g.disclosureClsCache+g.hiddenDisplayCache);e[d?"removeCls":"addCls"](g.disclosureClsCache+g.hiddenDisplayCache);e.addCls(g.disclosureClsCache);}else{e[d?"removeCls":"addCls"](g.hiddenDisplayCache);}}if(c.getIcon()){h=j.down(g.iconClsCache,true);h.style.backgroundImage=l?'url("'+l+'")':"";}}});Ext.define("Genesis.tab.Bar",{override:"Ext.tab.Bar",doSetActiveTab:function(b,a){this.callParent(arguments);this.fireAction("tabchange",[this,b,a]);}});Ext.define("Genesis.device.connection.PhoneGap",{override:"Ext.device.connection.PhoneGap",syncOnline:function(){var a=navigator.network.connection.type;this._type=a;this._online=(a!=Connection.NONE)&&(a!=Connection.UNKNOWN);}});Ext.define("Genesis.plugin.PullRefresh",{override:"Ext.plugin.PullRefresh",resetRefreshState:function(){Ext.device.Notification.beep(1);this.callParent(arguments);}});Ext.merge(Array.prototype,{binarySearch:function(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=Math.floor((a+e)/2);d=b(this[c],f);if(d<0){a=c+1;continue;}if(d>0){e=c-1;continue;}return c;}return null;}});Ext.merge(String.prototype,{getFuncBody:function(){var a=this.toString();a=a.replace(/[^{]+\{/,"");a=a.substring(0,a.length-1);a=a.replace(/\n/gi,"");if(!a.match(/\(.*\)/gi)){a+=")";}return a;},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");},stripScripts:function(){return this.replace(new RegExp("<noscript[^>]*?>([\\S\\s]*?)</noscript>","img"),"").replace(new RegExp("<script[^>]*?>([\\S\\s]*?)<\/script>","img"),"").replace(new RegExp("<link[^>]*?>([\\S\\s]*?)</link>","img"),"").replace(new RegExp("<link[^>]*?>","img"),"").replace(new RegExp("<iframe[^>]*?>([\\S\\s]*?)</iframe>","img"),"").replace(new RegExp("<iframe[^>]*?>","img"),"").replace(new RegExp("<embed[^>]*?>([\\S\\s]*?)</embed>","img"),"").replace(new RegExp("<embed[^>]*?>","img"),"").replace(new RegExp("<object[^>]*?>([\\S\\s]*?)</object>","img"),"").replace(new RegExp("<object[^>]*?>","img"),"").replace(new RegExp("<applet[^>]*?>([\\S\\s]*?)</applet>","img"),"").replace(new RegExp("<applet[^>]*?>","img"),"").replace(new RegExp("<button[^>]*?>([\\S\\s]*?)</button>","img"),"").replace(new RegExp("<button[^>]*?>","img"),"").replace(new RegExp("<input[^>]*?>([\\S\\s]*?)</input>","img"),"").replace(new RegExp("<input[^>]*?>","img"),"").replace(new RegExp("<style[^>]*?>([\\S\\s]*?)</style>","img"),"").replace(new RegExp("<style[^>]*?>","img"),"");},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"");},stripComments:function(){return this.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/g,"");},times:function(c){var b="";for(var a=0;a<c;a++){b+=this;}return b;},zp:function(a){return("0".times(a-this.length)+this);},capitalize:function(){return this.replace(/\w+/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1);});},uncapitalize:function(){return this.replace(/\w+/g,function(b){return b.charAt(0).toLowerCase()+b.substr(1);});},trim:function(a){if(a=="left"){return this.replace(/^\s*/,"");}if(a=="right"){return this.replace(/\s*$/,"");}if(a=="normalize"){return this.replace(/\s{2,}/g," ").trim();}return this.trim("left").trim("right");},trunc:function(a){return(this.length>(a-4))?this.substring(0,a-4)+" ...":this;},htmlEncode:(function(){var d={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},b=[],c,a;for(c in d){b.push(c);}a=new RegExp("("+b.join("|")+")","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){return d[f];});};})(),htmlDecode:(function(){var d={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'},b=[],c,a;for(c in d){b.push(c);}a=new RegExp("("+b.join("|")+"|&#[0-9]{1,5};)","g");return function(e){return(!e)?e:String(e).replace(a,function(g,f){if(f in d){return d[f];}else{return String.fromCharCode(parseInt(f.substr(2),10));}});};})()});