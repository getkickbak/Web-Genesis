<!DOCTYPE html>
<html>
   <head>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta property="fb:admins" content="725565520"/>
      <meta property="fb:app_id" content="197968780267830"/>
      <!-- Default Fontsize = 11px
      iPad @132dpi = 100% - iPhone @163dpi = 114% - iPhone Retina @326dpi = 228%
      -->
      <style rel="stylesheet" type="text/css" media="only screen and (-webkit-min-device-pixel-ratio: 2)">
         body {
            font-size : 228%;
         }
      </style>
      <!-- Dirty hack for Android qHD devices -->
      <style rel="stylesheet"type="text/css"  media="screen and (-webkit-device-pixel-ratio: 1.5) and (min-device-width: 360px) and (max-device-width: 360px)">
         body {
            font-size : 171%;
         }
      </style>
      <!-- iPad/iPhone specific css below, add after your main css >
      <link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="ipad.css" type="text/css" />
      <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="iphone.css" type="text/css" />
      -->
      <!--
      <link rel="apple-touch-startup-image" media="screen and (resolution: 326dpi)" href="resources/img/startup_640.jpg" />
      <link rel="apple-touch-startup-image" media="screen and (resolution: 163dpi)" href="resources/img/startup.jpg" />
      <link rel="apple-touch-icon-precomposed" href="resouces/img/icon_57.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="resources/img/icon_72.png"/>
      <link rel="apple-touch-icon-precomposed" sizes="114x114" href="resources/img/icon_114.png"/>
      -->
      <meta name="apple-mobile-web-app-capable" content="yes" />
      <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <title>Genesis</title>
      <link rel="stylesheet" href="resources/css/sencha-touch.css" type="text/css">
      <!-- If your application is targeting iOS BEFORE 4.0 you MUST put json2.js from http://www.JSON.org/json2.js into your www
      <script type="text/javascript" src="lib/sencha-touch-2.0.0-pr3/a/all-classes.js"></script>
      directory and include it here -->
      <script type="text/javascript" src="lib/date.js"></script>
      <script type="text/javascript" src="lib/Datejs-all/src/extras.js"></script>
      <!-- Debug Javascript on mobile browser -->
      <script type="text/javascript" src="lib/sencha-touch-2.0.0-commercial/sencha-touch-all-debug.js"></script>
      <!--
      Phone Gap Libs
      -->
      <script type="text/javascript" src="lib/cordova-1.5.0.js"></script>
      <script type="text/javascript">
         var phoneGapAvailable = false;
         var appPath = "app";

         var browser = Ext.browser;
         if(!!window.isNK)
         {
            browser.setFlag('WebView');
            browser.setFlag('Sencha');
         }
         browser.setFlag('PhonGap', false);

         //
         // Bug fix to prevent bunching up of cls aggregation
         //
         //Ext.baseCSSPrefix = ' ' + Ext.baseCSSPrefix;

         Ext.Loader.setConfig(
         {
            enabled : true,
            paths :
            {
               Ext : 'lib/sencha-touch-2.0.0-commercial/src',
               Genesis : appPath
            }
         });
         Ext.data.reader.Reader.addConfig(
         {
            messageProperty : 'message'
         });

         window.fbAsyncInit = function()
         {
            FB.init(
            {
               appId : "197968780267830",
               useCachedDialogs : true,
               frictionlessRequests : true,
               status : true,
               cookie : true,
               xfbml : true,
               oauth : true
            });
         }
      </script>
      <script type="text/javascript" src="lib/QRCodeReader.js"></script>
      <script type="text/javascript" src="lib/FileTransfer.js"></script>
      <!--
      SenchaTouch Libs
      -->
      <script type="text/javascript" src="lib/Overrides.js"></script>
      <!-- View Widgets -->
      <script type="text/javascript" src="app/profile/Iphone.js"></script>
      <script type="text/javascript" src="app/profile/Android.js"></script>
      <script type="text/javascript" src="app/profile/Desktop.js"></script>
      <!-- View Widgets -->
      <script type="text/javascript" src="app/view/widgets/Scroll.js"></script>
      <script type="text/javascript" src="app/view/widgets/ListField.js"></script>
      <script type="text/javascript" src="app/view/widgets/NavigationBar.js"></script>
      <script type="text/javascript" src="app/view/widgets/CheckinMerchantDetailsItem.js"></script>
      <script type="text/javascript" src="app/view/widgets/ChallengeMenuItem.js"></script>
      <script type="text/javascript" src="app/view/widgets/RewardItem.js"></script>
      <script type="text/javascript" src="app/view/widgets/MerchantAccountPtsItem.js"></script>
      <script type="text/javascript" src="app/view/widgets/RedemptionsPtsItem.js"></script>
      <script type="text/javascript" src="app/view/widgets/RewardsCartItem.js"></script>
      <!-- Models -->
      <script type="text/javascript" src="app/model/frontend/MainPage.js"></script>
      <script type="text/javascript" src="app/model/UserProfile.js"></script>
      <script type="text/javascript" src="app/model/User.js"></script>
      <script type="text/javascript" src="app/model/Merchant.js"></script>
      <script type="text/javascript" src="app/model/Challenge.js"></script>
      <script type="text/javascript" src="app/model/Checkin.js"></script>
      <script type="text/javascript" src="app/model/PurchaseReward.js"></script>
      <script type="text/javascript" src="app/model/CustomerReward.js"></script>
      <script type="text/javascript" src="app/model/EarnPrize.js"></script>
      <script type="text/javascript" src="app/model/Venue.js"></script>
      <script type="text/javascript" src="app/model/EligibleReward.js"></script>
      <script type="text/javascript" src="app/model/Customer.js"></script>
      <script type="text/javascript" src="app/model/frontend/Account.js"></script>
      <script type="text/javascript" src="app/model/frontend/Signin.js"></script>
      <script type="text/javascript" src="app/model/frontend/RewardsMainTemplate.js"></script>
      <!-- Views -->
      <script type="text/javascript" src="app/view/ViewBase.js"></script>
      <script type="text/javascript" src="app/view/CheckinMerchant.js"></script>
      <script type="text/javascript" src="app/view/CheckinExplore.js"></script>
      <script type="text/javascript" src="app/view/Viewport.js"></script>
      <script type="text/javascript" src="app/view/ChallengePage.js"></script>
      <script type="text/javascript" src="app/view/MainPage.js"></script>
      <script type="text/javascript" src="app/view/SettingsPage.js"></script>
      <script type="text/javascript" src="app/view/LoginPage.js"></script>
      <script type="text/javascript" src="app/view/Accounts.js"></script>
      <script type="text/javascript" src="app/view/MerchantAccount.js"></script>
      <script type="text/javascript" src="app/view/Rewards.js"></script>
      <script type="text/javascript" src="app/view/Redemptions.js"></script>
      <script type="text/javascript" src="app/view/Prizes.js"></script>
      <!-- Controllers -->
      <script type="text/javascript" src="app/controller/ControllerBase.js"></script>
      <script type="text/javascript" src="app/controller/Viewport.js"></script>
      <script type="text/javascript" src="app/controller/Settings.js"></script>
      <script type="text/javascript" src="app/controller/MainPage.js"></script>
      <script type="text/javascript" src="app/controller/Checkins.js"></script>
      <script type="text/javascript" src="app/controller/Challenges.js"></script>
      <script type="text/javascript" src="app/controller/Merchants.js"></script>
      <script type="text/javascript" src="app/controller/RewardsRedemptions.js"></script>
      <script type="text/javascript" src="app/controller/Merchants.js"></script>
      <script type="text/javascript" src="app/controller/Accounts.js"></script>
      <script type="text/javascript" src="app/controller/Prizes.js"></script>
      <!-- External Libs -->
      <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
   </head>
   <body>
      <div id="fb-root"></div>
      <script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
      <script type="text/javascript">
         // If you want to prevent dragging, uncomment this section
         /*
          function preventBehavior(e)
          {
          e.preventDefault();
          };
          document.addEventListener("touchmove", preventBehavior, false);
          */

         /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
          see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
          for more details -jm */
         /*
          function handleOpenURL(url)
          {
          // TODO: do something with the url passed in.
          }
          */
         /* When this function is called, PhoneGap has been initialized and is ready to roll */
         /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
          see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
          for more details -jm */

         function appInit()
         {
            console.log("appInit - start");
            Ext.require(['Ext.device.Camera', 'Ext.device.Communicator', 'Ext.device.Connection', 'Ext.device.Notification', 'Ext.device.Orientation']);
            Ext.application(
            {
               profiles : ['Iphone', 'Android', 'Desktop'],
               //models : ['Checkin', 'Customer', 'Deal', 'EarnRewardRecord', 'Merchant', 'Reward', 'CustomerReward',
               // 'PurchaseReward',
               //'SubDeal', 'User', 'UserProfile',
               //'Venue'],
               views : ['ChallengePage',
               // 'MenuChallenge', 'NewsfeedPage'
               'CheckinExplore',
               // Main Page when the user has never checked-in before
               //,'CheckinMerchantMainPage'
               // Main Page when the user has checked-in before
               'CheckinMerchant', 'LoginPage', 'SignInPage', 'MainPage',
               //'MerchantAccountBrowse','MerchantAcountPage',
               'MerchantAccount',
               //'QRCodeDisplayMode', 'QRCodeScanMode'
               'Rewards', 'Redemptions', 'Accounts', 'Prizes', 'SettingsPage', 'Viewport'],
               controllers : ['Viewport', 'MainPage', 'Challenges', 'Merchants', 'RewardsRedemptions', 'Accounts',
               //'Coupons','Newsfeeds', 'QrCodeDisplay',
               'Settings', 'Checkins', 'Prizes'],
               stores : [],
               launch : function()
               {
                  console.log("Launching App");
                  Ext.create('Genesis.view.Viewport');
                  this.getController('Viewport').openMainPage();
                  console.log("Launched App");
               },
               appFolder : appPath,
               name : 'Genesis'
            });

            console.log("appInit - end");
         }

         function onDeviceReady()
         {
            document.addEventListener("online", function()
            {
               console.log("Phone is Online");
            }, false);

            document.addEventListener("offline", function()
            {
               console.log("Phone is Offline");
            }, false);
            document.addEventListener("pause", function()
            {
               console.log("App is Paused");
            }, false);

            document.addEventListener("resume", function()
            {
               console.log("App is Resumed");
            }, false);
            console.log("onDeviceReady");
            appInit();
         }


         document.addEventListener("deviceready", onDeviceReady, false);
         window.onerror = function(e, url, linenum)
         {
            console.log("Error on Line#" + linenum + "\n" + e);
         }
         console.log("SystemInit");
         appInit();

      </script>
   </body>
</html>
