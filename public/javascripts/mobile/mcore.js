(function(a,d,c,e){if(typeof c.module!=="undefined"&&c.module["exports"]){if(e&&c.require){for(var b=0;b<e.length;b++){c[e[b]]=c.require(e[b]);}}c.module["exports"]=d.apply(c);}else{if(typeof c.define!=="undefined"&&c.define==="function"&&c.define["amd"]){define(a,(e||[]),d);}else{c[a]=d.apply(c);}}})("utf8",function(){return{encode:function(c){if(typeof c!=="string"){return c;}else{c=c.replace(/\r\n/g,"\n");}var b="",d=0,a;for(d;d<c.length;d++){a=c.charCodeAt(d);if(a<128){b+=String.fromCharCode(a);}else{if((a>127)&&(a<2048)){b+=String.fromCharCode((a>>6)|192),b+=String.fromCharCode((a&63)|128);}else{b+=String.fromCharCode((a>>12)|224),b+=String.fromCharCode(((a>>6)&63)|128),b+=String.fromCharCode((a&63)|128);}}}return b;},decode:function(c){if(typeof c!=="string"){return c;}var b="",d=0,a=0;while(d<c.length){a=c.charCodeAt(d);if(a<128){b+=String.fromCharCode(a),d++;}else{if((a>191)&&(a<224)){b+=String.fromCharCode(((a&31)<<6)|(c.charCodeAt(d+1)&63)),d+=2;}else{b+=String.fromCharCode(((a&15)<<12)|((c.charCodeAt(d+1)&63)<<6)|(c.charCodeAt(d+2)&63)),d+=3;}}}return b;}};},this);(function(a,d,c,e){if(typeof c.module!=="undefined"&&c.module["exports"]){if(e&&c.require){for(var b=0;b<e.length;b++){c[e[b]]=c.require(e[b]);}}c.module["exports"]=d.apply(c);}else{if(typeof c.define!=="undefined"&&c.define==="function"&&c.define["amd"]){define(a,(e||[]),d);}else{c[a]=d();}}})("base64",function(a){var c=this;var d=a||this.utf8;var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(s){if(typeof c.btoa!=="undefined"){return c.btoa(s);}if(typeof d==="undefined"){throw {error:"MissingMethod",message:"UTF8 Module is missing."};}if(typeof s!=="string"){return s;}else{s=d.encode(s);}var h="",t,q,p,o,m,l,k,j=0;while(j<s.length){t=s.charCodeAt(j++);q=s.charCodeAt(j++);p=s.charCodeAt(j++);o=t>>2;m=((t&3)<<4)|(q>>4);l=((q&15)<<2)|(p>>6);k=p&63;if(isNaN(q)){l=k=64;}else{if(isNaN(p)){k=64;}}h+=b.charAt(o)+b.charAt(m)+b.charAt(l)+b.charAt(k);}return h;},decode:function(s){if(typeof c.atob!=="undefined"){return c.atob(s);}if(typeof d==="undefined"){throw {error:"MissingMethod",message:"UTF8 Module is missing."};}if(typeof s!=="string"){return s;}else{s.replace(/[^A-Za-z0-9\+\/\=]/g,"");}var h="",t,q,p,o,m,l,k,j=0;while(j<s.length){o=b.indexOf(s.charAt(j++));m=b.indexOf(s.charAt(j++));l=b.indexOf(s.charAt(j++));k=b.indexOf(s.charAt(j++));t=(o<<2)|(m>>4);q=((m&15)<<4)|(l>>2);p=((l&3)<<6)|k;h+=String.fromCharCode(t);if(l!=64){h+=String.fromCharCode(q);}if(k!=64){h+=String.fromCharCode(p);}}return d.decode(h);}};},this,["utf8"]);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var b=Date,a=b.prototype,d=b.CultureInfo,g=function(i,h){if(!h){h=2;}return("000"+i).slice(h*-1);};a.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};a.setTimeToNow=function(){var h=new Date();this.setHours(h.getHours());this.setMinutes(h.getMinutes());this.setSeconds(h.getSeconds());this.setMilliseconds(h.getMilliseconds());return this;};b.today=function(){return new Date().clearTime();};b.compare=function(i,h){if(isNaN(i)||isNaN(h)){throw new Error(i+" - "+h);}else{if(i instanceof Date&&h instanceof Date){return(i<h)?-1:(i>h)?1:0;}else{throw new TypeError(i+" - "+h);}}};b.equals=function(i,h){return(i.compareTo(h)===0);};b.getDayNumberFromName=function(j){var q=d.dayNames,h=d.abbreviatedDayNames,p=d.shortestDayNames,l=j.toLowerCase();for(var k=0;k<q.length;k++){if(q[k].toLowerCase()==l||h[k].toLowerCase()==l||p[k].toLowerCase()==l){return k;}}return -1;};b.getMonthNumberFromName=function(j){var o=d.monthNames,h=d.abbreviatedMonthNames,l=j.toLowerCase();for(var k=0;k<o.length;k++){if(o[k].toLowerCase()==l||h[k].toLowerCase()==l){return k;}}return -1;};b.isLeapYear=function(h){return((h%4===0&&h%100!==0)||h%400===0);};b.getDaysInMonth=function(h,i){return[31,(b.isLeapYear(h)?29:28),31,30,31,30,31,31,30,31,30,31][i];};b.getTimezoneAbbreviation=function(l){var k=d.timezones,j;for(var h=0;h<k.length;h++){if(k[h].offset===l){return k[h].name;}}return null;};b.getTimezoneOffset=function(h){var l=d.timezones,k;for(var j=0;j<l.length;j++){if(l[j].name===h.toUpperCase()){return l[j].offset;}}return null;};a.clone=function(){return new Date(this.getTime());};a.compareTo=function(h){return Date.compare(this,h);};a.equals=function(h){return Date.equals(this,h||new Date());};a.between=function(i,h){return this.getTime()>=i.getTime()&&this.getTime()<=h.getTime();};a.isAfter=function(h){return this.compareTo(h||new Date())===1;};a.isBefore=function(h){return(this.compareTo(h||new Date())===-1);};a.isToday=function(){return this.isSameDay(new Date());};a.isSameDay=function(h){return this.clone().clearTime().equals(h.clone().clearTime());};a.addMilliseconds=function(h){this.setMilliseconds(this.getMilliseconds()+h);return this;};a.addSeconds=function(h){return this.addMilliseconds(h*1000);};a.addMinutes=function(h){return this.addMilliseconds(h*60000);};a.addHours=function(h){return this.addMilliseconds(h*3600000);};a.addDays=function(h){this.setDate(this.getDate()+h);return this;};a.addWeeks=function(h){return this.addDays(h*7);};a.addMonths=function(h){var i=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+h);this.setDate(Math.min(i,b.getDaysInMonth(this.getFullYear(),this.getMonth())));return this;};a.addYears=function(h){return this.addMonths(h*12);};a.add=function(i){if(typeof i=="number"){this._orient=i;return this;}var h=i;if(h.milliseconds){this.addMilliseconds(h.milliseconds);}if(h.seconds){this.addSeconds(h.seconds);}if(h.minutes){this.addMinutes(h.minutes);}if(h.hours){this.addHours(h.hours);}if(h.weeks){this.addWeeks(h.weeks);}if(h.months){this.addMonths(h.months);}if(h.years){this.addYears(h.years);}if(h.days){this.addDays(h.days);}return this;};var e,f,c;a.getWeek=function(){var p,o,m,l,k,j,i,h,t,q;e=(!e)?this.getFullYear():e;f=(!f)?this.getMonth()+1:f;c=(!c)?this.getDate():c;if(f<=2){p=e-1;o=(p/4|0)-(p/100|0)+(p/400|0);m=((p-1)/4|0)-((p-1)/100|0)+((p-1)/400|0);t=o-m;k=0;j=c-1+(31*(f-1));}else{p=e;o=(p/4|0)-(p/100|0)+(p/400|0);m=((p-1)/4|0)-((p-1)/100|0)+((p-1)/400|0);t=o-m;k=t+1;j=c+((153*(f-3)+2)/5)+58+t;}i=(p+o)%7;l=(j+i-k)%7;h=(j+3-l)|0;if(h<0){q=53-((i-t)/5|0);}else{if(h>364+t){q=1;}else{q=(h/7|0)+1;}}e=f=c=null;return q;};a.getISOWeek=function(){e=this.getUTCFullYear();f=this.getUTCMonth()+1;c=this.getUTCDate();return g(this.getWeek());};a.setWeek=function(h){return this.moveToDayOfWeek(1).addWeeks(h-this.getWeek());};b._validate=function(k,j,h,i){if(typeof k=="undefined"){return false;}else{if(typeof k!="number"){throw new TypeError(k+" is not a Number.");}else{if(k<j||k>h){throw new RangeError(k+" is not a valid value for "+i+".");}}}return true;};b.validateMillisecond=function(h){return b._validate(h,0,999,"millisecond");};b.validateSecond=function(h){return b._validate(h,0,59,"second");};b.validateMinute=function(h){return b._validate(h,0,59,"minute");};b.validateHour=function(h){return b._validate(h,0,23,"hour");};b.validateDay=function(i,h,j){return b._validate(i,1,b.getDaysInMonth(h,j),"day");};b.validateMonth=function(h){return b._validate(h,0,11,"month");};b.validateYear=function(h){return b._validate(h,0,9999,"year");};a.set=function(h){if(b.validateMillisecond(h.millisecond)){this.addMilliseconds(h.millisecond-this.getMilliseconds());}if(b.validateSecond(h.second)){this.addSeconds(h.second-this.getSeconds());}if(b.validateMinute(h.minute)){this.addMinutes(h.minute-this.getMinutes());}if(b.validateHour(h.hour)){this.addHours(h.hour-this.getHours());}if(b.validateMonth(h.month)){this.addMonths(h.month-this.getMonth());}if(b.validateYear(h.year)){this.addYears(h.year-this.getFullYear());}if(b.validateDay(h.day,this.getFullYear(),this.getMonth())){this.addDays(h.day-this.getDate());}if(h.timezone){this.setTimezone(h.timezone);}if(h.timezoneOffset){this.setTimezoneOffset(h.timezoneOffset);}if(h.week&&b._validate(h.week,0,53,"week")){this.setWeek(h.week);}return this;};a.moveToFirstDayOfMonth=function(){return this.set({day:1});};a.moveToLastDayOfMonth=function(){return this.set({day:b.getDaysInMonth(this.getFullYear(),this.getMonth())});};a.moveToNthOccurrence=function(i,j){var h=0;if(j>0){h=j-1;}else{if(j===-1){this.moveToLastDayOfMonth();if(this.getDay()!==i){this.moveToDayOfWeek(i,-1);}return this;}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(i,+1).addWeeks(h);};a.moveToDayOfWeek=function(h,i){var j=(h-this.getDay()+7*(i||+1))%7;return this.addDays((j===0)?j+=7*(i||+1):j);};a.moveToMonth=function(j,h){var i=(j-this.getMonth()+12*(h||+1))%12;return this.addMonths((i===0)?i+=12*(h||+1):i);};a.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1;};a.getTimezone=function(){return b.getTimezoneAbbreviation(this.getUTCOffset());};a.setTimezoneOffset=function(j){var h=this.getTimezoneOffset(),i=Number(j)*-6/10;return this.addMinutes(i-h);};a.setTimezone=function(h){return this.setTimezoneOffset(b.getTimezoneOffset(h));};a.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset());};a.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset());};a.getUTCOffset=function(){var i=this.getTimezoneOffset()*-10/6,h;if(i<0){h=(i-10000).toString();return h.charAt(0)+h.substr(2);}else{h=(i+10000).toString();return"+"+h.substr(1);}};a.getElapsed=function(h){return(h||new Date())-this;};if(!a.toISOString){a.toISOString=function(){function h(i){return i<10?"0"+i:i;}return'"'+this.getUTCFullYear()+"-"+h(this.getUTCMonth()+1)+"-"+h(this.getUTCDate())+"T"+h(this.getUTCHours())+":"+h(this.getUTCMinutes())+":"+h(this.getUTCSeconds())+'Z"';};}a._toString=a.toString;a.toString=function(j){var h=this;if(j&&j.length==1){var k=d.formatPatterns;h.t=h.toString;switch(j){case"d":return h.t(k.shortDate);case"D":return h.t(k.longDate);case"F":return h.t(k.fullDateTime);case"m":return h.t(k.monthDay);case"r":return h.t(k.rfc1123);case"s":return h.t(k.sortableDateTime);case"t":return h.t(k.shortTime);case"T":return h.t(k.longTime);case"u":return h.t(k.universalSortableDateTime);case"y":return h.t(k.yearMonth);}}var i=function(l){switch(l*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};return j?j.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(l){if(l.charAt(0)==="\\"){return l.replace("\\","");}h.h=h.getHours;switch(l){case"hh":return g(h.h()<13?(h.h()===0?12:h.h()):(h.h()-12));case"h":return h.h()<13?(h.h()===0?12:h.h()):(h.h()-12);case"HH":return g(h.h());case"H":return h.h();case"mm":return g(h.getMinutes());case"m":return h.getMinutes();case"ss":return g(h.getSeconds());case"s":return h.getSeconds();case"yyyy":return g(h.getFullYear(),4);case"yy":return g(h.getFullYear());case"dddd":return d.dayNames[h.getDay()];case"ddd":return d.abbreviatedDayNames[h.getDay()];case"dd":return g(h.getDate());case"d":return h.getDate();case"MMMM":return d.monthNames[h.getMonth()];case"MMM":return d.abbreviatedMonthNames[h.getMonth()];case"MM":return g((h.getMonth()+1));case"M":return h.getMonth()+1;case"t":return h.h()<12?d.amDesignator.substring(0,1):d.pmDesignator.substring(0,1);case"tt":return h.h()<12?d.amDesignator:d.pmDesignator;case"S":return i(h.getDate());default:return l;}}):this._toString();};}());(function(){var w=Date,g=w.prototype,x=w.CultureInfo,p=Number.prototype;g._orient=+1;g._nth=null;g._is=false;g._same=false;g._isSecond=false;p._dateElement="day";g.next=function(){this._orient=+1;return this;};w.next=function(){return w.today().next();};g.last=g.prev=g.previous=function(){this._orient=-1;return this;};w.last=w.prev=w.previous=function(){return w.today().last();};g.is=function(){this._is=true;return this;};g.same=function(){this._same=true;this._isSecond=false;return this;};g.today=function(){return this.same().day();};g.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun());}return false;};g.at=function(i){return(typeof i==="string")?w.parse(this.toString("d")+" "+i):this.set(i);};p.fromNow=p.after=function(i){var j={};j[this._dateElement]=this;return((!i)?new Date():i.clone()).add(j);};p.ago=p.before=function(i){var j={};j[this._dateElement]=this*-1;return((!i)?new Date():i.clone()).add(j);};var e=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),h=("january february march april may june july august september october november december").split(/\s/),o=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),q=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),b=("final first second third fourth fifth").split(/\s/),z;g.toObject=function(){var k={};for(var j=0;j<o.length;j++){k[o[j].toLowerCase()]=this["get"+q[j]]();}return k;};w.fromObject=function(i){i.week=null;return Date.today().set(i);};var y=function(i){return function(){if(this._is){this._is=false;return this.getDay()==i;}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1);}this._isSecond=false;var k=this._nth;this._nth=null;var j=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(i,k);if(this>j){throw new RangeError(w.getDayName(i)+" does not occur "+k+" times in the month of "+w.getMonthName(j.getMonth())+" "+j.getFullYear()+".");}return this;}return this.moveToDayOfWeek(i,this._orient);};};var f=function(i){return function(){var k=w.today(),j=i-k.getDay();if(i===0&&x.firstDayOfWeek===1&&k.getDay()!==0){j=j+7;}return k.addDays(j);};};for(var v=0;v<e.length;v++){w[e[v].toUpperCase()]=w[e[v].toUpperCase().substring(0,3)]=v;w[e[v]]=w[e[v].substring(0,3)]=f(v);g[e[v]]=g[e[v].substring(0,3)]=y(v);}var A=function(i){return function(){if(this._is){this._is=false;return this.getMonth()===i;}return this.moveToMonth(i,this._orient);};};var m=function(i){return function(){return w.today().set({month:i,day:1});};};for(var u=0;u<h.length;u++){w[h[u].toUpperCase()]=w[h[u].toUpperCase().substring(0,3)]=u;w[h[u]]=w[h[u].substring(0,3)]=m(u);g[h[u]]=g[h[u].substring(0,3)]=A(u);}var c=function(i){return function(){if(this._isSecond){this._isSecond=false;return this;}if(this._same){this._same=this._is=false;var D=this.toObject(),C=(arguments[0]||new Date()).toObject(),B="",l=i.toLowerCase();for(var j=(o.length-1);j>-1;j--){B=o[j].toLowerCase();if(D[B]!=C[B]){return false;}if(l==B){break;}}return true;}if(i.substring(i.length-1)!="s"){i+="s";}return this["add"+i](this._orient);};};var d=function(i){return function(){this._dateElement=i;return this;};};for(var t=0;t<o.length;t++){z=o[t].toLowerCase();g[z]=g[z+"s"]=c(o[t]);p[z]=p[z+"s"]=d(z);}g._ss=c("Second");var a=function(i){return function(j){if(this._same){return this._ss(arguments[0]);}if(j||j===0){return this.moveToNthOccurrence(j,i);}this._nth=i;if(i===2&&(j===undefined||j===null)){this._isSecond=true;return this.addSeconds(this._orient);}return this;};};for(var s=0;s<b.length;s++){g[b[s]]=(s===0)?a(-1):a(s);}}());(function(){Date.Parsing={Exception:function(i){this.message="Parse error at '"+i.substring(0,10)+" ...'";}};var a=Date.Parsing;var c=a.Operators={rtoken:function(i){return function(j){var k=j.match(i);if(k){return([k[0],j.substring(k[0].length)]);}else{throw new a.Exception(j);}};},token:function(i){return function(j){return c.rtoken(new RegExp("^s*"+j+"s*"))(j);};},stoken:function(i){return c.rtoken(new RegExp("^"+i));},until:function(i){return function(j){var k=[],m=null;while(j.length){try{m=i.call(this,j);}catch(l){k.push(m[0]);j=m[1];continue;}break;}return[k,j];};},many:function(i){return function(j){var m=[],k=null;while(j.length){try{k=i.call(this,j);}catch(l){return[m,j];}m.push(k[0]);j=k[1];}return[m,j];};},optional:function(i){return function(j){var k=null;try{k=i.call(this,j);}catch(l){return[null,j];}return[k[0],k[1]];};},not:function(i){return function(j){try{i.call(this,j);}catch(k){return[null,j];}throw new a.Exception(j);};},ignore:function(i){return i?function(j){var k=null;k=i.call(this,j);return[null,k[1]];}:null;},product:function(){var k=arguments[0],l=Array.prototype.slice.call(arguments,1),m=[];for(var j=0;j<k.length;j++){m.push(c.each(k[j],l));}return m;},cache:function(k){var i={},j=null;return function(l){try{j=i[l]=(i[l]||k.call(this,l));}catch(m){j=i[l]=m;}if(j instanceof a.Exception){throw j;}else{return j;}};},any:function(){var i=arguments;return function(k){var l=null;for(var j=0;j<i.length;j++){if(i[j]==null){continue;}try{l=(i[j].call(this,k));}catch(m){l=null;}if(l){return l;}}throw new a.Exception(k);};},each:function(){var i=arguments;return function(k){var o=[],l=null;for(var j=0;j<i.length;j++){if(i[j]==null){continue;}try{l=(i[j].call(this,k));}catch(m){throw new a.Exception(k);}o.push(l[0]);k=l[1];}return[o,k];};},all:function(){var j=arguments,i=i;return i.each(i.optional(j));},sequence:function(i,j,k){j=j||c.rtoken(/^\s*/);k=k||null;if(i.length==1){return i[0];}return function(p){var t=null,u=null;var w=[];for(var o=0;o<i.length;o++){try{t=i[o].call(this,p);}catch(v){break;}w.push(t[0]);try{u=j.call(this,t[1]);}catch(m){u=null;break;}p=u[1];}if(!t){throw new a.Exception(p);}if(u){throw new a.Exception(u[1]);}if(k){try{t=k.call(this,t[1]);}catch(l){throw new a.Exception(t[1]);}}return[w,(t?t[1]:p)];};},between:function(j,k,i){i=i||j;var l=c.each(c.ignore(j),k,c.ignore(i));return function(m){var o=l.call(this,m);return[[o[0][0],r[0][2]],o[1]];};},list:function(i,j,k){j=j||c.rtoken(/^\s*/);k=k||null;return(i instanceof Array?c.each(c.product(i.slice(0,-1),c.ignore(j)),i.slice(-1),c.ignore(k)):c.each(c.many(c.each(i,c.ignore(j))),px,c.ignore(k)));},set:function(i,j,k){j=j||c.rtoken(/^\s*/);k=k||null;return function(C){var l=null,o=null,m=null,t=null,u=[[],C],B=false;for(var w=0;w<i.length;w++){m=null;o=null;l=null;B=(i.length==1);try{l=i[w].call(this,C);}catch(z){continue;}t=[[l[0]],l[1]];if(l[1].length>0&&!B){try{m=j.call(this,l[1]);}catch(A){B=true;}}else{B=true;}if(!B&&m[1].length===0){B=true;}if(!B){var x=[];for(var v=0;v<i.length;v++){if(w!=v){x.push(i[v]);}}o=c.set(x,j).call(this,m[1]);if(o[0].length>0){t[0]=t[0].concat(o[0]);t[1]=o[1];}}if(t[1].length<u[1].length){u=t;}if(u[1].length===0){break;}}if(u[0].length===0){return u;}if(k){try{m=k.call(this,u[1]);}catch(y){throw new a.Exception(u[1]);}u[1]=m[1];}return u;};},forward:function(i,j){return function(k){return i[j].call(this,k);};},replace:function(j,i){return function(k){var l=j.call(this,k);return[i,l[1]];};},process:function(j,i){return function(k){var l=j.call(this,k);return[i.call(this,l[0]),l[1]];};},min:function(i,j){return function(k){var l=j.call(this,k);if(l[0].length<i){throw new a.Exception(k);}return l;};}};var h=function(i){return function(){var j=null,m=[];if(arguments.length>1){j=Array.prototype.slice.call(arguments);}else{if(arguments[0] instanceof Array){j=arguments[0];}}if(j){for(var l=0,k=j.shift();l<k.length;l++){j.unshift(k[l]);m.push(i.apply(null,j));j.shift();return m;}}else{return i.apply(null,arguments);}};};var g="optional not ignore cache".split(/\s/);for(var d=0;d<g.length;d++){c[g[d]]=h(c[g[d]]);}var f=function(i){return function(){if(arguments[0] instanceof Array){return i.apply(null,arguments[0]);}else{return i.apply(null,arguments);}};};var e="each any all".split(/\s/);for(var b=0;b<e.length;b++){c[e[b]]=f(c[e[b]]);}}());(function(){var e=Date,l=e.prototype,f=e.CultureInfo;var h=function(m){var o=[];for(var g=0;g<m.length;g++){if(m[g] instanceof Array){o=o.concat(h(m[g]));}else{if(m[g]){o.push(m[g]);}}}return o;};e.Grammar={};e.Translator={hour:function(g){return function(){this.hour=Number(g);};},minute:function(g){return function(){this.minute=Number(g);};},second:function(g){return function(){this.second=Number(g);};},meridian:function(g){return function(){this.meridian=g.slice(0,1).toLowerCase();};},timezone:function(g){return function(){var m=g.replace(/[^\d\+\-]/g,"");if(m.length){this.timezoneOffset=Number(m);}else{this.timezone=g.toLowerCase();}};},day:function(g){var m=g[0];return function(){this.day=Number(m.match(/\d+/)[0]);};},month:function(g){return function(){this.month=(g.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(g)/4:Number(g)-1;};},year:function(g){return function(){var m=Number(g);this.year=((g.length>2)?m:(m+(((m+2000)<f.twoDigitYearMax)?2000:1900)));};},rday:function(g){return function(){switch(g){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(g){g=(g instanceof Array)?g:[g];for(var o=0;o<g.length;o++){if(g[o]){g[o].call(this);}}var m=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=m.getDate();}if(!this.year){this.year=m.getFullYear();}if(!this.month&&this.month!==0){this.month=m.getMonth();}if(!this.day){this.day=1;}if(!this.hour){this.hour=0;}if(!this.minute){this.minute=0;}if(!this.second){this.second=0;}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.day>e.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}var p=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){p.set({timezone:this.timezone});}else{if(this.timezoneOffset){p.set({timezoneOffset:this.timezoneOffset});}}return p;},finish:function(g){g=(g instanceof Array)?h(g):[g];if(g.length===0){return null;}for(var s=0;s<g.length;s++){if(typeof g[s]=="function"){g[s].call(this);}}var o=e.today();if(this.now&&!this.unit&&!this.operator){return new Date();}else{if(this.now){o=new Date();}}var t=!!(this.days&&this.days!==null||this.orient||this.operator);var u,q,p;p=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){o.setTimeToNow();}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;t=true;}}if(!t&&this.weekday&&!this.day&&!this.days){var m=Date[this.weekday]();this.day=m.getDate();if(!this.month){this.month=m.getMonth();}this.year=m.getFullYear();}if(t&&this.weekday&&this.unit!="month"){this.unit="day";u=(e.getDayNumberFromName(this.weekday)-o.getDay());q=7;this.days=u?((u+(p*q))%q):(p*q);}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null;}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1;}if(this.month&&!this.day&&this.value){o.set({day:this.value*1});if(!t){this.day=this.value*1;}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;t=true;}if(t&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";u=(this.month-o.getMonth());q=12;this.months=u?((u+(p*q))%q):(p*q);this.month=null;}if(!this.unit){this.unit="day";}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*p;}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}this[this.unit+"s"]=this.value*p;}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else{if(this.meridian=="a"&&this.hour==12){this.hour=0;}}}if(this.weekday&&!this.day&&!this.days){var m=Date[this.weekday]();this.day=m.getDate();if(m.getMonth()!==o.getMonth()){this.month=m.getMonth();}}if((this.month||this.month===0)&&!this.day){this.day=1;}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value);}if(t&&this.timezone&&this.day&&this.days){this.day=this.days;}return(t)?o.add(this):o.set(this);}};var i=e.Parsing.Operators,d=e.Grammar,k=e.Translator,b;d.datePartDelimiter=i.rtoken(/^([\s\-\.\,\/\x27]+)/);d.timePartDelimiter=i.stoken(":");d.whiteSpace=i.rtoken(/^\s*/);d.generalDelimiter=i.rtoken(/^(([\s\,]|at|@|on)+)/);var a={};d.ctoken=function(q){var p=a[q];if(!p){var s=f.regexPatterns;var o=q.split(/\s+/),m=[];for(var g=0;g<o.length;g++){m.push(i.replace(i.rtoken(s[o[g]]),o[g]));}p=a[q]=i.any.apply(null,m);}return p;};d.ctoken2=function(g){return i.rtoken(f.regexPatterns[g]);};d.h=i.cache(i.process(i.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),k.hour));d.hh=i.cache(i.process(i.rtoken(/^(0[0-9]|1[0-2])/),k.hour));d.H=i.cache(i.process(i.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),k.hour));d.HH=i.cache(i.process(i.rtoken(/^([0-1][0-9]|2[0-3])/),k.hour));d.m=i.cache(i.process(i.rtoken(/^([0-5][0-9]|[0-9])/),k.minute));d.mm=i.cache(i.process(i.rtoken(/^[0-5][0-9]/),k.minute));d.s=i.cache(i.process(i.rtoken(/^([0-5][0-9]|[0-9])/),k.second));d.ss=i.cache(i.process(i.rtoken(/^[0-5][0-9]/),k.second));d.hms=i.cache(i.sequence([d.H,d.m,d.s],d.timePartDelimiter));d.t=i.cache(i.process(d.ctoken2("shortMeridian"),k.meridian));d.tt=i.cache(i.process(d.ctoken2("longMeridian"),k.meridian));d.z=i.cache(i.process(i.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),k.timezone));d.zz=i.cache(i.process(i.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),k.timezone));d.zzz=i.cache(i.process(d.ctoken2("timezone"),k.timezone));d.timeSuffix=i.each(i.ignore(d.whiteSpace),i.set([d.tt,d.zzz]));d.time=i.each(i.optional(i.ignore(i.stoken("T"))),d.hms,d.timeSuffix);d.d=i.cache(i.process(i.each(i.rtoken(/^([0-2]\d|3[0-1]|\d)/),i.optional(d.ctoken2("ordinalSuffix"))),k.day));d.dd=i.cache(i.process(i.each(i.rtoken(/^([0-2]\d|3[0-1])/),i.optional(d.ctoken2("ordinalSuffix"))),k.day));d.ddd=d.dddd=i.cache(i.process(d.ctoken("sun mon tue wed thu fri sat"),function(g){return function(){this.weekday=g;};}));d.M=i.cache(i.process(i.rtoken(/^(1[0-2]|0\d|\d)/),k.month));d.MM=i.cache(i.process(i.rtoken(/^(1[0-2]|0\d)/),k.month));d.MMM=d.MMMM=i.cache(i.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),k.month));d.y=i.cache(i.process(i.rtoken(/^(\d\d?)/),k.year));d.yy=i.cache(i.process(i.rtoken(/^(\d\d)/),k.year));d.yyy=i.cache(i.process(i.rtoken(/^(\d\d?\d?\d?)/),k.year));d.yyyy=i.cache(i.process(i.rtoken(/^(\d\d\d\d)/),k.year));b=function(){return i.each(i.any.apply(null,arguments),i.not(d.ctoken2("timeContext")));};d.day=b(d.d,d.dd);d.month=b(d.M,d.MMM);d.year=b(d.yyyy,d.yy);d.orientation=i.process(d.ctoken("past future"),function(g){return function(){this.orient=g;};});d.operator=i.process(d.ctoken("add subtract"),function(g){return function(){this.operator=g;};});d.rday=i.process(d.ctoken("yesterday tomorrow today now"),k.rday);d.unit=i.process(d.ctoken("second minute hour day week month year"),function(g){return function(){this.unit=g;};});d.value=i.process(i.rtoken(/^\d\d?(st|nd|rd|th)?/),function(g){return function(){this.value=g.replace(/\D/g,"");};});d.expression=i.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,d.MMM]);b=function(){return i.set(arguments,d.datePartDelimiter);};d.mdy=b(d.ddd,d.month,d.day,d.year);d.ymd=b(d.ddd,d.year,d.month,d.day);d.dmy=b(d.ddd,d.day,d.month,d.year);d.date=function(g){return((d[f.dateElementOrder]||d.mdy).call(this,g));};d.format=i.process(i.many(i.any(i.process(i.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(g){if(d[g]){return d[g];}else{throw e.Parsing.Exception(g);}}),i.process(i.rtoken(/^[^dMyhHmstz]+/),function(g){return i.ignore(i.stoken(g));}))),function(g){return i.process(i.each.apply(null,g),k.finishExact);});var j={};var c=function(g){return j[g]=(j[g]||d.format(g)[0]);};d.formats=function(m){if(m instanceof Array){var o=[];for(var g=0;g<m.length;g++){o.push(c(m[g]));}return i.any.apply(null,o);}else{return c(m);}};d._formats=d.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);d._start=i.process(i.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),k.finish);d.start=function(g){try{var m=d._formats.call({},g);if(m[1].length===0){return m;}}catch(o){}return d._start.call({},g);};e._parse=e.parse;e.parse=function(g){var m=null;if(!g){return null;}if(g instanceof Date){return g;}try{m=e.Grammar.start.call({},g.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"));}catch(o){return null;}return((m[1].length===0)?m[0]:null);};e.getParseFunction=function(m){var g=e.Grammar.formats(m);return function(o){var p=null;try{p=g.call({},o);}catch(q){return null;}return((p[1].length===0)?p[0]:null);};};e.parseExact=function(g,m){return e.getParseFunction(m)(g);};}());(function(){var c=Date,b=c.prototype,d=c.CultureInfo,a=[],e=function(g,f){if(!f){f=2;}return("000"+g).slice(f*-1);};c.normalizeFormat=function(g){a=[];var f=new Date().$format(g);return a.join("");};c.strftime=function(g,f){return new Date(f*1000).$format(g);};c.strtotime=function(f){var g=c.parse(f);g.addMinutes(g.getTimezoneOffset()*-1);return Math.round(c.UTC(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds())/1000);};b.$format=function(h){var f=this,i,g=function(j){a.push(j);return f.toString(j);};return h?h.replace(/(%|\\)?.|%%/g,function(j){if(j.charAt(0)==="\\"||j.substring(0,2)==="%%"){return j.replace("\\","").replace("%%","%");}switch(j){case"d":case"%d":return g("dd");case"D":case"%a":return g("ddd");case"j":case"%e":return g("d");case"l":case"%A":return g("dddd");case"N":case"%u":return f.getDay()+1;case"S":return g("S");case"w":case"%w":return f.getDay();case"z":return f.getOrdinalNumber();case"%j":return e(f.getOrdinalNumber(),3);case"%U":var o=f.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),l=f.clone().addDays(1).moveToDayOfWeek(0,-1);return(l<o)?"00":e((l.getOrdinalNumber()-o.getOrdinalNumber())/7+1);case"W":case"%V":return f.getISOWeek();case"%W":return e(f.getWeek());case"F":case"%B":return g("MMMM");case"m":case"%m":return g("MM");case"M":case"%b":case"%h":return g("MMM");case"n":return g("M");case"t":return c.getDaysInMonth(f.getFullYear(),f.getMonth());case"L":return(c.isLeapYear(f.getFullYear()))?1:0;case"o":case"%G":return f.setWeek(f.getISOWeek()).toString("yyyy");case"%g":return f.$format("%G").slice(-2);case"Y":case"%Y":return g("yyyy");case"y":case"%y":return g("yy");case"a":case"%p":return g("tt").toLowerCase();case"A":return g("tt").toUpperCase();case"g":case"%I":return g("h");case"G":return g("H");case"h":return g("hh");case"H":case"%H":return g("HH");case"i":case"%M":return g("mm");case"s":case"%S":return g("ss");case"u":return e(f.getMilliseconds(),3);case"I":return(f.isDaylightSavingTime())?1:0;case"O":return f.getUTCOffset();case"P":i=f.getUTCOffset();return i.substring(0,i.length-2)+":"+i.substring(i.length-2);case"e":case"T":case"%z":case"%Z":return f.getTimezone();case"Z":return f.getTimezoneOffset()*-60;case"B":var k=new Date();return Math.floor(((k.getHours()*3600)+(k.getMinutes()*60)+k.getSeconds()+(k.getTimezoneOffset()+60)*60)/86.4);case"c":return f.toISOString().replace(/\"/g,"");case"U":return c.strtotime("now");case"%c":return g("d")+" "+g("t");case"%C":return Math.floor(f.getFullYear()/100+1);case"%D":return g("MM/dd/yy");case"%n":return"\\n";case"%t":return"\\t";case"%r":return g("hh:mm tt");case"%R":return g("H:mm");case"%T":return g("H:mm:ss");case"%x":return g("d");case"%X":return g("t");default:a.push(j);return j;}}):this._toString();};if(!b.format){b.format=b.$format;}}());var QRCode=function(){var o=function(E,u){var M=236;var L=17;var y=E;var A=i[u];var w=null;var H=0;var s=null;var C=new Array();var I={};var F=function(O,N){H=y*4+17;w=function(S){var Q=new Array(S);for(var R=0;R<S;R+=1){Q[R]=new Array(S);for(var P=0;P<S;P+=1){Q[R][P]=null;}}return Q;}(H);B(0,0);B(H-7,0);B(0,H-7);D();t();K(O,N);if(y>=7){z(O);}if(s==null){s=v(y,A,C);}G(s,N);};var B=function(P,N){for(var O=-1;O<=7;O+=1){if(P+O<=-1||H<=P+O){continue;}for(var Q=-1;Q<=7;Q+=1){if(N+Q<=-1||H<=N+Q){continue;}if((0<=O&&O<=6&&(Q==0||Q==6))||(0<=Q&&Q<=6&&(O==0||O==6))||(2<=O&&O<=4&&2<=Q&&Q<=4)){w[P+O][N+Q]=true;}else{w[P+O][N+Q]=false;}}}};var x=function(){var Q=0;var P=0;for(var O=0;O<8;O+=1){F(true,O);var N=h.getLostPoint(I);if(O==0||Q>N){Q=N;P=O;}}return P;};var t=function(){for(var N=8;N<H-8;N+=1){if(w[N][6]!=null){continue;}w[N][6]=(N%2==0);}for(var O=8;O<H-8;O+=1){if(w[6][O]!=null){continue;}w[6][O]=(O%2==0);}};var D=function(){var T=h.getPatternPosition(y);for(var P=0;P<T.length;P+=1){for(var O=0;O<T.length;O+=1){var R=T[P];var N=T[O];if(w[R][N]!=null){continue;}for(var Q=-2;Q<=2;Q+=1){for(var S=-2;S<=2;S+=1){if(Q==-2||Q==2||S==-2||S==2||(Q==0&&S==0)){w[R+Q][N+S]=true;}else{w[R+Q][N+S]=false;}}}}}};var z=function(Q){var P=h.getBCHTypeNumber(y);for(var O=0;O<18;O+=1){var N=(!Q&&((P>>O)&1)==1);w[Math.floor(O/3)][O%3+H-8-3]=N;}for(var O=0;O<18;O+=1){var N=(!Q&&((P>>O)&1)==1);w[O%3+H-8-3][Math.floor(O/3)]=N;}};var K=function(S,R){var Q=(A<<3)|R;var P=h.getBCHTypeInfo(Q);for(var O=0;O<15;O+=1){var N=(!S&&((P>>O)&1)==1);if(O<6){w[O][8]=N;}else{if(O<8){w[O+1][8]=N;}else{w[H-15+O][8]=N;}}}for(var O=0;O<15;O+=1){var N=(!S&&((P>>O)&1)==1);if(O<8){w[8][H-O-1]=N;}else{if(O<9){w[8][15-O-1+1]=N;}else{w[8][15-O-1]=N;}}}w[H-8][8]=(!S);};var G=function(S,O){var Q=-1;var X=H-1;var R=7;var N=0;var V=h.getMaskFunction(O);for(var P=H-1;P>0;P-=2){if(P==6){P-=1;}while(true){for(var U=0;U<2;U+=1){if(w[X][P-U]==null){var T=false;if(N<S.length){T=(((S[N]>>>R)&1)==1);}var W=V(X,P-U);if(W){T=!T;}w[X][P-U]=T;R-=1;if(R==-1){N+=1;R=7;}}}X+=Q;if(X<0||H<=X){X-=Q;Q=-Q;break;}}}};var J=function(X,aa){var P=0;var ad=0;var ab=0;var O=new Array(aa.length);var S=new Array(aa.length);for(var V=0;V<aa.length;V+=1){var W=aa[V].dataCount;var N=aa[V].totalCount-W;ad=Math.max(ad,W);ab=Math.max(ab,N);O[V]=new Array(W);for(var Y=0;Y<O[V].length;Y+=1){O[V][Y]=255&X.getBuffer()[Y+P];}P+=W;var T=h.getErrorCorrectPolynomial(N);var ac=e(O[V],T.getLength()-1);var Q=ac.mod(T);S[V]=new Array(T.getLength()-1);for(var Y=0;Y<S[V].length;Y+=1){var U=Y+Q.getLength()-S[V].length;S[V][Y]=(U>=0)?Q.get(U):0;}}var Z=0;for(var Y=0;Y<aa.length;Y+=1){Z+=aa[Y].totalCount;}var ae=new Array(Z);var R=0;for(var Y=0;Y<ad;Y+=1){for(var V=0;V<aa.length;V+=1){if(Y<O[V].length){ae[R]=O[V][Y];R+=1;}}}for(var Y=0;Y<ab;Y+=1){for(var V=0;V<aa.length;V+=1){if(Y<S[V].length){ae[R]=S[V][Y];R+=1;}}}return ae;};var v=function(U,T,Q){var O=g.getRSBlocks(U,T);var N=f();for(var P=0;P<Q.length;P+=1){var S=Q[P];N.put(S.getMode(),4);N.put(S.getLength(),h.getLengthInBits(S.getMode(),U));S.write(N);}var R=0;for(var P=0;P<O.length;P+=1){R+=O[P].dataCount;}if(N.getLengthInBits()>R*8){throw new Error("code length overflow. ("+N.getLengthInBits()+">"+R*8+")");}if(N.getLengthInBits()+4<=R*8){N.put(0,4);}while(N.getLengthInBits()%8!=0){N.putBit(false);}while(true){if(N.getLengthInBits()>=R*8){break;}N.put(M,8);if(N.getLengthInBits()>=R*8){break;}N.put(L,8);}return J(N,O);};I.addData=function(O){var N=m(O);C.push(N);s=null;};I.isDark=function(O,N){if(O<0||H<=O||N<0||H<=N){throw new Error(O+","+N);}return w[O][N];};I.getModuleCount=function(){return H;};I.make=function(){F(false,x());};I.createTableTag=function(R,P){R=R||2;P=(typeof P=="undefined")?R*4:P;var N="";N+='<table style="';N+=" border-width: 0px; border-style: none;";N+=" border-collapse: collapse;";N+=" padding: 0px; margin: "+P+"px;";N+='">';N+="<tbody>";for(var O=0;O<I.getModuleCount();O+=1){N+="<tr>";for(var Q=0;Q<I.getModuleCount();Q+=1){N+='<td style="';N+=" border-width: 0px; border-style: none;";N+=" border-collapse: collapse;";N+=" padding: 0px; margin: 0px;";N+=" width: "+R+"px;";N+=" height: "+R+"px;";N+=" background-color: ";N+=I.isDark(O,Q)?"#000000":"#ffffff";N+=";";N+='"/>';}N+="</tr>";}N+="</tbody>";N+="</table>";return N;};I.createImgTag=function(R,Q){R=R||2;Q=(typeof Q=="undefined")?R*4:Q;var P=I.getModuleCount()*R+Q*2;var O=Q;var N=P-Q;return d(P,P,function(S,V){if(O<=S&&S<N&&O<=V&&V<N){var U=Math.floor((S-O)/R);var T=Math.floor((V-O)/R);return I.isDark(T,U)?0:1;}else{return 1;}});};I.createBase64=function(R,Q){R=R||2;Q=(typeof Q=="undefined")?R*4:Q;var P=I.getModuleCount()*R+Q*2;var O=Q;var N=P-Q;return[p(P,P,function(S,V){if(O<=S&&S<N&&O<=V&&V<N){var U=Math.floor((S-O)/R);var T=Math.floor((V-O)/R);return I.isDark(T,U)?0:1;}else{return 1;}}),P];};return I;};o.stringToBytes=function(v){var t=new Array();for(var u=0;u<v.length;u+=1){var w=v.charCodeAt(u);t.push(w&255);}return t;};o.createStringToBytes=function(v,u){var t=function(){var F=a(v);var w=function(){var G=F.read();if(G==-1){throw new Error();}return G;};var y=0;var z={};while(true){var D=F.read();if(D==-1){break;}var C=w();var B=w();var A=w();var x=String.fromCharCode((D<<8)|C);var E=(B<<8)|A;z[x]=E;y+=1;}if(y!=u){throw new Error(y+" != "+u);}return z;}();var s="?".charCodeAt(0);return function(z){var x=new Array();for(var y=0;y<z.length;y+=1){var A=z.charCodeAt(y);if(A<128){x.push(A);}else{var w=t[z.charAt(y)];if(typeof w=="number"){if((w&255)==w){x.push(w);}else{x.push(w>>>8);x.push(w&255);}}else{x.push(s);}}}return x;};};var j={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var i={L:1,M:0,Q:3,H:2};var c={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var h=function(){var v=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];var s=(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0);var x=(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0);var u=(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1);var w={};var t=function(y){var z=0;while(y!=0){z+=1;y>>>=1;}return z;};w.getBCHTypeInfo=function(y){var z=y<<10;while(t(z)-t(s)>=0){z^=(s<<(t(z)-t(s)));}return((y<<10)|z)^u;};w.getBCHTypeNumber=function(y){var z=y<<12;while(t(z)-t(x)>=0){z^=(x<<(t(z)-t(x)));}return(y<<12)|z;};w.getPatternPosition=function(y){return v[y-1];};w.getMaskFunction=function(y){switch(y){case c.PATTERN000:return function(A,z){return(A+z)%2==0;};case c.PATTERN001:return function(A,z){return A%2==0;};case c.PATTERN010:return function(A,z){return z%3==0;};case c.PATTERN011:return function(A,z){return(A+z)%3==0;};case c.PATTERN100:return function(A,z){return(Math.floor(A/2)+Math.floor(z/3))%2==0;};case c.PATTERN101:return function(A,z){return(A*z)%2+(A*z)%3==0;};case c.PATTERN110:return function(A,z){return((A*z)%2+(A*z)%3)%2==0;};case c.PATTERN111:return function(A,z){return((A*z)%3+(A+z)%2)%2==0;};default:throw new Error("bad maskPattern:"+y);}};w.getErrorCorrectPolynomial=function(z){var y=e([1],0);for(var A=0;A<z;A+=1){y=y.multiply(e([1,q.gexp(A)],0));}return y;};w.getLengthInBits=function(z,y){if(1<=y&&y<10){switch(z){case j.MODE_NUMBER:return 10;case j.MODE_ALPHA_NUM:return 9;case j.MODE_8BIT_BYTE:return 8;case j.MODE_KANJI:return 8;default:throw new Error("mode:"+z);}}else{if(y<27){switch(z){case j.MODE_NUMBER:return 12;case j.MODE_ALPHA_NUM:return 11;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 10;default:throw new Error("mode:"+z);}}else{if(y<41){switch(z){case j.MODE_NUMBER:return 14;case j.MODE_ALPHA_NUM:return 13;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 12;default:throw new Error("mode:"+z);}}else{throw new Error("type:"+y);}}}};w.getLostPoint=function(H){var A=H.getModuleCount();var B=0;for(var J=0;J<A;J+=1){for(var z=0;z<A;z+=1){var G=0;var F=H.isDark(J,z);for(var y=-1;y<=1;y+=1){if(J+y<0||A<=J+y){continue;}for(var E=-1;E<=1;E+=1){if(z+E<0||A<=z+E){continue;}if(y==0&&E==0){continue;}if(F==H.isDark(J+y,z+E)){G+=1;}}}if(G>5){B+=(3+G-5);}}}for(var J=0;J<A-1;J+=1){for(var z=0;z<A-1;z+=1){var C=0;if(H.isDark(J,z)){C+=1;}if(H.isDark(J+1,z)){C+=1;}if(H.isDark(J,z+1)){C+=1;}if(H.isDark(J+1,z+1)){C+=1;}if(C==0||C==4){B+=3;}}}for(var J=0;J<A;J+=1){for(var z=0;z<A-6;z+=1){if(H.isDark(J,z)&&!H.isDark(J,z+1)&&H.isDark(J,z+2)&&H.isDark(J,z+3)&&H.isDark(J,z+4)&&!H.isDark(J,z+5)&&H.isDark(J,z+6)){B+=40;}}}for(var z=0;z<A;z+=1){for(var J=0;J<A-6;J+=1){if(H.isDark(J,z)&&!H.isDark(J+1,z)&&H.isDark(J+2,z)&&H.isDark(J+3,z)&&H.isDark(J+4,z)&&!H.isDark(J+5,z)&&H.isDark(J+6,z)){B+=40;}}}var I=0;for(var z=0;z<A;z+=1){for(var J=0;J<A;J+=1){if(H.isDark(J,z)){I+=1;}}}var D=Math.abs(100*I/A/A-50)/5;B+=D*10;return B;};return w;}();var q=function(){var s=new Array(256);var u=new Array(256);for(var t=0;t<8;t+=1){s[t]=1<<t;}for(var t=8;t<256;t+=1){s[t]=s[t-4]^s[t-5]^s[t-6]^s[t-8];}for(var t=0;t<255;t+=1){u[s[t]]=t;}var v={};v.glog=function(w){if(w<1){throw new Error("glog("+w+")");}return u[w];};v.gexp=function(w){while(w<0){w+=255;}while(w>=256){w-=255;}return s[w];};return v;}();function e(t,s){if(typeof t.length=="undefined"){throw new Error(t.length+"/"+s);}var u=function(){var y=0;while(y<t.length&&t[y]==0){y+=1;}var x=new Array(t.length-y+s);for(var w=0;w<t.length-y;w+=1){x[w]=t[w+y];}return x;}();var v={};v.get=function(w){return u[w];};v.getLength=function(){return u.length;};v.multiply=function(z){var x=new Array(v.getLength()+z.getLength()-1);for(var y=0;y<v.getLength();y+=1){for(var w=0;w<z.getLength();w+=1){x[y+w]^=q.gexp(q.glog(v.get(y))+q.glog(z.get(w)));}}return e(x,0);};v.mod=function(z){if(v.getLength()-z.getLength()<0){return v;}var y=q.glog(v.get(0))-q.glog(z.get(0));var w=new Array(v.getLength());for(var x=0;x<v.getLength();x+=1){w[x]=v.get(x);}for(var x=0;x<z.getLength();x+=1){w[x]^=q.gexp(q.glog(z.get(x))+y);}return e(w,0).mod(z);};return v;}var g=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16]];var s=function(w,x){var y={};y.totalCount=w;y.dataCount=x;return y;};var v={};var u=function(x,w){switch(w){case i.L:return t[(x-1)*4+0];case i.M:return t[(x-1)*4+1];case i.Q:return t[(x-1)*4+2];case i.H:return t[(x-1)*4+3];default:return undefined;}};v.getRSBlocks=function(y,E){var x=u(y,E);if(typeof x=="undefined"){throw new Error("bad rs block @ typeNumber:"+y+"/errorCorrectLevel:"+E);}var w=x.length/3;var C=new Array();for(var A=0;A<w;A+=1){var B=x[A*3+0];var F=x[A*3+1];var D=x[A*3+2];for(var z=0;z<B;z+=1){C.push(s(F,D));}}return C;};return v;}();var f=function(){var s=new Array();var u=0;var t={};t.getBuffer=function(){return s;};t.get=function(v){var w=Math.floor(v/8);return((s[w]>>>(7-v%8))&1)==1;};t.put=function(v,x){for(var w=0;w<x;w+=1){t.putBit(((v>>>(x-w-1))&1)==1);}};t.getLengthInBits=function(){return u;};t.putBit=function(w){var v=Math.floor(u/8);if(s.length<=v){s.push(0);}if(w){s[v]|=(128>>>(u%8));}u+=1;};return t;};var m=function(v){var u=j.MODE_8BIT_BYTE;var s=v;var t=o.stringToBytes(v);var w={};w.getMode=function(){return u;};w.getLength=function(x){return t.length;};w.write=function(x){for(var y=0;y<t.length;y+=1){x.put(t[y],8);}};return w;};var k=function(){var s=new Array();var t={};t.writeByte=function(u){s.push(u&255);};t.writeShort=function(u){t.writeByte(u);t.writeByte(u>>>8);};t.writeBytes=function(v,x,u){x=x||0;u=u||v.length;for(var w=0;w<u;w+=1){t.writeByte(v[w+x]);}};t.writeString=function(v){for(var u=0;u<v.length;u+=1){t.writeByte(v.charCodeAt(u));}};t.toByteArray=function(){return s;};t.toString=function(){var v="";v+="[";for(var u=0;u<s.length;u+=1){if(u>0){v+=",";}v+=s[u];}v+="]";return v;};return t;};var b=function(){var t=0;var w=0;var y=0;var s="";var x={};var v=function(z){s+=String.fromCharCode(u(z&63));};var u=function(z){if(z<0){}else{if(z<26){return 65+z;}else{if(z<52){return 97+(z-26);}else{if(z<62){return 48+(z-52);}else{if(z==62){return 43;}else{if(z==63){return 47;}}}}}}throw new Error("n:"+z);};x.writeByte=function(z){t=(t<<8)|(z&255);w+=8;y+=1;while(w>=6){v(t>>>(w-6));w-=6;}};x.flush=function(){if(w>0){v(t<<(6-w));t=0;w=0;}if(y%3!=0){var A=3-y%3;for(var z=0;z<A;z+=1){s+="=";}}};x.toString=function(){return s;};return x;};var a=function(w){var y=w;var s=0;var t=0;var u=0;var x={};x.read=function(){while(u<8){if(s>=y.length){if(u==0){return -1;}throw new Error("unexpected end of file./"+u);}var A=y.charAt(s);s+=1;if(A=="="){u=0;return -1;}else{if(A.match(/^\s$/)){continue;}}t=(t<<6)|v(A.charCodeAt(0));u+=6;}var z=(t>>>(u-8))&255;u-=8;return z;};var v=function(z){if(65<=z&&z<=90){return z-65;}else{if(97<=z&&z<=122){return z-97+26;}else{if(48<=z&&z<=57){return z-48+52;}else{if(z==43){return 62;}else{if(z==47){return 63;}else{throw new Error("c:"+z);}}}}}};return x;};var l=function(s,z){var v=s;var w=z;var t=new Array(s*z);var x={};x.setPixel=function(B,D,C){t[D*v+B]=C;};x.write=function(C){C.writeString("GIF87a");C.writeShort(v);C.writeShort(w);C.writeByte(128);C.writeByte(0);C.writeByte(0);C.writeByte(0);C.writeByte(0);C.writeByte(0);C.writeByte(255);C.writeByte(255);C.writeByte(255);C.writeString(",");C.writeShort(0);C.writeShort(0);C.writeShort(v);C.writeShort(w);C.writeByte(0);var D=2;var B=u(D);C.writeByte(D);var E=0;while(B.length-E>255){C.writeByte(255);C.writeBytes(B,E,255);E+=255;}C.writeByte(B.length-E);C.writeBytes(B,E,B.length-E);C.writeByte(0);C.writeString(";");};var y=function(C){var D=C;var E=0;var B=0;var F={};F.write=function(H,G){if((H>>>G)!=0){throw new Error("length over");}while(E+G>=8){D.writeByte(255&((H<<E)|B));G-=(8-E);H>>>=(8-E);B=0;E=0;}B=(H<<E)|B;E=E+G;};F.flush=function(){if(E>0){D.writeByte(B);}};return F;};var u=function(C){var G=1<<C;var E=(1<<C)+1;var I=C+1;var K=A();for(var F=0;F<G;F+=1){K.add(String.fromCharCode(F));}K.add(String.fromCharCode(G));K.add(String.fromCharCode(E));var D=k();var B=y(D);B.write(G,I);var J=0;var L=String.fromCharCode(t[J]);J+=1;while(J<t.length){var H=String.fromCharCode(t[J]);J+=1;if(K.contains(L+H)){L=L+H;}else{B.write(K.indexOf(L),I);if(K.size()<4095){if(K.size()==(1<<I)){I+=1;}K.add(L+H);}L=H;}}B.write(K.indexOf(L),I);B.write(E,I);B.flush();return D.toByteArray();};var A=function(){var C={};var B=0;var D={};D.add=function(E){if(D.contains(E)){throw new Error("dup key:"+E);}C[E]=B;B+=1;};D.size=function(){return B;};D.indexOf=function(E){return C[E];};D.contains=function(E){return typeof C[E]!="undefined";};return D;};return x;};var p=function(s,D,z){var v=l(s,D);for(var A=0;A<D;A+=1){for(var C=0;C<s;C+=1){v.setPixel(C,A,z(C,A));}}var B=k();v.write(B);var w=b();var E=B.toByteArray();for(var u=0;u<E.length;u+=1){w.writeByte(E[u]);}w.flush();var t="";t+="data:image/gif;base64,";t+=w;return t;};var d=function(v,s,x,w){var t=p(v,s,x);var u="";u+="<img";u+='\u0020src="';u+=t;u+='"';u+='\u0020width="';u+=v;u+='"';u+='\u0020height="';u+=s;u+='"';if(w){u+='\u0020alt="';u+=w;u+='"';}u+="/>";return u;};return o;}();var FastBase64={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var a=0;a<4096;a++){this.encLookup[a]=this.chars[a>>6]+this.chars[a&63];}},Encode:function(f){var a=f.length;var g="";var d=0;while(a>2){n=(f[d]<<16)|(f[d+1]<<8)|f[d+2];g+=this.encLookup[n>>12]+this.encLookup[n&4095];a-=3;d+=3;}if(a>0){var e=(f[d]&252)>>2;var c=(f[d]&3)<<4;if(a>1){c|=(f[++d]&240)>>4;}g+=this.chars[e];g+=this.chars[c];if(a==2){var b=(f[d++]&15)<<2;b|=(f[d]&192)>>6;g+=this.chars[b];}if(a==1){g+="=";}g+="=";}return g;}};FastBase64.Init();var RIFFWAVE=function(d){d=d||{};this.data=[];this.wav=[];this.dataURI="";this.header=Ext.apply({chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8000,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},d.header);function b(e){return[e&255,(e>>8)&255,(e>>16)&255,(e>>24)&255];}function a(e){return[e&255,(e>>8)&255];}function c(k){var h=[];var f=0;var e=k.length;for(var g=0;g<e;g++){h[f++]=k[g]&255;h[f++]=(k[g]>>8)&255;}return h;}this.Make=function(){this.header.blockAlign=(this.header.numChannels*this.header.bitsPerSample)>>3;this.header.byteRate=this.header.blockAlign*this.header.sampleRate;this.header.subChunk2Size=this.data.length*(this.header.bitsPerSample>>3);this.header.chunkSize=36+this.header.subChunk2Size;console.debug("RIFFWAVE - "+Ext.encode(this.header));};this.MakeData=function(e){if(e instanceof Array){this.data=e;}this.wav=this.header.chunkId.concat(b(this.header.chunkSize),this.header.format,this.header.subChunk1Id,b(this.header.subChunk1Size),a(this.header.audioFormat),a(this.header.numChannels),b(this.header.sampleRate),b(this.header.byteRate),a(this.header.blockAlign),a(this.header.bitsPerSample),this.header.subChunk2Id,b(this.header.subChunk2Size),(this.header.bitsPerSample==16)?c(this.data):this.data);this.dataURI="data:audio/wav;base64,"+FastBase64.Encode(this.wav);};if(d.data instanceof Array){this.Make(d.data);if(!d.headerOnly){this.MakeData(d.data);}}};if(this.console&&this.console.log){if(typeof(MessageChannel)!="undefined"){this._Worker=Worker;Object.defineProperty(this,"Worker",{writable:true});this.Worker=function Worker(b){var a=new _Worker("../lib/core/WebWorkerConsole.js#"+b);var c=new MessageChannel();a.postMessage("console",[c.port2]);c.port1.onmessage=function(f){var d=f.data;d.unshift(b+": ");console.log.apply(console,d);};return a;};}}else{self.onmessage=function(c){if(c.data==="console"){self.console={_port:c.ports[0],log:function b(){var d=Array.prototype.slice.call(arguments);console._port.postMessage(d);},debug:function b(){var d=Array.prototype.slice.call(arguments);console._port.postMessage(d);}};onmessage=null;var a=location.hash.substring(1);importScripts("../../mobile/"+a);}};}window.plugins=window.plugins||{};if(window.cordova||window.Cordova||window.PhoneGap){(function(a){window.plugins.proximityID={init:function(c,b){a.exec(function(){console.log("ProximityIDPlugin Initialized");},function(d){console.log("Failed to initialize the ProximityIDPlugin! Reason["+d+"]");},"ProximityIDPlugin","init",[c+"",b+""]);},preLoadSend:function(c,b){Ext.defer(function(){a.exec(c,b,"ProximityIDPlugin","preLoadIdentity",[]);},0.25*1000,this);},send:function(c,b){a.exec(c,b,"ProximityIDPlugin","sendIdentity",[]);},scan:function(f,c,e,d,g,b){a.exec(f,c,"ProximityIDPlugin","scanIdentity",[e,d,g,b]);},stop:function(){a.exec(function(){console.log("Stopped ProximityIDPlugin");},function(b){console.log("Failed to stop the ProximityIDPlugin "+b);},"ProximityIDPlugin","stop",[]);},setVolume:function(b){a.exec(Ext.emptyFn,Ext.emptyFn,"ProximityIDPlugin","setVolume",[b]);}};a.addConstructor(function(){});})(window.cordova||window.Cordova||window.PhoneGap);}else{window.plugins.proximityID={loFreq:17000,hiFreq:20000,FREQ_GAP:500,NUM_SIGNALS:3,SHORT_MAX:parseInt(65535/2),sampleRate:44100,duration:1*44100,bw:0,audio:null,freqs:null,init:function(b,a){var c=this;c.bw=(c.hiFreq-c.loFreq)/c.NUM_SIGNALS;Genesis.constants.s_vol=b*100;Genesis.constants.r_vol=a*100;console.debug("Initialized Proximity API");},preLoadSend:function(l,d){var p=this,h,e,c,b={header:{sampleRate:p.sampleRate,numChannels:1,bitsPerSample:16},data:[]};var m=Genesis.constants.s_vol/100;var o=function(){do{c=false;for(h=0;h<p.NUM_SIGNALS-1;h++){p.freqs[h]=parseInt(Math.random()*p.bw)+parseInt(h*p.bw)+parseInt(p.loFreq);}h=p.NUM_SIGNALS-1;p.freqs[h]=parseInt(Math.random()/2*p.bw)+parseInt(h*p.bw)+parseInt(p.loFreq);for(h=0;h<(p.NUM_SIGNALS-1);h++){if((p.freqs[h]+p.FREQ_GAP)>p.freqs[h+1]){c=true;break;}}}while(c);};var g=function(j){return(j&65535);};var s=function(j){return((j>>16)&65535);};p.freqs=[];if((typeof(webkitAudioContext)!="undefined")&&!debugMode){if(!p.context){p.context=new webkitAudioContext();p.gainNode=p.context.createGainNode();p.gainNode.connect(p.context.destination);}o();p.gainNode.gain.value=m;p.oscillators=[];for(h=0;h<p.freqs.length;h++){var q=p.oscillators[h]=p.context.createOscillator();q.type=0;q.frequency.value=p.freqs[h];q.connect(p.gainNode);}console.debug("Gain : "+m);l();}else{var t,a,f,k=(new Audio()).canPlayType("audio/wav; codecs=1")&&!debugMode;if(k){a=0;f=b.data;}else{a=44/2;b.headerOnly=true;f=b.data=new Int16Array(a+p.duration);t=(new RIFFWAVE(b)).header;}Ext.defer(function(){o();for(h=a;h<(p.duration+a);h++){var j=0;for(e=0;e<p.freqs.length;e++){j+=Math.sin(2*Math.PI*p.freqs[e]*h/p.sampleRate);}j/=p.freqs.length;f[h]=Math.round(m*((p.SHORT_MAX+1)+(j*p.SHORT_MAX)));}if(k){p.audio=new Audio(new RIFFWAVE(b).dataURI);}else{f[0]=s(t.chunkId);f[1]=g(t.chunkId);f[2]=s(t.chunkSize);f[3]=g(t.chunkSize);f[4]=s(t.format);f[5]=g(t.format);f[6]=s(t.subChunk1Id);f[7]=g(t.subChunk1Id);f[8]=s(t.subChunk1Size);f[9]=g(t.subChunk1Size);f[10]=t.audioFormat;f[11]=t.numChannels;f[12]=s(t.sampleRate);f[13]=g(t.sampleRate);f[14]=s(t.byteRate);f[15]=g(t.byteRate);f[16]=t.blockAlign;f[17]=t.bitsPerSample;f[18]=s(t.subChunk2Id);f[19]=g(t.subChunk2Id);f[20]=s(t.subChunk2Size);f[21]=g(t.subChunk2Size);var i=new Speex({benchmark:false,quality:2,complexity:2,bits_size:15});f="data:audio/ogg;base64,"+base64.encode(i.encode(f,true));i.close();console.debug("OGG Encode Data :"+f);p.audio=new Audio(f);}if(typeof p.audio.loop=="boolean"){p.audio.loop=true;}else{p.audio.addEventListener("ended",function(){this.currentTime=0;this.play();},false);}console.debug("Gain : "+m);l();},0.25*1000,this);}},send:function(d,a){var c=this;if(c.audio){c.audio.play();d({freqs:c.freqs});}else{if(c.oscillators){for(var b=0;b<c.freqs.length;b++){c.oscillators[b].noteOn&&c.oscillators[b].noteOn(0);}d({freqs:c.freqs});}else{a();}}},stop:function(){var b=this;if(b.audio){b.audio.pause();b.audio.currentTime=0;delete b.audio;}else{if(b.oscillators){for(var a=0;a<b.freqs.length;a++){b.oscillators[a].disconnect();}delete b.oscillators;}}},setVolume:function(a){var b=this;if(b.audio){b.audio.volume=a/100;}else{if(b.context){b.gainNode.gain.value=Math.max(0,a/100);}}}};}__initFb__=function(){Ext.define("Genesis.fb",{mixins:["Ext.mixin.Observable"],singleton:true,appId:null,fbTimeout:2*60*1000,titleMsg:"Facebook Connect",fbScope:["email","user_birthday","publish_stream","read_friendlists","publish_actions"],fbConnectErrorMsg:"Cannot retrive Facebook account information!",fbConnectRequestMsg:"By connecting to Facebook, you will receive additional Reward Pts everytime we update your KICKBAK activity to your Facebook account!",fbConnectReconnectMsg:"By connecting to Facebook, you will receive additional Reward Pts everytime we update your KICKBAK activity to your Facebook account!",connectingToFBMsg:function(){return("Connecting to Facebook ..."+Genesis.constants.addCRLF()+"(Tap to Close)");},loggingOutOfFBMsg:"Logging out of Facebook ...",fbConnectFailMsg:"Error Connecting to Facebook.",fbPermissionFailMsg:"Failed to get the required access permission.",friendsRetrieveErrorMsg:"You cannot retrieve your Friends List from Facebook. Login and Try Again.",initialize:function(){var a=this;a.appId=(Genesis.constants.debugMode())?477780595628080:197968780267830;console.log("FacebookConnect::initialize");},currentLocation:function(){return(((Genesis.constants.debugMode())?Genesis.constants.serverHost():"http://m.getkickbak.com")+"/");},redirectUrl:function(){var a=Ext.Object.toQueryString({redirect_uri:this.currentLocation(),client_id:this.appId,state:appName,response_type:"token",scope:this.fbScope.toString()});if(!Ext.os.is("Android")&&!Ext.os.is("iOS")&&/Windows|Linux|MacOS/.test(Ext.os.name)){return"https://www.facebook.com/dialog/oauth?"+a;}else{return"https://m.facebook.com/dialog/oauth?"+a;}},createFbResponse:function(a){var b=a.birthday.split("/");b=b[2]+"-"+b[0]+"-"+b[1];var c={name:a.name,email:a.email,facebook_id:a.id,facebook_uid:a.username,gender:(a.gender=="male")?"m":"f",birthday:b,photoURL:this.getFbProfilePhoto(a.id),accessToken:Genesis.db.getLocalDB()["access_token"]};console.log("FbResponse - ["+Ext.encode(c)+"]");return c;},facebook_onLogin:function(g,e,f){var d=this,b=true,a=Genesis.db.getLocalDB();var c=(a.currFbId>0)&&(parseInt(a.fbExpiresIn)>0);console.log("connected = "+c+"\nfbExpiresIn = "+parseInt(a.fbExpiresIn)+"\ntime-30min = "+((new Date().addMinutes(-30)).getTime())+"\n");if(c){var b=(!c||(c&&(parseInt(a.fbExpiresIn)<=(new Date().addMinutes(-30)).getTime())));if(!f||(f&&!b)){console.log("Facebook already connected. Bypass relogin process");d.fireEvent("connected",a.fbResponse,null);return;}}d.cb={supress:g,messsage:e,iter:0};Ext.Viewport.setMasked(null);Ext.Viewport.setMasked({xtype:"loadmask",message:d.connectingToFBMsg(),listeners:{tap:function(){Ext.Viewport.setMasked(null);d.facebook_loginCallback(null);}}});Genesis.db.setLocalDBAttrib("fbLoginInProgress",true);d.inAppBrowserCallback();},inAppBrowserCallback:function(){var b=this,a=window.open(b.redirectUrl(),"_blank","location=no,toolbar=no,closebuttoncaption=Cancel");b.fbLoginTimeout=setTimeout(function(){b.fireEvent("loginStatus");b.fireEvent("exception",{type:"timeout",msg:"The request to Facebook timed out."},null);Genesis.db.removeLocalDBAttrib("fbLoginInProgress");a.close();b.facebook_loginCallback(null);},b.fbTimeout);a.addEventListener("loadstart",function(d){if(d.url.match(b.currentLocation())){if(d.url.indexOf("access_token=")>=1){var e=Ext.Object.fromQueryString(d.url.split("#")[1]);if(e.state==appName){var c=Genesis.db.getLocalDB();b.code=c.access_token=e.access_token;c.fbExpiresIn=(new Date(Date.now()+Number(e.expires_in))).getTime();Genesis.db.setLocalDB(c);}else{console.error("CSRF Forgery detected! Ignore Request");}}Ext.defer(function(){a.close();},500);}});a.addEventListener("loadstop",function(c){});a.addEventListener("exit",function(c){clearTimeout(b.fbLoginTimeout);delete b.fbLoginTimeout;Genesis.db.removeLocalDBAttrib("fbLoginInProgress");if(b.code){Ext.defer(function(){Ext.Ajax.request({async:true,disableCaching:false,url:"https://graph.facebook.com/me?access_token="+Genesis.db.getLocalDB()["access_token"],callback:function(g,i,d){if(i||(d.status==200)){try{var f=Ext.decode(d.responseText);f.status="connected";b.facebook_loginCallback(f);}catch(h){}}else{console.log("Error Logging into Facebook\nReturn "+Ext.encode(d));b.facebook_loginCallback(null);}}});delete b.code;},100);}else{b.facebook_loginCallback(null);}});},facebook_loginCallback:function(b){var c=this,d=null;if(!b||b.cancelled||b.error||(b.status!="connected")){console.log("FacebookConnect.login:failedWithError:"+((b)?b.message:"None"));if(!c.cb||!c.cb.supress){Ext.device.Notification.show({title:c.titleMsg,message:c.fbConnectErrorMsg,buttons:["Try Again","Continue"],callback:function(e){if(e.toLowerCase()=="try again"){Ext.defer(function(){c.facebook_onLogin(false,c.cb.message);},1,c);delete c.cb;}else{Ext.Viewport.setMasked(null);delete c.cb;c.fireEvent("unauthorized",null,null);}}});}else{if(b&&b.cancelled){Ext.Viewport.setMasked(null);delete c.cb;c.fireEvent("exception",{type:"timeout",msg:"The request to Facebook cancelled."},null);}}}else{console.log("Retrieving Facebook profile information ...");var a=b;Ext.defer(function(){if(!a.error||(a.id&&(a.id>0))){var e=Genesis.db.getLocalDB(),f=a.id;console.log("Session ID["+f+"]");e.currFbId=f;e.fbAccountId=a.email;d=e.fbResponse=c.createFbResponse(a);Genesis.db.setLocalDB(e);e=Genesis.db.getLocalDB();console.log("You`ve logged into Facebook! \nEmail("+d.email+")\nauth_code("+e.auth_code+")\nID("+f+")\n");delete c.cb;c._fb_connect();if(e.auth_code){console.log("Updating Facebook Login Info ...");Account.setUpdateFbLoginUrl();Account.load(0,{jsonData:{},params:{user:Ext.encode(e.fbResponse)},callback:function(g,h){if(h.wasSuccessful()){Ext.Viewport.setMasked(null);Genesis.db.setLocalDBAttrib("enableFB",true);}c.fireEvent("connected",d,h);}});}else{Genesis.db.setLocalDBAttrib("enableFB",true);c.fireEvent("connected",d,null);delete c.cb;}}else{Ext.Viewport.setMasked(null);c.fireEvent("unauthorized",null,null);c.facebook_onLogout(null,false);delete c.cb;}},0.5*1000,c);}delete c.fbLoginTimeout;},facebook_onLogout:function(a,c){var d=this;a=a||Ext.emptyFn;console.log("facebook_onLogout");try{var b=Genesis.db.getLocalDB();b.currFbId=0;delete b.fbAccountId;delete b.fbResponse;delete b.fbAuthCode;delete b.fbExpiresIn;Genesis.db.setLocalDB(b);a();}catch(f){a();}},getFbProfilePhoto:function(a){return"http://graph.facebook.com/"+a+"/picture?type=square";},createFBReminderMsg:function(){var a=this;if(!a.actions){a.actions=(Ext.create("Ext.Sheet",{bottom:0,left:0,top:0,right:0,padding:"1.0",hideOnMaskTap:false,defaultUnit:"em",layout:{type:"vbox",pack:"middle"},defaults:{xtype:"container",defaultUnit:"em"},items:[{width:"100%",flex:1,style:"text-align:center;display:inline-table;color:white;font-size:1.1em;",html:a.fbConnectRequestMsg+'<img width="160" style="margin:0.7em 0;" src="resources/themes/images/v1/facebook_icon.png"/>'},{docked:"bottom",defaults:{xtype:"button",defaultUnit:"em",scope:a},padding:"0 1.0 1.0 1.0",items:[{margin:"0 0 0.5 0",text:"Sign In",ui:"action",handler:function(){a.actions.hide();var b=_application.getController("client.MainPage");b.fireEvent("facebookTap",null,null,null,null,function(){Ext.device.Notification.show({title:a.titleMsg,message:a.fbPermissionFailMsg,buttons:["Dismiss"],callback:function(d){b._loggingIn=false;var c=_application.getController("client.Viewport");var e=c.getViewport();var f=e.getActiveItem();if(!f){Ext.Viewport.setMasked(null);c.resetView();c.redirectTo("login");}else{}}});});a.actions.destroy();delete a.actions;}},{margin:"0.5 0 0.5 0",text:"Skip",ui:"cancel",handler:function(){a.actions.hide();_application.getController("client.Viewport").redirectTo("checkin");a.actions.destroy();delete a.actions;}},{margin:"0.5 0 0 0",text:"Don't Remind Me Again",handler:function(){a.actions.hide();Genesis.db.setLocalDBAttrib("disableFBReminderMsg",true);_application.getController("client.Viewport").redirectTo("checkin");a.actions.destroy();delete a.actions;}}]}]}));Ext.Viewport.add(a.actions);a.actions.show();}else{}},postCommon:function(b,e,d,a){var c=this;e=Ext.apply(e,{access_token:Genesis.db.getLocalDB()["fbResponse"]["accessToken"]});Ext.Ajax.request({async:true,disableCaching:false,method:"POST",params:e,url:"https://graph.facebook.com"+b,callback:function(i,g,f){try{var h=Ext.decode(f.responseText);if(g||(f.status==200)){d(h);}else{if(f.status==400){c.facebook_onLogout();Ext.defer(c.facebook_onLogin,1,c,[false,null,true]);}else{console.log("Error Logging into Facebook\nStatus code "+Ext.encode(f.responseText));a(h);}}}catch(j){a(h);}}});},uploadPhoto:function(c,b,a){this.postCommon("/me/photos",c,b,a);},share:function(c,b,a){this.postCommon("/me/feed",c,b,a);},_fb_connect:function(){},_fb_disconnect:function(){this._fb_connect();}});Genesis.fb.initialize();};