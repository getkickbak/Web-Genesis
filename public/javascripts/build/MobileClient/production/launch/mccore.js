var _codec=null,gblController={unsupportedBrowser:"This browser is not supported.",incorrectMobileNumberFormatMsg:"Enter a valid Mobile Number<br/>(800-555-1234)",networkErrorMsg:"Error Connecting to Sever",cannotDetermineLocationMsg:"Cannot determine current location. Visit one of our venues to continue!",geoLocationTimeoutErrorMsg:"Cannot locate your current location. Try again or enable permission to do so!",geoLocationPermissionErrorMsg:function(){var a;if(!Gensis.fn.isNative()){if($.os.ios){a="Enable Location Servies and/or Reset Location Services (Settings > General > Reset > Reset Location Warnings).";}else{if($.os.android){a="Enable Location Servies and/or Reset Location Services (Settings > Location access > Access to my location).";}else{a="Enable Location Servies on your mobile device.";}}}else{a="This feature must require your GeoLocation to proceed.";if($.os.android){a+='Enable Location Services under Main Screen of your phone: "Settings App >> Location Services >> GPS satellites"';}else{if($.os.ios){a+=((parseFloat($.os.version)<6)?'Enable Location Services under Main Screen of your phone: "Settings App >> Location Services >> KICKBAK"':'Enable Location Services under Main Screen of your phone: "Settings App >> Privacy >> Location Services >> KICKBAK"');}else{if($.os.blackberry||$.os.bb10||$.os.rimtabletos){a+='Enable Location Services under Main Screen of your phone: "Settings App >> Site Permissions"';}else{a+='Enable Location Services under Main Screen of your phone: "Settings App >> Location Services"';}}}}return a;},geoLocationUnavailableMsg:"To better serve you, please turn on your Location Services",geoLocationUseLastPositionMsg:"We are not able to locate your current location. Using your last known GPS Coordinates ...",getMerchantInfoMsg:"Retrieving Merchant Information ...",getVenueInfoMsg:"Retrieving Venue Information ...",noVenueInfoMsg:function(a){return("No Venues found in your proximity!");},missingVenueInfoMsg:function(a){return("Error loading Venue information.");},prepareToSendMerchantDeviceMsg:"Confirm before tapping against the KICKBAK Card Reader ...",showToServerMsg:function(){return"Show your KICKBAK Card or use your Mobile Number";},lookingForMerchantDeviceMsg:function(){return"Tap your Phone against the KICKBAK Card Reader";},transactionCancelledMsg:"This transaction is cancelled",encryptFromParams:function(g,f){GibberishAES.size(256);var b=null,d=Genesis.fn.getPrivKey("venueId"),a=null;if((d>0)||(d<0)){try{switch(f){case"prize":a=Genesis.fn.getPrivKey("p"+d);case"reward":a=Genesis.fn.getPrivKey("r"+d);break;default:a=Genesis.fn.getPrivKey("r"+d);break;}b=(d>0)?d+"$":"";b+=GibberishAES.enc(Ext.encode(g),a);}catch(c){}}return b;},_merchant:{},_venue:{getId:function(){},get:function(a){},getMerchant:function(){return gblController._merchant;}},_cntlr:{lastPosition:null,getGeoLocation:function(){Genesis.fn.getLocation();},setLastPosition:function(a){gblController._cntlr.lastPosition=a;},getLastPosition:function(){return gblController._cntlr.lastPosition;},getVenue:function(){return gblController._venue;}},getViewPortCntlr:function(){return gblController._cntlr;},pendingBroadcast:false,broadcastLocalID:function(e,a){var d=this,f=Genesis.constants,b=function(){if(d.send_vol!=-1){window.plugins.proximityID.setVolume(-1);}window.plugins.proximityID.stop();};d.send_vol=-1;e=e||Ext.emptyFn;a=a||Ext.emptyFn;window.plugins.proximityID.send(function(c){console.debug("ProximityID : Broacasting Local Identity ...");e(Genesis.fn.processSendLocalID(c,b));},function(c){console.debug("Error Code["+Ext.encode(c)+"]");b();a();});},loadSoundFile:function(a,b,d){var e=this,c="."+(b.split(".")[1]||"mp3");b=b.split(".")[0];if(Genesis.fn.isNative()){var f=function(){switch(d){case"FX":LowLatencyAudio["preload"+d](b,"resources/audio/"+b+c,function(){console.debug("loaded "+b);},function(g){console.debug("Audio Error: "+g);});break;case"Audio":LowLatencyAudio["preload"+d](b,"resources/audio/"+b+c,3,function(){console.debug("loaded "+b);},function(g){console.debug("Audio Error: "+g);});break;}};switch(d){case"Media":b=new Media(($.os.android?"/android_asset/www/":"")+Genesis.constants.relPath()+"resources/audio/"+b+c,function(){e.sound_files[a].successCallback();},function(g){e.sound_files[a].successCallback();console.debug("Audio Error: "+g);});break;default:LowLatencyAudio.unload(b,f,f);break;}}e.sound_files[a]={name:b,type:d};},playSoundFile:function(b,a,c){if(Genesis.fn.isNative()){switch(b.type){case"FX":case"Audio":LowLatencyAudio.play(b.name,a||Ext.emptyFn,c||Ext.emptyFn);break;case"Media":b.successCallback=a||Ext.emptyFn;b.name.play();break;}}else{if(a){a();}}},stopSoundFile:function(a){if(Genesis.fn.isNative()){switch(a.type){case"FX":case"Audio":LowLatencyAudio.stop(a.name);break;case"Media":a.name.stop();break;}}else{}}};gblController.self=gblController;(function(){var g=this,a=Object.prototype,h=a.toString,b=true,e={toString:1},d=function(){},c;for(c in e){b=null;}if(b){b=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"];}Ext=(typeof(Ext)!="undefined")?Ext:{apply:function(o,n,q){if(q){Ext.apply(o,q);}if(o&&n&&typeof n==="object"){var p,m,l;for(p in n){o[p]=n[p];}if(b){for(m=b.length;m--;){l=b[m];if(n.hasOwnProperty(l)){o[l]=n[l];}}}}return o;},decode:JSON.parse,encode:JSON.stringify,isEmpty:function(i,j){return(i===null)||(i===undefined)||(!j?i==="":false)||(Ext.isArray(i)&&i.length===0);},isArray:("isArray" in Array)?Array.isArray:function(i){return h.call(i)==="[object Array]";},isObject:(h.call(null)==="[object Object]")?function(i){return i!==null&&i!==undefined&&h.call(i)==="[object Object]"&&i.ownerDocument===undefined;}:function(i){return h.call(i)==="[object Object]";},isFunction:(typeof document!=="undefined"&&typeof document.getElementsByTagName("body")==="function")?function(i){return h.call(i)==="[object Function]";}:function(i){return typeof i==="function";},isDefined:function(i){return typeof i!=="undefined";},defer:function(m,k,l,j,i){m=Ext.bind(m,l,j,i);if(k>0){return setTimeout(m,k);}m();return 0;},bind:function(l,k,j,i){if(arguments.length===2){return function(){return l.apply(k,arguments);};}var n=l,m=Array.prototype.slice;return function(){var o=j||arguments;if(i===true){o=m.call(arguments,0);o=o.concat(j);}return n.apply(k||window,o);};},clone:function(q){if(q===null||q===undefined){return q;}if(q.nodeType&&q.cloneNode){return q.cloneNode(true);}var p=h.call(q);if(p==="[object Date]"){return new Date(q.getTime());}var o,m,l,r,n;if(p==="[object Array]"){o=q.length;r=[];while(o--){r[o]=Ext.clone(q[o]);}}else{if(p==="[object Object]"&&q.constructor===Object){r={};for(n in q){r[n]=Ext.clone(q[n]);}if(b){for(m=b.length;m--;){l=b[m];r[l]=q[l];}}}}return r||q;},emptyFn:function(){}};var f=Ext.Object={merge:function(j){var o=1,p=arguments.length,k=f.merge,m=Ext.clone,n,r,q,l;for(;o<p;o++){n=arguments[o];for(r in n){q=n[r];if(q&&q.constructor===Object){l=j[r];if(l&&l.constructor===Object){k(l,q);}else{j[r]=m(q);}}else{j[r]=q;}}}return j;}};})();Genesis=(typeof(Genesis)!="undefined")?Genesis:{constants:{clientVersion:"2.2.0",serverVersion:"2.2.0",s_vol:50,lastLocalID:null,s_vol:-1,r_vol:-1,debugVPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugRPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugVenuePrivKey:"Debug Venue",relPath:function(){return"../";}},db:{_localDB:null,getLocalStorage:function(){return window.localStorage;},getLocalDB:function(a){var b=Genesis.db;if(a){delete b._localDB;}return(!b._localDB)?(b._localDB=JSON.parse(b.getLocalStorage().getItem("kickbak")||"{}")):b._localDB;},setLocalDB:function(a){var b=Genesis.db;b._localDB=a;b.getLocalStorage().setItem("kickbak",JSON.stringify(a));},setLocalDBAttrib:function(c,b){var a=Genesis.db;db=a.getLocalDB();db[c]=b;a.setLocalDB(db);},removeLocalDBAttrib:function(b){var a=Genesis.db;db=a.getLocalDB();if(typeof(db[b])!="undefined"){delete db[b];a.setLocalDB(db);}}},fn:{debugVPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugRPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugVenuePrivKey:"Debug Venue",privKey:null,filesadded:{},isNative:function(){return((typeof(phoneGapAvailable)!="undefined")?phoneGapAvailable:false);},checkloadjscssfile:function(b,d,a){var e=b;var c=this.filesadded[e];if(Ext.isEmpty(c)){c=this.filesadded[e]=[];if(Ext.isFunction(a)){c[0]=false;c[1]=[a];this.loadjscssfile(b,d,false);}else{c[0]=true;this.loadjscssfile(b,d,true);}}else{if(c[0]==true){if(Ext.isFunction(a)){a(true);}}else{if(Ext.isFunction(a)){if(c[1].indexOf(a)<0){c[1].push(a);}}else{console.debug("Do nothing for file["+b+"]");}}}},createjscssfile:function(a,b){var c;if(b=="js"){c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",a);}else{if(b=="css"){c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",a);}}return c;},loadjscsstext:function(b,c,e,a){var d;b=Url.decode(b);if(c=="js"){d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("id",b);d.innerHTML=e;}else{if(c=="css"){log("Loading cssfile ("+b+")");d=document.createElement("style");d.setAttribute("id",b);d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");if(typeof(d.textContent)!="undefined"){d.textContent=e;}else{d.styleSheet.cssText=e;}}}d.onerror=d.onload=d.onreadystatechange=function(){var f=this.readyState;if(f&&(f!="complete"&&f!="loaded")){return;}if(a){a();}};if((typeof d)!=undefined){document.getElementsByTagName("head")[0].appendChild(d);}return d;},loadjscssfileCallBackFunc:function(a,g,c){if(g<100){try{var d=(document.styleSheets[a].href)?document.styleSheets[a].href.replace(location.origin,""):"";console.debug("url = "+d);if(d!=c){for(var f=0;f<document.styleSheets.length;f++){d=(document.styleSheets[f].href)?document.styleSheets[f].href.replace(location.origin,""):"";console.debug("url = "+d);if(d==c){a=f;break;}}}if(document.styleSheets[a].cssRules){this.cssOnReadyStateChange(c,false);}else{if(document.styleSheets[a].rules&&document.styleSheets[a].rules.length){this.cssOnReadyStateChange(c,false);return;}g++;Ext.defer(this.loadjscssfileCallBackFunc,250,this,[a,g,c]);if((g/25>0)&&(g%25==0)){console.debug("IE Exception : Loading ["+c+"] index["+a+"] try("+g+")");}}}catch(h){g++;if((g/25>0)&&(g%25==0)){console.debug("FF Exception : Loading ["+c+"] index["+a+"] try("+g+")");}Ext.defer(this.loadjscssfileCallBackFunc,250,this,[a,g,c]);}}else{console.debug("Cannot load ["+c+"], index=["+a+"]");this.cssOnReadyStateChange(c,true);}},scriptOnError:function(a){this.scriptOnReadyStateChange.call(this,a,true);},scriptOnReadyStateChange:function(f,c){var g=this.src,e;g=g.replace(location.origin,"");if(location.host==""){if($.os.ios){e="ios_";}else{e="android_";}g=".."+g.replace(location.pathname.replace("/launch/index_"+e+"native.html",""),"");}if(!c){var b=this.readyState;if(b&&(b!="complete"&&b!="loaded")){return;}else{if(!b){}}}else{console.debug("Error Loading JS file["+g+"]");}var d=0,a=Genesis.fn.filesadded[g];if(a){a[0]=true;for(;d<a[1].length;d++){Ext.defer(function(h){a[1][h](!c);},1,null,[d]);}}else{console.debug("Cannot find callback on JS file["+g+"] index["+d+"]");}},cssOnReadyStateChange:function(b,c){var a=Genesis.fn.filesadded[b];if(a){a[0]=true;var d=0;for(;d<a[1].length;d++){Ext.defer(function(e){a[1][e](!c);},1,null,[d]);}}else{console.debug("Cannot find callback on CSSS file["+b+"] index["+d+"]");}},loadjscssfile:function(b,d,c){var e;if(d=="js"){e=document.createElement("script");e.setAttribute("type","text/javascript");if(!c){e.onerror=this.scriptOnError;e.onload=e.onreadystatechange=this.scriptOnReadyStateChange;}e.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(e);}else{if(d=="css"){var a=document.styleSheets.length;e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");e.setAttribute("media","screen");e.setAttribute("href",b);document.getElementsByTagName("head")[0].appendChild(e);if(!c){Ext.defer(this.loadjscssfileCallBackFunc,50,this,[a,0,b]);}}}},removejscssfile:function(b,d){var h=escape(b);var f=(d=="js")?"script":(d=="css")?"link":"none";var e=(d=="js")?"src":(d=="css")?"href":"none";var g=document.getElementsByTagName(f);for(var c=g.length;c>=0;c--){if(g[c]){var a=escape(g[c].getAttribute(e));if(a!=null&&((a==h)||(a.search(h)!=-1))){g[c].disabled=true;g[c].parentNode.removeChild(g[c]);delete Genesis.fn.filesadded[b];}}}},printProximityConfig:function(){var a=Genesis.constants;console.debug("ProximityID Configuration");console.debug("=========================");console.debug("\nSignal Samples["+a.numSamples+"]\nMissed Threshold["+a.conseqMissThreshold+"]\nSignal Overlap Ratio["+a.sigOverlapRatio+"]\nDefault Volume["+a.s_vol+"%]\n");},processSendLocalID:function(b,d){var c,a=null;if(b.freqs){Genesis.constants.lastLocalID=b.freqs;}c=Genesis.constants.lastLocalID;if(c){a="LocalID=["+c[0]+", "+c[1]+", "+c[2]+"]";}return({message:a,localID:c,cancelFn:d});},getLocation:function(){if(navigator.geolocation){var c=gblController.getViewPortCntlr(),b=c.getLastPosition();if(!b||(b.coords&&(b.coords.timestamp>(Date.now()-(5*60*1000))))){c.setLastPosition(null);navigator.geolocation.getCurrentPosition(function(d){console.debug("Latitude: "+d.coords.latitude+"\nLongitude: "+d.coords.longitude);c.setLastPosition(d);$(document).trigger("locationupdate",[d]);},function(d){switch(d.code){case 1:setNotificationVisibility(true,"Permission Denied",gblController.geoLocationPermissionErrorMsg,"Dismiss",function(){setLoadMask(false);});break;case 2:setNotificationVisibility(true,"Location Services",gblController.geoLocationUnavailableMsg,"Dismiss",function(){setLoadMask(false);});break;case 3:setNotificationVisibility(true,"Location Services",gblController.geoLocationTimeoutErrorMsg,"Dismiss",function(){setLoadMask(false);});break;}},{timeout:(30*1000),maximumAge:(1000*60*5),enableHighAccuracy:true});var a=navigator.geolocation.watchPosition(function(d){console.debug("Newer Position Found",d);c.setLastPosition(d);$(document).trigger("locationupdate",[d]);});}else{$(document).trigger("locationupdate",[b]);}}else{setNotificationVisibility(true,"Location Services",gblController.unsupportBrowserMsg,"Dismiss",function(){setLoadMask(false);});}},getPrivKey:function(c,b){var a=this;b=b||Ext.emptyFn;if(!a.privKey){a.privKey={v1:a.debugVPrivKey,r1:a.debugRPrivKey,venue:a.debugVenuePrivKey,venueId:1};}return((c)?a.privKey[c]:a.privKey);}}};(function(){$.Event("kickbak:updateDeviceToken");var a=Genesis.constants;if($.os.ios){initPushwoosh=function(){if(debugMode){a.pushNotifAppName="KickBak Dev Latest";a.pushNotifAppId="93D8A-5BE72";}else{a.pushNotifAppName="KickBak Production";a.pushNotifAppId="4fef6fb0691c12.54726991";}a.pushNotifType=1;var b=window.plugins.pushNotification;document.addEventListener("push-notification",function(e){if(e.notification){var f=e.notification,d=f.u;console.debug("push notifcation - ["+JSON.stringify(f)+"]");setNotificationVisibility(true,"KICKBAK Notification",f.aps.alert,"Dismiss",function(){setLoadMask(true);});var c=_application.getController("client.Viewport");c.setApsPayload(d);c.getGeoLocation();}});b.onDeviceReady();b.registerDevice({alert:true,badge:true,sound:true,pw_appid:Genesis.constants.pushNotifAppId,appname:Genesis.constants.pushNotifAppName},function(d){var e=d.deviceToken,c;console.debug("registerDevice: "+e);Genesis.constants.device={device_type:Genesis.constants.pushNotifType,device_id:e};$(document).trigger("kickbak:updateDeviceToken");},function(c){console.debug("failed to register : "+JSON.stringify(c));Genesis.constants.device=null;});};}else{if($.os.android){initPushwoosh=function(){if(debugMode){a.pushNotifAppName="KickBak Dev Latest";a.pushNotifAppId="93D8A-5BE72";a.pushNotifProjectId="658015469194";}else{a.pushNotifAppName="KickBak Production";a.pushNotifAppId="4fef6fb0691c12.54726991";a.pushNotifProjectId="733275653511";}a.pushNotifType=3;var b=window.plugins.pushNotification;document.addEventListener("push-notification",function(e){if(e.notification){var f=e.notification,g=f.title,d=f.userdata,c=_application.getController("client.Viewport");console.debug("push notifcation - ["+JSON.stringify(f)+"]");setNotificationVisibility(true,"KICKBAK Notification",g,"Dismiss",function(){setLoadMask(true);});c.setApsPayload(d);c.getGeoLocation();}else{console.warn("push notifcation - Null Notification");}});b.onDeviceReady();b.registerDevice({projectid:Genesis.constants.pushNotifProjectId,appid:Genesis.constants.pushNotifAppId},function(d){var e=d,c;console.debug("registerDevice: "+e);Genesis.constants.device={device_type:Genesis.constants.pushNotifType,device_id:e};$(document).trigger("kickbak:updateDeviceToken");},function(c){console.debug("failed to register : "+JSON.stringify(c));Genesis.constants.device=null;$(document).trigger("kickbak:updateDeviceToken");});};}else{}}})();(function(i){var g={},b,k,h,e=750,a;function c(m){return"tagName" in m?m:m.parentNode;}function j(n,m,p,o){var r=Math.abs(n-m),q=Math.abs(p-o);return r>=q?(n-m>0?"Left":"Right"):(p-o>0?"Up":"Down");}function l(){a=null;if(g.last){g.el.trigger("longTap");g={};}}function d(){if(a){clearTimeout(a);}a=null;}function f(){if(b){clearTimeout(b);}if(k){clearTimeout(k);}if(h){clearTimeout(h);}if(a){clearTimeout(a);}b=k=h=a=null;g={};}i(document).ready(function(){var m,n;i(document.body).bind("touchstart",function(o){m=Date.now();n=m-(g.last||m);g.el=i(c(o.touches[0].target));b&&clearTimeout(b);g.x1=o.touches[0].pageX;g.y1=o.touches[0].pageY;if(n>0&&n<=250){g.isDoubleTap=true;}g.last=m;a=setTimeout(l,e);}).bind("touchmove",function(o){d();g.x2=o.touches[0].pageX;g.y2=o.touches[0].pageY;if(Math.abs(g.x1-g.x2)>10){o.preventDefault();}}).bind("touchend",function(o){d();if((g.x2&&Math.abs(g.x1-g.x2)>30)||(g.y2&&Math.abs(g.y1-g.y2)>30)){h=setTimeout(function(){g.el.trigger("swipe");g.el.trigger("swipe"+(j(g.x1,g.x2,g.y1,g.y2)));g={};},0);}else{if("last" in g){k=setTimeout(function(){var p=i.Event("tap");p.cancelTouch=f;g.el.trigger(p);if(g.isDoubleTap){g.el.trigger("doubleTap");g={};}else{b=setTimeout(function(){b=null;g.el.trigger("singleTap");g={};},250);}},0);}}}).bind("touchcancel",f);i(window).bind("scroll",f);});["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(n){i.fn[n]=function(m){return this.bind(n,m);};});})(Zepto);(function(f){var e={},g=f.fn.data,c=f.camelCase,h=f.expando="Zepto"+(+new Date());function a(l,j){var m=l[h],i=m&&e[m];if(j===undefined){return i||b(l);}else{if(i){if(j in i){return i[j];}var k=c(j);if(k in i){return i[k];}}return g.call(f(l),j);}}function b(k,j,l){var m=k[h]||(k[h]=++f.uuid),i=e[m]||(e[m]=d(k));if(j!==undefined){i[c(j)]=l;}return i;}function d(j){var i={};f.each(j.attributes,function(l,k){if(k.name.indexOf("data-")==0){i[c(k.name.replace("data-",""))]=f.zepto.deserializeValue(k.value);}});return i;}f.fn.data=function(i,j){return j===undefined?f.isPlainObject(i)?this.each(function(k,l){f.each(i,function(m,n){b(l,m,n);});}):this.length==0?undefined:a(this[0],i):this.each(function(){b(this,i,j);});};f.fn.removeData=function(i){if(typeof i=="string"){i=i.split(/\s+/);}return this.each(function(){var k=this[h],j=k&&e[k];if(j){f.each(i,function(){delete j[c(this)];});}});};})(Zepto);(function(a){a.fn.infiniteScroll=function(){var g=a(this);var b=a(window);var d=a("body");var c="init";var h=false;var i=true;var j={threshold:80,onBottom:function(){},onEnd:null,iScroll:null};if(arguments.length){if(typeof arguments[0]==="string"){c=arguments[0];if(arguments.length>1&&typeof arguments[1]==="object"){j=a.extend(j,arguments[1]);}}else{if(typeof arguments[0]==="object"){j=a.extend(j,arguments[0]);}}}if(c==="init"){var f=function(){if(h||!i){return;}var k=j.iScroll?-j.iScroll.maxScrollY+j.iScroll.y:d.outerHeight()-b.height()-b.scrollTop();if(k<j.threshold){h=true;j.onBottom(function(l){if(l===false){i=false;if(typeof j.onEnd==="function"){j.onEnd();}}h=false;});}};if(j.iScroll){var e=j.iScroll.options.onScrollMove||null;j.iScroll.options.onScrollMove=function(){if(e){e();}f();};j.iScroll_scrollMove=e;}else{b.on("scroll.infinite resize.infinite",f);}g.data("infinite-scroll",j);a(f);}if(c==="reset"){var j=g.data("infinite-scroll");if(j.iScroll){if(j.iScroll_scrollMove){j.iScroll.options.onScrollMove=j.iScroll_scrollMove;}j.iScroll.scrollTo(0,0,0,false);}b.off("scroll.infinite resize.infinite");g.infiniteScroll(j);}return this;};})(jQuery);
/*! iScroll v5.0.4 ~ (c) 2008-2013 Matteo Spinelli ~ http://cubiq.org/license */
;var IScroll=function(b,a,d){function g(h,i){this.wrapper="string"==typeof h?a.querySelector(h):h,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeIndicator:!0,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,HWCompositing:!0,useTransition:!0,useTransform:!0};for(var l in i){this.options[l]=i[l];}this.translateZ=this.options.HWCompositing&&c.hasPerspective?" translateZ(0)":"",this.options.useTransition=c.hasTransition&&this.options.useTransition,this.options.useTransform=c.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?c.ease[this.options.bounceEasing]||c.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable();}function j(h,i,l){var m=a.createElement("div"),p=a.createElement("div");return l===!0&&(m.style.cssText="position:absolute;z-index:9999",p.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),p.className="iScrollIndicator","h"==h?(l===!0&&(m.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",p.style.height="100%"),m.className="iScrollHorizontalScrollbar"):(l===!0&&(m.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",p.style.width="100%"),m.className="iScrollVerticalScrollbar"),i||(m.style.pointerEvents="none"),m.appendChild(p),m;}function k(h,i){this.wrapper="string"==typeof i.el?a.querySelector(i.el):i.el,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=h,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,speedRatioX:0,speedRatioY:0};for(var l in i){this.options[l]=i[l];}this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(c.addEvent(this.indicator,"touchstart",this),c.addEvent(this.indicator,"MSPointerDown",this),c.addEvent(this.indicator,"mousedown",this),c.addEvent(b,"touchend",this),c.addEvent(b,"MSPointerUp",this),c.addEvent(b,"mouseup",this));}var f=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(e){b.setTimeout(e,1000/60);},c=function(){function m(e){return l===!1?!1:""===l?e:l+e.charAt(0).toUpperCase()+e.substr(1);}var p={},q=a.createElement("div").style,l=function(){for(var n,h=["t","webkitT","MozT","msT","OT"],o=0,r=h.length;r>o;o++){if(n=h[o]+"ransform",n in q){return h[o].substr(0,h[o].length-1);}}return !1;}();p.getTime=Date.now||function(){return(new Date).getTime();},p.extend=function(h,e){for(var n in e){h[n]=e[n];}},p.addEvent=function(n,h,o,r){n.addEventListener(h,o,!!r);},p.removeEvent=function(n,h,o,r){n.removeEventListener(h,o,!!r);},p.momentum=function(C,x,z,u,v){var s,y,B=C-x,w=d.abs(B)/z,A=0.0006;return s=C+w*w/(2*A)*(0>B?-1:1),y=w/A,u>s?(s=v?u-v/2.5*(w/8):u,B=d.abs(s-C),y=B/w):s>0&&(s=v?v/2.5*(w/8):0,B=d.abs(C)+s,y=B/w),{destination:d.round(s),duration:y};};var i=m("transform");return p.extend(p,{hasTransform:i!==!1,hasPerspective:m("perspective") in q,hasTouch:"ontouchstart" in b,hasPointer:navigator.msPointerEnabled,hasTransition:m("transition") in q}),p.isAndroidBrowser=/Android/.test(b.navigator.appVersion)&&/Version\/\d/.test(b.navigator.appVersion),p.extend(p.style={},{transform:i,transitionTimingFunction:m("transitionTimingFunction"),transitionDuration:m("transitionDuration"),transformOrigin:m("transformOrigin")}),p.hasClass=function(h,e){var n=new RegExp("(^|\\s)"+e+"(\\s|$)");return n.test(h.className);},p.addClass=function(h,e){if(!p.hasClass(h,e)){var n=h.className.split(" ");n.push(e),h.className=n.join(" ");}},p.removeClass=function(h,e){if(p.hasClass(h,e)){var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");h.className=h.className.replace(n,"");}},p.offset=function(h){for(var e=-h.offsetLeft,n=-h.offsetTop;h=h.offsetParent;){e-=h.offsetLeft,n-=h.offsetTop;}return{left:e,top:n};},p.extend(p.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),p.extend(p.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e);}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return d.sqrt(1- --e*e);}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(h){var e=4;return(h-=1)*h*((e+1)*h+e)+1;}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+0.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375;}},elastic:{style:"",fn:function(n){var h=0.22,o=0.4;return 0===n?0:1==n?1:o*d.pow(2,-10*n)*d.sin((n-h/4)*2*d.PI/h)+1;}}}),p.tap=function(h,n){var o=a.createEvent("Event");o.initEvent(n,!0,!0),o.pageX=h.pageX,o.pageY=h.pageY,h.target.dispatchEvent(o);},p.click=function(h){var n,o=h.target;"SELECT"!=o.tagName&&"INPUT"!=o.tagName&&"TEXTAREA"!=o.tagName&&(n=a.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,h.view,1,o.screenX,o.screenY,o.clientX,o.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,0,null),n._constructed=!0,o.dispatchEvent(n));},p;}();return g.prototype={version:"5.0.4",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys();},destroy:function(){this._initEvents(!0),this._execEvent("destroy");},_transitionEnd:function(e){e.target==this.scroller&&(this._transitionTime(0),this.resetPosition(this.options.bounceTime)||this._execEvent("scrollEnd"));},_start:function(l){if(!(1!=c.eventType[l.type]&&0!==l.button||!this.enabled||this.initiated&&c.eventType[l.type]!==this.initiated)){this.options.preventDefault&&!c.isAndroidBrowser&&l.preventDefault();var h,m=l.touches?l.touches[0]:l;this.initiated=c.eventType[l.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.isAnimating=!1,this.startTime=c.getTime(),this.options.useTransition&&this.isInTransition&&(h=this.getComputedPosition(),this._translate(d.round(h.x),d.round(h.y)),this.isInTransition=!1),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=m.pageX,this.pointY=m.pageY,this._execEvent("scrollStart");}},_move:function(x){if(this.enabled&&c.eventType[x.type]===this.initiated){this.options.preventDefault&&x.preventDefault();var s,u,m,p,h=x.touches?x.touches[0]:x,w=this.hasHorizontalScroll?h.pageX-this.pointX:0,q=this.hasVerticalScroll?h.pageY-this.pointY:0,v=c.getTime();if(this.pointX=h.pageX,this.pointY=h.pageY,this.distX+=w,this.distY+=q,m=d.abs(this.distX),p=d.abs(this.distY),!(v-this.endTime>300&&10>m&&10>p)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=m>p+this.options.directionLockThreshold?"h":p>=m+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough){x.preventDefault();}else{if("horizontal"==this.options.eventPassthrough){return this.initiated=!1,void 0;}}q=0;}else{if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough){x.preventDefault();}else{if("vertical"==this.options.eventPassthrough){return this.initiated=!1,void 0;}}w=0;}}s=this.x+w,u=this.y+q,(s>0||s<this.maxScrollX)&&(s=this.options.bounce?this.x+w/3:s>0?0:this.maxScrollX),(u>0||u<this.maxScrollY)&&(u=this.options.bounce?this.y+q/3:u>0?0:this.maxScrollY),this.directionX=w>0?-1:0>w?1:0,this.directionY=q>0?-1:0>q?1:0,this.moved=!0,this._translate(s,u),v-this.startTime>300&&(this.startTime=v,this.startX=this.x,this.startY=this.y);}}},_end:function(B){if(this.enabled&&c.eventType[B.type]===this.initiated){this.options.preventDefault&&B.preventDefault();var w,x,q=(B.changedTouches?B.changedTouches[0]:B,c.getTime()-this.startTime),s=d.round(this.x),h=d.round(this.y),z=d.abs(s-this.startX),v=d.abs(h-this.startY),y=0,m="";if(this.scrollTo(s,h),this.isInTransition=0,this.initiated=0,this.endTime=c.getTime(),!this.resetPosition(this.options.bounceTime)){if(!this.moved){return this.options.tap&&c.tap(B,this.options.tap),this.options.click&&c.click(B),void 0;}if(this._events.flick&&200>q&&100>z&&100>v){return this._execEvent("flick"),void 0;}if(this.options.momentum&&300>q&&(w=this.hasHorizontalScroll?c.momentum(this.x,this.startX,q,this.maxScrollX,this.options.bounce?this.wrapperWidth:0):{destination:s,duration:0},x=this.hasVerticalScroll?c.momentum(this.y,this.startY,q,this.maxScrollY,this.options.bounce?this.wrapperHeight:0):{destination:h,duration:0},s=w.destination,h=x.destination,y=d.max(w.duration,x.duration),this.isInTransition=1),this.options.snap){var A=this._nearestSnap(s,h);this.currentPage=A,s=A.x,h=A.y,y=this.options.snapSpeed||d.max(d.max(d.min(z,1000),d.min(z,1000)),300),this.directionX=0,this.directionY=0,m=this.options.bounceEasing;}return s!=this.x||h!=this.y?((s>0||s<this.maxScrollX||h>0||h<this.maxScrollY)&&(m=c.ease.quadratic),this.scrollTo(s,h,y,m),void 0):(this._execEvent("scrollEnd"),void 0);}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh();},this.options.resizePolling);},resetPosition:function(h){var e=this.x,l=this.y;return h=h||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?l=0:this.y<this.maxScrollY&&(l=this.maxScrollY),e==this.x&&l==this.y?!1:(this.scrollTo(e,l,h,this.options.bounceEasing),!0);},disable:function(){this.enabled=!1;},enable:function(){this.enabled=!0;},refresh:function(){if(this.wrapper.offsetHeight,this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=c.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition(),this.options.snap){var e=this._nearestSnap(this.x,this.y);if(this.x==e.x&&this.y==e.y){return;}this.currentPage=e,this.scrollTo(e.x,e.y);}},on:function(h,e){this._events[h]||(this._events[h]=[]),this._events[h].push(e);},_execEvent:function(h){if(this._events[h]){var e=0,l=this._events[h].length;if(l){for(;l>e;e++){this._events[h][e].call(this);}}}},scrollBy:function(l,h,m,n){l=this.x+l,h=this.y+h,m=m||0,this.scrollTo(l,h,m,n);},scrollTo:function(l,h,m,n){n=n||c.ease.circular,!m||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(m),this._translate(l,h)):this._animate(l,h,m,n.fn);},scrollToElement:function(l,h,p,q,s){if(l=l.nodeType?l:this.scroller.querySelector(l)){var m=c.offset(l);m.left-=this.wrapperOffset.left,m.top-=this.wrapperOffset.top,p===!0&&(p=d.round(l.offsetWidth/2-this.wrapper.offsetWidth/2)),q===!0&&(q=d.round(l.offsetHeight/2-this.wrapper.offsetHeight/2)),m.left-=p||0,m.top-=q||0,m.left=m.left>0?0:m.left<this.maxScrollX?this.maxScrollX:m.left,m.top=m.top>0?0:m.top<this.maxScrollY?this.maxScrollY:m.top,h=void 0===h||null===h||"auto"===h?d.max(2*d.abs(m.left),2*d.abs(m.top)):h,this.scrollTo(m.left,m.top,h,s);}},_transitionTime:function(e){e=e||0,this.scrollerStyle[c.style.transitionDuration]=e+"ms",this.indicator1&&this.indicator1.transitionTime(e),this.indicator2&&this.indicator2.transitionTime(e);},_transitionTimingFunction:function(e){this.scrollerStyle[c.style.transitionTimingFunction]=e,this.indicator1&&this.indicator1.transitionTimingFunction(e),this.indicator2&&this.indicator2.transitionTimingFunction(e);},_translate:function(h,e){this.options.useTransform?this.scrollerStyle[c.style.transform]="translate("+h+"px,"+e+"px)"+this.translateZ:(h=d.round(h),e=d.round(e),this.scrollerStyle.left=h+"px",this.scrollerStyle.top=e+"px"),this.x=h,this.y=e,this.indicator1&&this.indicator1.updatePosition(),this.indicator2&&this.indicator2.updatePosition();},_initEvents:function(h){var l=h?c.removeEvent:c.addEvent,m=this.options.bindToWrapper?this.wrapper:b;l(b,"orientationchange",this),l(b,"resize",this),l(this.wrapper,"mousedown",this),l(m,"mousemove",this),l(m,"mousecancel",this),l(m,"mouseup",this),c.hasPointer&&(l(this.wrapper,"MSPointerDown",this),l(m,"MSPointerMove",this),l(m,"MSPointerCancel",this),l(m,"MSPointerUp",this)),c.hasTouch&&(l(this.wrapper,"touchstart",this),l(m,"touchmove",this),l(m,"touchcancel",this),l(m,"touchend",this)),l(this.scroller,"transitionend",this),l(this.scroller,"webkitTransitionEnd",this),l(this.scroller,"oTransitionEnd",this),l(this.scroller,"MSTransitionEnd",this);},getComputedPosition:function(){var h,l,m=b.getComputedStyle(this.scroller,null);return this.options.useTransform?(m=m[c.style.transform].split(")")[0].split(", "),h=+(m[12]||m[4]),l=+(m[13]||m[5])):(h=+m.left.replace(/[^-\d]/g,""),l=+m.top.replace(/[^-\d]/g,"")),{x:h,y:l};},_initIndicators:function(){var l,h,m=this.options.interactiveScrollbars,n=("object"!=typeof this.options.scrollbars,"string"!=typeof this.options.scrollbars);this.options.scrollbars?(this.options.scrollY&&(l={el:j("v",m,this.options.scrollbars),interactive:m,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeIndicator,listenX:!1},this.wrapper.appendChild(l.el)),this.options.scrollX&&(h={el:j("h",m,this.options.scrollbars),interactive:m,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeIndicator,listenY:!1},this.wrapper.appendChild(h.el))):(l=this.options.indicators.length?this.options.indicators[0]:this.options.indicators,h=this.options.indicators[1]&&this.options.indicators[1]),l&&(this.indicator1=new k(this,l)),h&&(this.indicator2=new k(this,h)),this.on("refresh",function(){this.indicator1&&this.indicator1.refresh(),this.indicator2&&this.indicator2.refresh();}),this.on("destroy",function(){this.indicator1&&(this.indicator1.destroy(),this.indicator1=null),this.indicator2&&(this.indicator2.destroy(),this.indicator2=null);});},_initWheel:function(){c.addEvent(this.wrapper,"mousewheel",this),c.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){c.removeEvent(this.wrapper,"mousewheel",this),c.removeEvent(this.wrapper,"DOMMouseScroll",this);});},_wheel:function(l){if(this.enabled){var h,m,p,q,r=this;if(clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){r._execEvent("scrollEnd");},400),l.preventDefault(),"wheelDeltaX" in l){h=l.wheelDeltaX/120,m=l.wheelDeltaY/120;}else{if("wheelDelta" in l){h=m=l.wheelDelta/120;}else{if(!("detail" in l)){return;}h=m=-l.detail/3;}}h*=this.options.mouseWheelSpeed,m*=this.options.mouseWheelSpeed,this.hasVerticalScroll||(h=m),p=this.x+(this.hasHorizontalScroll?h*this.options.invertWheelDirection:0),q=this.y+(this.hasVerticalScroll?m*this.options.invertWheelDirection:0),p>0?p=0:p<this.maxScrollX&&(p=this.maxScrollX),q>0?q=0:q<this.maxScrollY&&(q=this.maxScrollY),this.scrollTo(p,q,0);}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var B,w,y,s,u,m,x=0,A=0,v=0,z=this.options.snapStepX||this.wrapperWidth,q=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.options.snap===!0){for(y=d.round(z/2),s=d.round(q/2);v>-this.scrollerWidth;){for(this.pages[x]=[],B=0,u=0;u>-this.scrollerHeight;){this.pages[x][B]={x:d.max(v,this.maxScrollX),y:d.max(u,this.maxScrollY),width:z,height:q,cx:v-y,cy:u-s},u-=q,B++;}v-=z,x++;}}else{for(m=this.options.snap,B=m.length,w=-1;B>x;x++){(0===x||m[x].offsetLeft<=m[x-1].offsetLeft)&&(A=0,w++),this.pages[A]||(this.pages[A]=[]),v=d.max(-m[x].offsetLeft,this.maxScrollX),u=d.max(-m[x].offsetTop,this.maxScrollY),y=v-d.round(m[x].offsetWidth/2),s=u-d.round(m[x].offsetHeight/2),this.pages[A][w]={x:v,y:u,width:m[x].offsetWidth,height:m[x].offsetHeight,cx:y,cy:s},v>this.maxScrollX&&A++;}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),0===this.options.snapThreshold%1?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=d.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=d.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold));}),this.on("flick",function(){var e=this.options.snapSpeed||d.max(d.max(d.min(d.abs(this.x-this.startX),1000),d.min(d.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e);});},_nearestSnap:function(l,h){var m=0,p=this.pages.length,q=0;if(d.abs(l-this.absStartX)<this.snapThresholdX&&d.abs(h-this.absStartY)<this.snapThresholdY){return this.currentPage;}for(l>0?l=0:l<this.maxScrollX&&(l=this.maxScrollX),h>0?h=0:h<this.maxScrollY&&(h=this.maxScrollY);p>m;m++){if(l>=this.pages[m][0].cx){l=this.pages[m][0].x;break;}}for(p=this.pages[m].length;p>q;q++){if(h>=this.pages[0][q].cy){h=this.pages[0][q].y;break;}}return m==this.currentPage.pageX&&(m+=this.directionX,0>m?m=0:m>=this.pages.length&&(m=this.pages.length-1),l=this.pages[m][0].x),q==this.currentPage.pageY&&(q+=this.directionY,0>q?q=0:q>=this.pages[0].length&&(q=this.pages[0].length-1),h=this.pages[0][q].y),{x:l,y:h,pageX:m,pageY:q};},goToPage:function(l,h,p,q){q=q||this.options.bounceEasing,l>=this.pages.length?l=this.pages.length-1:0>l&&(l=0),h>=this.pages[0].length?h=this.pages[0].length-1:0>h&&(h=0);var s=this.pages[l][h].x,m=this.pages[l][h].y;p=void 0===p?this.options.snapSpeed||d.max(d.max(d.min(d.abs(s-this.x),1000),d.min(d.abs(m-this.y),1000)),300):p,this.currentPage={x:s,y:m,pageX:l,pageY:h},this.scrollTo(s,m,p,q);},next:function(l,h){var m=this.currentPage.pageX,n=this.currentPage.pageY;m++,m>=this.pages.length&&this.hasVerticalScroll&&(m=0,n++),this.goToPage(m,n,l,h);},prev:function(l,h){var m=this.currentPage.pageX,n=this.currentPage.pageY;m--,0>m&&this.hasVerticalScroll&&(m=0,n--),this.goToPage(m,n,l,h);},_initKeys:function(){var e,h={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings){for(e in this.options.keyBindings){"string"==typeof this.options.keyBindings[e]&&(this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0));}}else{this.options.keyBindings={};}for(e in h){this.options.keyBindings[e]=this.options.keyBindings[e]||h[e];}c.addEvent(b,"keydown",this),this.on("destroy",function(){c.removeEvent(b,"keydown",this);});},_key:function(q){if(this.enabled){var p,u=this.options.snap,v=u?this.currentPage.pageX:this.x,w=u?this.currentPage.pageY:this.y,s=c.getTime(),m=this.keyTime||0,h=0.25;switch(this.options.useTransition&&this.isInTransition&&(p=this.getComputedPosition(),this._translate(d.round(p.x),d.round(p.y)),this.isInTransition=!1),this.keyAcceleration=200>s-m?d.min(this.keyAcceleration+h,50):0,q.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?v+=u?1:this.wrapperWidth:w+=u?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?v-=u?1:this.wrapperWidth:w-=u?1:this.wrapperHeight;break;case this.options.keyBindings.end:v=u?this.pages.length-1:this.maxScrollX,w=u?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:v=0,w=0;break;case this.options.keyBindings.left:v+=u?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:w+=u?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:v-=u?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:w-=u?1:5+this.keyAcceleration>>0;}if(u){return this.goToPage(v,w),void 0;}v>0?(v=0,this.keyAcceleration=0):v<this.maxScrollX&&(v=this.maxScrollX,this.keyAcceleration=0),w>0?(w=0,this.keyAcceleration=0):w<this.maxScrollY&&(w=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(v,w,0),this.keyTime=s;}},_animate:function(y,u,z,v){function m(){var i,n,e,l=c.getTime();return l>=h?(q.isAnimating=!1,q._translate(y,u),q.resetPosition(q.options.bounceTime)||q._execEvent("scrollEnd"),void 0):(l=(l-w)/z,e=v(l),i=(y-x)*e+x,n=(u-r)*e+r,q._translate(i,n),q.isAnimating&&f(m),void 0);}var q=this,x=this.x,r=this.y,w=c.getTime(),h=w+z;this.isAnimating=!0,m();},handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);}}},k.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);}},destroy:function(){this.options.interactive&&(c.removeEvent(this.indicator,"touchstart",this),c.removeEvent(this.indicator,"MSPointerDown",this),c.removeEvent(this.indicator,"mousedown",this),c.removeEvent(b,"touchmove",this),c.removeEvent(b,"MSPointerMove",this),c.removeEvent(b,"mousemove",this),c.removeEvent(b,"touchend",this),c.removeEvent(b,"MSPointerUp",this),c.removeEvent(b,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper);},_start:function(e){var h=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(0),this.initiated=!0,this.moved=!1,this.lastPointX=h.pageX,this.lastPointY=h.pageY,this.startTime=c.getTime(),c.addEvent(b,"touchmove",this),c.addEvent(b,"MSPointerMove",this),c.addEvent(b,"mousemove",this),this.scroller._execEvent("scrollStart");},_move:function(l){var h,m,p,q,r=l.touches?l.touches[0]:l;c.getTime(),this.moved=!0,h=r.pageX-this.lastPointX,this.lastPointX=r.pageX,m=r.pageY-this.lastPointY,this.lastPointY=r.pageY,p=this.x+h,q=this.y+m,this._pos(p,q),l.preventDefault(),l.stopPropagation();},_end:function(e){this.initiated&&(this.initiated=!1,e.preventDefault(),e.stopPropagation(),c.removeEvent(b,"touchmove",this),c.removeEvent(b,"MSPointerMove",this),c.removeEvent(b,"mousemove",this),this.moved&&this.scroller._execEvent("scrollEnd"));},transitionTime:function(e){e=e||0,this.indicatorStyle[c.style.transitionDuration]=e+"ms";},transitionTimingFunction:function(e){this.indicatorStyle[c.style.transitionTimingFunction]=e;},refresh:function(){this.transitionTime(0),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(c.addClass(this.wrapper,"iScrollBothScrollbars"),c.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(c.removeClass(this.wrapper,"iScrollBothScrollbars"),c.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px")),this.wrapper.offsetHeight,this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=d.max(d.round(this.wrapperWidth*this.wrapperWidth/this.scroller.scrollerWidth),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=d.max(d.round(this.wrapperHeight*this.wrapperHeight/this.scroller.scrollerHeight),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition();},updatePosition:function(){var h=d.round(this.sizeRatioX*this.scroller.x)||0,e=d.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(0>h?h=0:h>this.maxPosX&&(h=this.maxPosX),0>e?e=0:e>this.maxPosY&&(e=this.maxPosY)),this.x=h,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[c.style.transform]="translate("+h+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=h+"px",this.indicatorStyle.top=e+"px");},_pos:function(h,e){0>h?h=0:h>this.maxPosX&&(h=this.maxPosX),0>e?e=0:e>this.maxPosY&&(e=this.maxPosY),h=this.options.listenX?d.round(h/this.sizeRatioX):this.scroller.x,e=this.options.listenY?d.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(h,e);}},g.ease=c.ease,g;}(window,document,Math);
/*!
 * Bootstrap v3.0.0
 *
 * Copyright 2013 Twitter, Inc
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world @twitter by @mdo and @fat.
 */
+function(d){function c(){var f=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var g in e){if(f.style[g]!==undefined){return{end:e[g]};}}}"use strict",d.fn.emulateTransitionEnd=function(a){var h=!1,g=this;d(this).one(d.support.transition.end,function(){h=!0;});var f=function(){h||d(g).trigger(d.support.transition.end);};return setTimeout(f,a),this;},d(function(){d.support.transition=c();});}(window.jQuery);