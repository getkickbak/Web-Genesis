/*e027b6b986718281d681abbd7dddb3e5e5b7cd90*/(function(g,k,l,h){if(typeof l.module!=="undefined"&&l.module.exports){if(h&&l.require){for(var f=0;f<h.length;f++){l[h[f]]=l.require(h[f])}}l.module.exports=k.apply(l)}else{if(typeof l.define!=="undefined"&&l.define==="function"&&l.define.amd){define(g,(h||[]),k)}else{l[g]=k.apply(l)}}})("utf8",function(){return{encode:function(h){if(typeof h!=="string"){return h}else{h=h.replace(/\r\n/g,"\n")}var e="",g=0,f;for(g;g<h.length;g++){f=h.charCodeAt(g);if(f<128){e+=String.fromCharCode(f)}else{if((f>127)&&(f<2048)){e+=String.fromCharCode((f>>6)|192),e+=String.fromCharCode((f&63)|128)}else{e+=String.fromCharCode((f>>12)|224),e+=String.fromCharCode(((f>>6)&63)|128),e+=String.fromCharCode((f&63)|128)}}}return e},decode:function(h){if(typeof h!=="string"){return h}var e="",g=0,f=0;while(g<h.length){f=h.charCodeAt(g);if(f<128){e+=String.fromCharCode(f),g++}else{if((f>191)&&(f<224)){e+=String.fromCharCode(((f&31)<<6)|(h.charCodeAt(g+1)&63)),g+=2}else{e+=String.fromCharCode(((f&15)<<12)|((h.charCodeAt(g+1)&63)<<6)|(h.charCodeAt(g+2)&63)),g+=3}}}return e}}},this);(function(g,k,l,h){if(typeof l.module!=="undefined"&&l.module.exports){if(h&&l.require){for(var f=0;f<h.length;f++){l[h[f]]=l.require(h[f])}}l.module.exports=k.apply(l)}else{if(typeof l.define!=="undefined"&&l.define==="function"&&l.define.amd){define(g,(h||[]),k)}else{l[g]=k()}}})("base64",function(f){var h=this;var g=f||this.utf8;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(z){if(typeof h.btoa!=="undefined"){return h.btoa(z)}if(typeof g==="undefined"){throw {error:"MissingMethod",message:"UTF8 Module is missing."}}if(typeof z!=="string"){return z}else{z=g.encode(z)}var x="",y,A,a,b,c,d,v,w=0;while(w<z.length){y=z.charCodeAt(w++);A=z.charCodeAt(w++);a=z.charCodeAt(w++);b=y>>2;c=((y&3)<<4)|(A>>4);d=((A&15)<<2)|(a>>6);v=a&63;if(isNaN(A)){d=v=64}else{if(isNaN(a)){v=64}}x+=e.charAt(b)+e.charAt(c)+e.charAt(d)+e.charAt(v)}return x},decode:function(z){if(typeof h.atob!=="undefined"){return h.atob(z)}if(typeof g==="undefined"){throw {error:"MissingMethod",message:"UTF8 Module is missing."}}if(typeof z!=="string"){return z}else{z.replace(/[^A-Za-z0-9\+\/\=]/g,"")}var x="",y,A,a,b,c,d,v,w=0;while(w<z.length){b=e.indexOf(z.charAt(w++));c=e.indexOf(z.charAt(w++));d=e.indexOf(z.charAt(w++));v=e.indexOf(z.charAt(w++));y=(b<<2)|(c>>4);A=((c&15)<<4)|(d>>2);a=((d&3)<<6)|v;x+=String.fromCharCode(y);if(d!=64){x+=String.fromCharCode(A)}if(v!=64){x+=String.fromCharCode(a)}}return g.decode(x)}}},this,["utf8"]);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var h=Date,k=h.prototype,p=h.CultureInfo,l=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};k.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};k.setTimeToNow=function(){var a=new Date();this.setHours(a.getHours());this.setMinutes(a.getMinutes());this.setSeconds(a.getSeconds());this.setMilliseconds(a.getMilliseconds());return this};h.today=function(){return new Date().clearTime()};h.compare=function(a,b){if(isNaN(a)||isNaN(b)){throw new Error(a+" - "+b)}else{if(a instanceof Date&&b instanceof Date){return(a<b)?-1:(a>b)?1:0}else{throw new TypeError(a+" - "+b)}}};h.equals=function(a,b){return(a.compareTo(b)===0)};h.getDayNumberFromName=function(b){var c=p.dayNames,d=p.abbreviatedDayNames,e=p.shortestDayNames,f=b.toLowerCase();for(var a=0;a<c.length;a++){if(c[a].toLowerCase()==f||d[a].toLowerCase()==f||e[a].toLowerCase()==f){return a}}return -1};h.getMonthNumberFromName=function(b){var d=p.monthNames,c=p.abbreviatedMonthNames,e=b.toLowerCase();for(var a=0;a<d.length;a++){if(d[a].toLowerCase()==e||c[a].toLowerCase()==e){return a}}return -1};h.isLeapYear=function(a){return((a%4===0&&a%100!==0)||a%400===0)};h.getDaysInMonth=function(b,a){return[31,(h.isLeapYear(b)?29:28),31,30,31,30,31,31,30,31,30,31][a]};h.getTimezoneAbbreviation=function(a){var b=p.timezones,c;for(var d=0;d<b.length;d++){if(b[d].offset===a){return b[d].name}}return null};h.getTimezoneOffset=function(d){var a=p.timezones,b;for(var c=0;c<a.length;c++){if(a[c].name===d.toUpperCase()){return a[c].offset}}return null};k.clone=function(){return new Date(this.getTime())};k.compareTo=function(a){return Date.compare(this,a)};k.equals=function(a){return Date.equals(this,a||new Date())};k.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()};k.isAfter=function(a){return this.compareTo(a||new Date())===1};k.isBefore=function(a){return(this.compareTo(a||new Date())===-1)};k.isToday=function(){return this.isSameDay(new Date())};k.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())};k.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+a);return this};k.addSeconds=function(a){return this.addMilliseconds(a*1000)};k.addMinutes=function(a){return this.addMilliseconds(a*60000)};k.addHours=function(a){return this.addMilliseconds(a*3600000)};k.addDays=function(a){this.setDate(this.getDate()+a);return this};k.addWeeks=function(a){return this.addDays(a*7)};k.addMonths=function(b){var a=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b);this.setDate(Math.min(a,h.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};k.addYears=function(a){return this.addMonths(a*12)};k.add=function(a){if(typeof a=="number"){this._orient=a;return this}var b=a;if(b.milliseconds){this.addMilliseconds(b.milliseconds)}if(b.seconds){this.addSeconds(b.seconds)}if(b.minutes){this.addMinutes(b.minutes)}if(b.hours){this.addHours(b.hours)}if(b.weeks){this.addWeeks(b.weeks)}if(b.months){this.addMonths(b.months)}if(b.years){this.addYears(b.years)}if(b.days){this.addDays(b.days)}return this};var o,m,q;k.getWeek=function(){var x,a,b,c,d,e,f,g,s,w;o=(!o)?this.getFullYear():o;m=(!m)?this.getMonth()+1:m;q=(!q)?this.getDate():q;if(m<=2){x=o-1;a=(x/4|0)-(x/100|0)+(x/400|0);b=((x-1)/4|0)-((x-1)/100|0)+((x-1)/400|0);s=a-b;d=0;e=q-1+(31*(m-1))}else{x=o;a=(x/4|0)-(x/100|0)+(x/400|0);b=((x-1)/4|0)-((x-1)/100|0)+((x-1)/400|0);s=a-b;d=s+1;e=q+((153*(m-3)+2)/5)+58+s}f=(x+a)%7;c=(e+f-d)%7;g=(e+3-c)|0;if(g<0){w=53-((f-s)/5|0)}else{if(g>364+s){w=1}else{w=(g/7|0)+1}}o=m=q=null;return w};k.getISOWeek=function(){o=this.getUTCFullYear();m=this.getUTCMonth()+1;q=this.getUTCDate();return l(this.getWeek())};k.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())};h._validate=function(a,b,d,c){if(typeof a=="undefined"){return false}else{if(typeof a!="number"){throw new TypeError(a+" is not a Number.")}else{if(a<b||a>d){throw new RangeError(a+" is not a valid value for "+c+".")}}}return true};h.validateMillisecond=function(a){return h._validate(a,0,999,"millisecond")};h.validateSecond=function(a){return h._validate(a,0,59,"second")};h.validateMinute=function(a){return h._validate(a,0,59,"minute")};h.validateHour=function(a){return h._validate(a,0,23,"hour")};h.validateDay=function(b,c,a){return h._validate(b,1,h.getDaysInMonth(c,a),"day")};h.validateMonth=function(a){return h._validate(a,0,11,"month")};h.validateYear=function(a){return h._validate(a,0,9999,"year")};k.set=function(a){if(h.validateMillisecond(a.millisecond)){this.addMilliseconds(a.millisecond-this.getMilliseconds())}if(h.validateSecond(a.second)){this.addSeconds(a.second-this.getSeconds())}if(h.validateMinute(a.minute)){this.addMinutes(a.minute-this.getMinutes())}if(h.validateHour(a.hour)){this.addHours(a.hour-this.getHours())}if(h.validateMonth(a.month)){this.addMonths(a.month-this.getMonth())}if(h.validateYear(a.year)){this.addYears(a.year-this.getFullYear())}if(h.validateDay(a.day,this.getFullYear(),this.getMonth())){this.addDays(a.day-this.getDate())}if(a.timezone){this.setTimezone(a.timezone)}if(a.timezoneOffset){this.setTimezoneOffset(a.timezoneOffset)}if(a.week&&h._validate(a.week,0,53,"week")){this.setWeek(a.week)}return this};k.moveToFirstDayOfMonth=function(){return this.set({day:1})};k.moveToLastDayOfMonth=function(){return this.set({day:h.getDaysInMonth(this.getFullYear(),this.getMonth())})};k.moveToNthOccurrence=function(b,a){var c=0;if(a>0){c=a-1}else{if(a===-1){this.moveToLastDayOfMonth();if(this.getDay()!==b){this.moveToDayOfWeek(b,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(b,+1).addWeeks(c)};k.moveToDayOfWeek=function(c,b){var a=(c-this.getDay()+7*(b||+1))%7;return this.addDays((a===0)?a+=7*(b||+1):a)};k.moveToMonth=function(a,c){var b=(a-this.getMonth()+12*(c||+1))%12;return this.addMonths((b===0)?b+=12*(c||+1):b)};k.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};k.getTimezone=function(){return h.getTimezoneAbbreviation(this.getUTCOffset())};k.setTimezoneOffset=function(a){var c=this.getTimezoneOffset(),b=Number(a)*-6/10;return this.addMinutes(b-c)};k.setTimezone=function(a){return this.setTimezoneOffset(h.getTimezoneOffset(a))};k.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};k.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset())};k.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;if(a<0){b=(a-10000).toString();return b.charAt(0)+b.substr(2)}else{b=(a+10000).toString();return"+"+b.substr(1)}};k.getElapsed=function(a){return(a||new Date())-this};if(!k.toISOString){k.toISOString=function(){function a(b){return b<10?"0"+b:b}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}}k._toString=k.toString;k.toString=function(b){var d=this;if(b&&b.length==1){var a=p.formatPatterns;d.t=d.toString;switch(b){case"d":return d.t(a.shortDate);case"D":return d.t(a.longDate);case"F":return d.t(a.fullDateTime);case"m":return d.t(a.monthDay);case"r":return d.t(a.rfc1123);case"s":return d.t(a.sortableDateTime);case"t":return d.t(a.shortTime);case"T":return d.t(a.longTime);case"u":return d.t(a.universalSortableDateTime);case"y":return d.t(a.yearMonth)}}var c=function(e){switch(e*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return b?b.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(e){if(e.charAt(0)==="\\"){return e.replace("\\","")}d.h=d.getHours;switch(e){case"hh":return l(d.h()<13?(d.h()===0?12:d.h()):(d.h()-12));case"h":return d.h()<13?(d.h()===0?12:d.h()):(d.h()-12);case"HH":return l(d.h());case"H":return d.h();case"mm":return l(d.getMinutes());case"m":return d.getMinutes();case"ss":return l(d.getSeconds());case"s":return d.getSeconds();case"yyyy":return l(d.getFullYear(),4);case"yy":return l(d.getFullYear());case"dddd":return p.dayNames[d.getDay()];case"ddd":return p.abbreviatedDayNames[d.getDay()];case"dd":return l(d.getDate());case"d":return d.getDate();case"MMMM":return p.monthNames[d.getMonth()];case"MMM":return p.abbreviatedMonthNames[d.getMonth()];case"MM":return l((d.getMonth()+1));case"M":return d.getMonth()+1;case"t":return d.h()<12?p.amDesignator.substring(0,1):p.pmDesignator.substring(0,1);case"tt":return d.h()<12?p.amDesignator:p.pmDesignator;case"S":return c(d.getDate());default:return e}}):this._toString()}}());(function(){var C=Date,N=C.prototype,B=C.CultureInfo,J=Number.prototype;N._orient=+1;N._nth=null;N._is=false;N._same=false;N._isSecond=false;J._dateElement="day";N.next=function(){this._orient=+1;return this};C.next=function(){return C.today().next()};N.last=N.prev=N.previous=function(){this._orient=-1;return this};C.last=C.prev=C.previous=function(){return C.today().last()};N.is=function(){this._is=true;return this};N.same=function(){this._same=true;this._isSecond=false;return this};N.today=function(){return this.same().day()};N.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};N.at=function(a){return(typeof a==="string")?C.parse(this.toString("d")+" "+a):this.set(a)};J.fromNow=J.after=function(b){var a={};a[this._dateElement]=this;return((!b)?new Date():b.clone()).add(a)};J.ago=J.before=function(b){var a={};a[this._dateElement]=this*-1;return((!b)?new Date():b.clone()).add(a)};var P=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),M=("january february march april may june july august september october november december").split(/\s/),K=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),H=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),S=("final first second third fourth fifth").split(/\s/),k;N.toObject=function(){var a={};for(var b=0;b<K.length;b++){a[K[b].toLowerCase()]=this["get"+H[b]]()}return a};C.fromObject=function(a){a.week=null;return Date.today().set(a)};var l=function(a){return function(){if(this._is){this._is=false;return this.getDay()==a}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var c=this._nth;this._nth=null;var b=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(a,c);if(this>b){throw new RangeError(C.getDayName(a)+" does not occur "+c+" times in the month of "+C.getMonthName(b.getMonth())+" "+b.getFullYear()+".")}return this}return this.moveToDayOfWeek(a,this._orient)}};var O=function(a){return function(){var c=C.today(),b=a-c.getDay();if(a===0&&B.firstDayOfWeek===1&&c.getDay()!==0){b=b+7}return c.addDays(b)}};for(var D=0;D<P.length;D++){C[P[D].toUpperCase()]=C[P[D].toUpperCase().substring(0,3)]=D;C[P[D]]=C[P[D].substring(0,3)]=O(D);N[P[D]]=N[P[D].substring(0,3)]=l(D)}var I=function(a){return function(){if(this._is){this._is=false;return this.getMonth()===a}return this.moveToMonth(a,this._orient)}};var L=function(a){return function(){return C.today().set({month:a,day:1})}};for(var E=0;E<M.length;E++){C[M[E].toUpperCase()]=C[M[E].toUpperCase().substring(0,3)]=E;C[M[E]]=C[M[E].substring(0,3)]=L(E);N[M[E]]=N[M[E].substring(0,3)]=I(E)}var R=function(a){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var c=this.toObject(),d=(arguments[0]||new Date()).toObject(),e="",f=a.toLowerCase();for(var b=(K.length-1);b>-1;b--){e=K[b].toLowerCase();if(c[e]!=d[e]){return false}if(f==e){break}}return true}if(a.substring(a.length-1)!="s"){a+="s"}return this["add"+a](this._orient)}};var Q=function(a){return function(){this._dateElement=a;return this}};for(var F=0;F<K.length;F++){k=K[F].toLowerCase();N[k]=N[k+"s"]=R(K[F]);J[k]=J[k+"s"]=Q(k)}N._ss=R("Second");var T=function(a){return function(b){if(this._same){return this._ss(arguments[0])}if(b||b===0){return this.moveToNthOccurrence(b,a)}this._nth=a;if(a===2&&(b===undefined||b===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var G=0;G<S.length;G++){N[S[G]]=(G===0)?T(-1):T(G)}}());(function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var l=Date.Parsing;var t=l.Operators={rtoken:function(a){return function(c){var b=c.match(a);if(b){return([b[0],c.substring(b[0].length)])}else{throw new l.Exception(c)}}},token:function(a){return function(b){return t.rtoken(new RegExp("^s*"+b+"s*"))(b)}},stoken:function(a){return t.rtoken(new RegExp("^"+a))},until:function(a){return function(c){var b=[],d=null;while(c.length){try{d=a.call(this,c)}catch(e){b.push(d[0]);c=d[1];continue}break}return[b,c]}},many:function(a){return function(c){var d=[],b=null;while(c.length){try{b=a.call(this,c)}catch(e){return[d,c]}d.push(b[0]);c=b[1]}return[d,c]}},optional:function(a){return function(c){var b=null;try{b=a.call(this,c)}catch(d){return[null,c]}return[b[0],b[1]]}},not:function(a){return function(c){try{a.call(this,c)}catch(b){return[null,c]}throw new l.Exception(c)}},ignore:function(a){return a?function(c){var b=null;b=a.call(this,c);return[null,b[1]]}:null},product:function(){var b=arguments[0],a=Array.prototype.slice.call(arguments,1),d=[];for(var c=0;c<b.length;c++){d.push(t.each(b[c],a))}return d},cache:function(a){var c={},b=null;return function(e){try{b=c[e]=(c[e]||a.call(this,e))}catch(d){b=c[e]=d}if(b instanceof l.Exception){throw b}else{return b}}},any:function(){var a=arguments;return function(b){var e=null;for(var c=0;c<a.length;c++){if(a[c]==null){continue}try{e=(a[c].call(this,b))}catch(d){e=null}if(e){return e}}throw new l.Exception(b)}},each:function(){var a=arguments;return function(b){var d=[],f=null;for(var c=0;c<a.length;c++){if(a[c]==null){continue}try{f=(a[c].call(this,b))}catch(e){throw new l.Exception(b)}d.push(f[0]);b=f[1]}return[d,b]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,b,a){b=b||t.rtoken(/^\s*/);a=a||null;if(c.length==1){return c[0]}return function(g){var f=null,e=null;var B=[];for(var h=0;h<c.length;h++){try{f=c[h].call(this,g)}catch(d){break}B.push(f[0]);try{e=b.call(this,f[1])}catch(z){e=null;break}g=e[1]}if(!f){throw new l.Exception(g)}if(e){throw new l.Exception(e[1])}if(a){try{f=a.call(this,f[1])}catch(A){throw new l.Exception(f[1])}}return[B,(f?f[1]:g)]}},between:function(b,a,c){c=c||b;var d=t.each(t.ignore(b),a,t.ignore(c));return function(f){var e=d.call(this,f);return[[e[0][0],r[0][2]],e[1]]}},list:function(c,b,a){b=b||t.rtoken(/^\s*/);a=a||null;return(c instanceof Array?t.each(t.product(c.slice(0,-1),t.ignore(b)),c.slice(-1),t.ignore(a)):t.each(t.many(t.each(c,t.ignore(b))),px,t.ignore(a)))},set:function(c,b,a){b=b||t.rtoken(/^\s*/);a=a||null;return function(M){var h=null,K=null,L=null,J=null,I=[[],M],d=false;for(var G=0;G<c.length;G++){L=null;K=null;h=null;d=(c.length==1);try{h=c[G].call(this,M)}catch(f){continue}J=[[h[0]],h[1]];if(h[1].length>0&&!d){try{L=b.call(this,h[1])}catch(e){d=true}}else{d=true}if(!d&&L[1].length===0){d=true}if(!d){var F=[];for(var H=0;H<c.length;H++){if(G!=H){F.push(c[H])}}K=t.set(F,b).call(this,L[1]);if(K[0].length>0){J[0]=J[0].concat(K[0]);J[1]=K[1]}}if(J[1].length<I[1].length){I=J}if(I[1].length===0){break}}if(I[0].length===0){return I}if(a){try{L=a.call(this,I[1])}catch(g){throw new l.Exception(I[1])}I[1]=L[1]}return I}},forward:function(b,a){return function(c){return b[a].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,a){return function(c){var d=a.call(this,c);if(d[0].length<b){throw new l.Exception(c)}return d}}};var m=function(a){return function(){var c=null,d=[];if(arguments.length>1){c=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){c=arguments[0]}}if(c){for(var e=0,b=c.shift();e<b.length;e++){c.unshift(b[e]);d.push(a.apply(null,c));c.shift();return d}}else{return a.apply(null,arguments)}}};var o="optional not ignore cache".split(/\s/);for(var s=0;s<o.length;s++){t[o[s]]=m(t[o[s]])}var p=function(a){return function(){if(arguments[0] instanceof Array){return a.apply(null,arguments[0])}else{return a.apply(null,arguments)}}};var q="each any all".split(/\s/);for(var k=0;k<q.length;k++){t[q[k]]=p(t[q[k]])}}());(function(){var v=Date,g=v.prototype,u=v.CultureInfo;var t=function(c){var b=[];for(var a=0;a<c.length;a++){if(c[a] instanceof Array){b=b.concat(t(c[a]))}else{if(c[a]){b.push(c[a])}}}return b};v.Grammar={};v.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");if(b.length){this.timezoneOffset=Number(b)}else{this.timezone=a.toLowerCase()}}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=(a.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=((a.length>2)?b:(b+(((b+2000)<u.twoDigitYearMax)?2000:1900)))}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(b){b=(b instanceof Array)?b:[b];for(var c=0;c<b.length;c++){if(b[c]){b[c].call(this)}}var d=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=d.getDate()}if(!this.year){this.year=d.getFullYear()}if(!this.month&&this.month!==0){this.month=d.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>v.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var a=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){a.set({timezone:this.timezone})}else{if(this.timezoneOffset){a.set({timezoneOffset:this.timezoneOffset})}}return a},finish:function(f){f=(f instanceof Array)?t(f):[f];if(f.length===0){return null}for(var c=0;c<f.length;c++){if(typeof f[c]=="function"){f[c].call(this)}}var h=v.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){h=new Date()}}var b=!!(this.days&&this.days!==null||this.orient||this.operator);var a,d,e;e=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){h.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;b=true}}if(!b&&this.weekday&&!this.day&&!this.days){var k=Date[this.weekday]();this.day=k.getDate();if(!this.month){this.month=k.getMonth()}this.year=k.getFullYear()}if(b&&this.weekday&&this.unit!="month"){this.unit="day";a=(v.getDayNumberFromName(this.weekday)-h.getDay());d=7;this.days=a?((a+(e*d))%d):(e*d)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){h.set({day:this.value*1});if(!b){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;b=true}if(b&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";a=(this.month-h.getMonth());d=12;this.months=a?((a+(e*d))%d):(e*d);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*e}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*e}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){var k=Date[this.weekday]();this.day=k.getDate();if(k.getMonth()!==h.getMonth()){this.month=k.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(b&&this.timezone&&this.day&&this.days){this.day=this.days}return(b)?h.add(this):h.set(this)}};var s=v.Parsing.Operators,w=v.Grammar,p=v.Translator,y;w.datePartDelimiter=s.rtoken(/^([\s\-\.\,\/\x27]+)/);w.timePartDelimiter=s.stoken(":");w.whiteSpace=s.rtoken(/^\s*/);w.generalDelimiter=s.rtoken(/^(([\s\,]|at|@|on)+)/);var z={};w.ctoken=function(b){var c=z[b];if(!c){var a=u.regexPatterns;var e=b.split(/\s+/),f=[];for(var d=0;d<e.length;d++){f.push(s.replace(s.rtoken(a[e[d]]),e[d]))}c=z[b]=s.any.apply(null,f)}return c};w.ctoken2=function(a){return s.rtoken(u.regexPatterns[a])};w.h=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),p.hour));w.hh=s.cache(s.process(s.rtoken(/^(0[0-9]|1[0-2])/),p.hour));w.H=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),p.hour));w.HH=s.cache(s.process(s.rtoken(/^([0-1][0-9]|2[0-3])/),p.hour));w.m=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.minute));w.mm=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.minute));w.s=s.cache(s.process(s.rtoken(/^([0-5][0-9]|[0-9])/),p.second));w.ss=s.cache(s.process(s.rtoken(/^[0-5][0-9]/),p.second));w.hms=s.cache(s.sequence([w.H,w.m,w.s],w.timePartDelimiter));w.t=s.cache(s.process(w.ctoken2("shortMeridian"),p.meridian));w.tt=s.cache(s.process(w.ctoken2("longMeridian"),p.meridian));w.z=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));w.zz=s.cache(s.process(s.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),p.timezone));w.zzz=s.cache(s.process(w.ctoken2("timezone"),p.timezone));w.timeSuffix=s.each(s.ignore(w.whiteSpace),s.set([w.tt,w.zzz]));w.time=s.each(s.optional(s.ignore(s.stoken("T"))),w.hms,w.timeSuffix);w.d=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1]|\d)/),s.optional(w.ctoken2("ordinalSuffix"))),p.day));w.dd=s.cache(s.process(s.each(s.rtoken(/^([0-2]\d|3[0-1])/),s.optional(w.ctoken2("ordinalSuffix"))),p.day));w.ddd=w.dddd=s.cache(s.process(w.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));w.M=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d|\d)/),p.month));w.MM=s.cache(s.process(s.rtoken(/^(1[0-2]|0\d)/),p.month));w.MMM=w.MMMM=s.cache(s.process(w.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),p.month));w.y=s.cache(s.process(s.rtoken(/^(\d\d?)/),p.year));w.yy=s.cache(s.process(s.rtoken(/^(\d\d)/),p.year));w.yyy=s.cache(s.process(s.rtoken(/^(\d\d?\d?\d?)/),p.year));w.yyyy=s.cache(s.process(s.rtoken(/^(\d\d\d\d)/),p.year));y=function(){return s.each(s.any.apply(null,arguments),s.not(w.ctoken2("timeContext")))};w.day=y(w.d,w.dd);w.month=y(w.M,w.MMM);w.year=y(w.yyyy,w.yy);w.orientation=s.process(w.ctoken("past future"),function(a){return function(){this.orient=a}});w.operator=s.process(w.ctoken("add subtract"),function(a){return function(){this.operator=a}});w.rday=s.process(w.ctoken("yesterday tomorrow today now"),p.rday);w.unit=s.process(w.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}});w.value=s.process(s.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});w.expression=s.set([w.rday,w.operator,w.value,w.unit,w.orientation,w.ddd,w.MMM]);y=function(){return s.set(arguments,w.datePartDelimiter)};w.mdy=y(w.ddd,w.month,w.day,w.year);w.ymd=y(w.ddd,w.year,w.month,w.day);w.dmy=y(w.ddd,w.day,w.month,w.year);w.date=function(a){return((w[u.dateElementOrder]||w.mdy).call(this,a))};w.format=s.process(s.many(s.any(s.process(s.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(w[a]){return w[a]}else{throw v.Parsing.Exception(a)}}),s.process(s.rtoken(/^[^dMyhHmstz]+/),function(a){return s.ignore(s.stoken(a))}))),function(a){return s.process(s.each.apply(null,a),p.finishExact)});var q={};var x=function(a){return q[a]=(q[a]||w.format(a)[0])};w.formats=function(c){if(c instanceof Array){var b=[];for(var a=0;a<c.length;a++){b.push(x(c[a]))}return s.any.apply(null,b)}else{return x(c)}};w._formats=w.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);w._start=s.process(s.set([w.date,w.time,w.expression],w.generalDelimiter,w.whiteSpace),p.finish);w.start=function(a){try{var c=w._formats.call({},a);if(c[1].length===0){return c}}catch(b){}return w._start.call({},a)};v._parse=v.parse;v.parse=function(a){var c=null;if(!a){return null}if(a instanceof Date){return a}try{c=v.Grammar.start.call({},a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(b){return null}return((c[1].length===0)?c[0]:null)};v.getParseFunction=function(b){var a=v.Grammar.formats(b);return function(e){var d=null;try{d=a.call({},e)}catch(c){return null}return((d[1].length===0)?d[0]:null)}};v.parseExact=function(a,b){return v.getParseFunction(b)(a)}}());(function(){var l=Date,f=l.prototype,k=l.CultureInfo,g=[],h=function(a,b){if(!b){b=2}return("000"+a).slice(b*-1)};l.normalizeFormat=function(a){g=[];var b=new Date().$format(a);return g.join("")};l.strftime=function(a,b){return new Date(b*1000).$format(a)};l.strtotime=function(b){var a=l.parse(b);a.addMinutes(a.getTimezoneOffset()*-1);return Math.round(l.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())/1000)};f.$format=function(b){var d=this,a,c=function(e){g.push(e);return d.toString(e)};return b?b.replace(/(%|\\)?.|%%/g,function(e){if(e.charAt(0)==="\\"||e.substring(0,2)==="%%"){return e.replace("\\","").replace("%%","%")}switch(e){case"d":case"%d":return c("dd");case"D":case"%a":return c("ddd");case"j":case"%e":return c("d");case"l":case"%A":return c("dddd");case"N":case"%u":return d.getDay()+1;case"S":return c("S");case"w":case"%w":return d.getDay();case"z":return d.getOrdinalNumber();case"%j":return h(d.getOrdinalNumber(),3);case"%U":var m=d.clone().set({month:0,day:1}).addDays(-1).moveToDayOfWeek(0),s=d.clone().addDays(1).moveToDayOfWeek(0,-1);return(s<m)?"00":h((s.getOrdinalNumber()-m.getOrdinalNumber())/7+1);case"W":case"%V":return d.getISOWeek();case"%W":return h(d.getWeek());case"F":case"%B":return c("MMMM");case"m":case"%m":return c("MM");case"M":case"%b":case"%h":return c("MMM");case"n":return c("M");case"t":return l.getDaysInMonth(d.getFullYear(),d.getMonth());case"L":return(l.isLeapYear(d.getFullYear()))?1:0;case"o":case"%G":return d.setWeek(d.getISOWeek()).toString("yyyy");case"%g":return d.$format("%G").slice(-2);case"Y":case"%Y":return c("yyyy");case"y":case"%y":return c("yy");case"a":case"%p":return c("tt").toLowerCase();case"A":return c("tt").toUpperCase();case"g":case"%I":return c("h");case"G":return c("H");case"h":return c("hh");case"H":case"%H":return c("HH");case"i":case"%M":return c("mm");case"s":case"%S":return c("ss");case"u":return h(d.getMilliseconds(),3);case"I":return(d.isDaylightSavingTime())?1:0;case"O":return d.getUTCOffset();case"P":a=d.getUTCOffset();return a.substring(0,a.length-2)+":"+a.substring(a.length-2);case"e":case"T":case"%z":case"%Z":return d.getTimezone();case"Z":return d.getTimezoneOffset()*-60;case"B":var t=new Date();return Math.floor(((t.getHours()*3600)+(t.getMinutes()*60)+t.getSeconds()+(t.getTimezoneOffset()+60)*60)/86.4);case"c":return d.toISOString().replace(/\"/g,"");case"U":return l.strtotime("now");case"%c":return c("d")+" "+c("t");case"%C":return Math.floor(d.getFullYear()/100+1);case"%D":return c("MM/dd/yy");case"%n":return"\\n";case"%t":return"\\t";case"%r":return c("hh:mm tt");case"%R":return c("H:mm");case"%T":return c("H:mm:ss");case"%x":return c("d");case"%X":return c("t");default:g.push(e);return e}}):this._toString()};if(!f.format){f.format=f.$format}}());var QRCode=function(){var u=function(p,o){var a=236;var b=17;var T=p;var R=z[o];var h=null;var g=0;var t=null;var P=new Array();var e={};var m=function(K,L){g=T*4+17;h=function(M){var O=new Array(M);for(var N=0;N<M;N+=1){O[N]=new Array(M);for(var V=0;V<M;V+=1){O[N][V]=null}}return O}(g);Q(0,0);Q(g-7,0);Q(0,g-7);s();q();c(K,L);if(T>=7){S(K)}if(t==null){t=k(T,R,P)}l(t,L)};var Q=function(L,N){for(var M=-1;M<=7;M+=1){if(L+M<=-1||g<=L+M){continue}for(var K=-1;K<=7;K+=1){if(N+K<=-1||g<=N+K){continue}if((0<=M&&M<=6&&(K==0||K==6))||(0<=K&&K<=6&&(M==0||M==6))||(2<=M&&M<=4&&2<=K&&K<=4)){h[L+M][N+K]=true}else{h[L+M][N+K]=false}}}};var f=function(){var K=0;var L=0;for(var M=0;M<8;M+=1){m(true,M);var N=A.getLostPoint(e);if(M==0||K>N){K=N;L=M}}return L};var q=function(){for(var L=8;L<g-8;L+=1){if(h[L][6]!=null){continue}h[L][6]=(L%2==0)}for(var K=8;K<g-8;K+=1){if(h[6][K]!=null){continue}h[6][K]=(K%2==0)}};var s=function(){var K=A.getPatternPosition(T);for(var O=0;O<K.length;O+=1){for(var W=0;W<K.length;W+=1){var M=K[O];var X=K[W];if(h[M][X]!=null){continue}for(var N=-2;N<=2;N+=1){for(var L=-2;L<=2;L+=1){if(N==-2||N==2||L==-2||L==2||(N==0&&L==0)){h[M+N][X+L]=true}else{h[M+N][X+L]=false}}}}}};var S=function(K){var L=A.getBCHTypeNumber(T);for(var M=0;M<18;M+=1){var N=(!K&&((L>>M)&1)==1);h[Math.floor(M/3)][M%3+g-8-3]=N}for(var M=0;M<18;M+=1){var N=(!K&&((L>>M)&1)==1);h[M%3+g-8-3][Math.floor(M/3)]=N}};var c=function(K,L){var M=(R<<3)|L;var N=A.getBCHTypeInfo(M);for(var O=0;O<15;O+=1){var V=(!K&&((N>>O)&1)==1);if(O<6){h[O][8]=V}else{if(O<8){h[O+1][8]=V}else{h[g-15+O][8]=V}}}for(var O=0;O<15;O+=1){var V=(!K&&((N>>O)&1)==1);if(O<8){h[8][g-O-1]=V}else{if(O<9){h[8][15-O-1+1]=V}else{h[8][15-O-1]=V}}}h[g-8][8]=(!K)};var l=function(aa,ae){var ac=-1;var K=g-1;var ab=7;var af=0;var M=A.getMaskFunction(ae);for(var ad=g-1;ad>0;ad-=2){if(ad==6){ad-=1}while(true){for(var N=0;N<2;N+=1){if(h[K][ad-N]==null){var O=false;if(af<aa.length){O=(((aa[af]>>>ab)&1)==1)}var L=M(K,ad-N);if(L){O=!O}h[K][ad-N]=O;ab-=1;if(ab==-1){af+=1;ab=7}}}K+=ac;if(K<0||g<=K){K-=ac;ac=-ac;break}}}};var d=function(K,ar){var ak=0;var ao=0;var aq=0;var al=new Array(ar.length);var ah=new Array(ar.length);for(var M=0;M<ar.length;M+=1){var L=ar[M].dataCount;var am=ar[M].totalCount-L;ao=Math.max(ao,L);aq=Math.max(aq,am);al[M]=new Array(L);for(var au=0;au<al[M].length;au+=1){al[M][au]=255&K.getBuffer()[au+ak]}ak+=L;var O=A.getErrorCorrectPolynomial(am);var ap=D(al[M],O.getLength()-1);var aj=ap.mod(O);ah[M]=new Array(O.getLength()-1);for(var au=0;au<ah[M].length;au+=1){var N=au+aj.getLength()-ah[M].length;ah[M][au]=(N>=0)?aj.get(N):0}}var at=0;for(var au=0;au<ar.length;au+=1){at+=ar[au].totalCount}var an=new Array(at);var ai=0;for(var au=0;au<ao;au+=1){for(var M=0;M<ar.length;M+=1){if(au<al[M].length){an[ai]=al[M][au];ai+=1}}}for(var au=0;au<aq;au+=1){for(var M=0;M<ar.length;M+=1){if(au<ah[M].length){an[ai]=ah[M][au];ai+=1}}}return an};var k=function(K,L,O){var Y=B.getRSBlocks(K,L);var Z=C();for(var X=0;X<O.length;X+=1){var M=O[X];Z.put(M.getMode(),4);Z.put(M.getLength(),A.getLengthInBits(M.getMode(),K));M.write(Z)}var N=0;for(var X=0;X<Y.length;X+=1){N+=Y[X].dataCount}if(Z.getLengthInBits()>N*8){throw new Error("code length overflow. ("+Z.getLengthInBits()+">"+N*8+")")}if(Z.getLengthInBits()+4<=N*8){Z.put(0,4)}while(Z.getLengthInBits()%8!=0){Z.putBit(false)}while(true){if(Z.getLengthInBits()>=N*8){break}Z.put(a,8);if(Z.getLengthInBits()>=N*8){break}Z.put(b,8)}return d(Z,Y)};e.addData=function(K){var L=v(K);P.push(L);t=null};e.isDark=function(K,L){if(K<0||g<=K||L<0||g<=L){throw new Error(K+","+L)}return h[K][L]};e.getModuleCount=function(){return g};e.make=function(){m(false,f())};e.createTableTag=function(K,M){K=K||2;M=(typeof M=="undefined")?K*4:M;var O="";O+='<table style="';O+=" border-width: 0px; border-style: none;";O+=" border-collapse: collapse;";O+=" padding: 0px; margin: "+M+"px;";O+='">';O+="<tbody>";for(var N=0;N<e.getModuleCount();N+=1){O+="<tr>";for(var L=0;L<e.getModuleCount();L+=1){O+='<td style="';O+=" border-width: 0px; border-style: none;";O+=" border-collapse: collapse;";O+=" padding: 0px; margin: 0px;";O+=" width: "+K+"px;";O+=" height: "+K+"px;";O+=" background-color: ";O+=e.isDark(N,L)?"#000000":"#ffffff";O+=";";O+='"/>'}O+="</tr>"}O+="</tbody>";O+="</table>";return O};e.createImgTag=function(K,L){K=K||2;L=(typeof L=="undefined")?K*4:L;var M=e.getModuleCount()*K+L*2;var N=L;var O=M-L;return E(M,M,function(aa,ab){if(N<=aa&&aa<O&&N<=ab&&ab<O){var Y=Math.floor((aa-N)/K);var Z=Math.floor((ab-N)/K);return e.isDark(Z,Y)?0:1}else{return 1}})};e.createBase64=function(K,L){K=K||2;L=(typeof L=="undefined")?K*4:L;var M=e.getModuleCount()*K+L*2;var N=L;var O=M-L;return[J(M,M,function(aa,ab){if(N<=aa&&aa<O&&N<=ab&&ab<O){var Y=Math.floor((aa-N)/K);var Z=Math.floor((ab-N)/K);return e.isDark(Z,Y)?0:1}else{return 1}}),M]};return e};u.stringToBytes=function(b){var d=new Array();for(var c=0;c<b.length;c+=1){var a=b.charCodeAt(c);d.push(a&255)}return d};u.createStringToBytes=function(a,b){var c=function(){var m=H(a);var l=function(){var s=m.read();if(s==-1){throw new Error()}return s};var h=0;var g={};while(true){var p=m.read();if(p==-1){break}var q=l();var e=l();var f=l();var k=String.fromCharCode((p<<8)|q);var o=(e<<8)|f;g[k]=o;h+=1}if(h!=b){throw new Error(h+" != "+b)}return g}();var d="?".charCodeAt(0);return function(k){var g=new Array();for(var e=0;e<k.length;e+=1){var f=k.charCodeAt(e);if(f<128){g.push(f)}else{var h=c[k.charAt(e)];if(typeof h=="number"){if((h&255)==h){g.push(h)}else{g.push(h>>>8);g.push(h&255)}}else{g.push(d)}}}return g}};var y={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var z={L:1,M:0,Q:3,H:2};var F={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var A=function(){var a=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];var d=(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0);var e=(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0);var b=(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1);var f={};var c=function(g){var h=0;while(g!=0){h+=1;g>>>=1}return h};f.getBCHTypeInfo=function(g){var h=g<<10;while(c(h)-c(d)>=0){h^=(d<<(c(h)-c(d)))}return((g<<10)|h)^b};f.getBCHTypeNumber=function(g){var h=g<<12;while(c(h)-c(e)>=0){h^=(e<<(c(h)-c(e)))}return(g<<12)|h};f.getPatternPosition=function(g){return a[g-1]};f.getMaskFunction=function(g){switch(g){case F.PATTERN000:return function(h,k){return(h+k)%2==0};case F.PATTERN001:return function(h,k){return h%2==0};case F.PATTERN010:return function(h,k){return k%3==0};case F.PATTERN011:return function(h,k){return(h+k)%3==0};case F.PATTERN100:return function(h,k){return(Math.floor(h/2)+Math.floor(k/3))%2==0};case F.PATTERN101:return function(h,k){return(h*k)%2+(h*k)%3==0};case F.PATTERN110:return function(h,k){return((h*k)%2+(h*k)%3)%2==0};case F.PATTERN111:return function(h,k){return((h*k)%3+(h+k)%2)%2==0};default:throw new Error("bad maskPattern:"+g)}};f.getErrorCorrectPolynomial=function(k){var g=D([1],0);for(var h=0;h<k;h+=1){g=g.multiply(D([1,I.gexp(h)],0))}return g};f.getLengthInBits=function(h,g){if(1<=g&&g<10){switch(h){case y.MODE_NUMBER:return 10;case y.MODE_ALPHA_NUM:return 9;case y.MODE_8BIT_BYTE:return 8;case y.MODE_KANJI:return 8;default:throw new Error("mode:"+h)}}else{if(g<27){switch(h){case y.MODE_NUMBER:return 12;case y.MODE_ALPHA_NUM:return 11;case y.MODE_8BIT_BYTE:return 16;case y.MODE_KANJI:return 10;default:throw new Error("mode:"+h)}}else{if(g<41){switch(h){case y.MODE_NUMBER:return 14;case y.MODE_ALPHA_NUM:return 13;case y.MODE_8BIT_BYTE:return 16;case y.MODE_KANJI:return 12;default:throw new Error("mode:"+h)}}else{throw new Error("type:"+g)}}}};f.getLostPoint=function(p){var h=p.getModuleCount();var g=0;for(var m=0;m<h;m+=1){for(var k=0;k<h;k+=1){var q=0;var s=p.isDark(m,k);for(var l=-1;l<=1;l+=1){if(m+l<0||h<=m+l){continue}for(var t=-1;t<=1;t+=1){if(k+t<0||h<=k+t){continue}if(l==0&&t==0){continue}if(s==p.isDark(m+l,k+t)){q+=1}}}if(q>5){g+=(3+q-5)}}}for(var m=0;m<h-1;m+=1){for(var k=0;k<h-1;k+=1){var N=0;if(p.isDark(m,k)){N+=1}if(p.isDark(m+1,k)){N+=1}if(p.isDark(m,k+1)){N+=1}if(p.isDark(m+1,k+1)){N+=1}if(N==0||N==4){g+=3}}}for(var m=0;m<h;m+=1){for(var k=0;k<h-6;k+=1){if(p.isDark(m,k)&&!p.isDark(m,k+1)&&p.isDark(m,k+2)&&p.isDark(m,k+3)&&p.isDark(m,k+4)&&!p.isDark(m,k+5)&&p.isDark(m,k+6)){g+=40}}}for(var k=0;k<h;k+=1){for(var m=0;m<h-6;m+=1){if(p.isDark(m,k)&&!p.isDark(m+1,k)&&p.isDark(m+2,k)&&p.isDark(m+3,k)&&p.isDark(m+4,k)&&!p.isDark(m+5,k)&&p.isDark(m+6,k)){g+=40}}}var o=0;for(var k=0;k<h;k+=1){for(var m=0;m<h;m+=1){if(p.isDark(m,k)){o+=1}}}var M=Math.abs(100*o/h/h-50)/5;g+=M*10;return g};return f}();var I=function(){var d=new Array(256);var b=new Array(256);for(var c=0;c<8;c+=1){d[c]=1<<c}for(var c=8;c<256;c+=1){d[c]=d[c-4]^d[c-5]^d[c-6]^d[c-8]}for(var c=0;c<255;c+=1){b[d[c]]=c}var a={};a.glog=function(e){if(e<1){throw new Error("glog("+e+")")}return b[e]};a.gexp=function(e){while(e<0){e+=255}while(e>=256){e-=255}return d[e]};return a}();function D(c,d){if(typeof c.length=="undefined"){throw new Error(c.length+"/"+d)}var b=function(){var e=0;while(e<c.length&&c[e]==0){e+=1}var f=new Array(c.length-e+d);for(var g=0;g<c.length-e;g+=1){f[g]=c[g+e]}return f}();var a={};a.get=function(e){return b[e]};a.getLength=function(){return b.length};a.multiply=function(h){var f=new Array(a.getLength()+h.getLength()-1);for(var e=0;e<a.getLength();e+=1){for(var g=0;g<h.getLength();g+=1){f[e+g]^=I.gexp(I.glog(a.get(e))+I.glog(h.get(g)))}}return D(f,0)};a.mod=function(h){if(a.getLength()-h.getLength()<0){return a}var e=I.glog(a.get(0))-I.glog(h.get(0));var g=new Array(a.getLength());for(var f=0;f<a.getLength();f+=1){g[f]=a.get(f)}for(var f=0;f<h.getLength();f+=1){g[f]^=I.gexp(I.glog(h.get(f))+e)}return D(g,0).mod(h)};return a}var B=function(){var c=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16]];var d=function(g,f){var e={};e.totalCount=g;e.dataCount=f;return e};var a={};var b=function(e,f){switch(f){case z.L:return c[(e-1)*4+0];case z.M:return c[(e-1)*4+1];case z.Q:return c[(e-1)*4+2];case z.H:return c[(e-1)*4+3];default:return undefined}};a.getRSBlocks=function(h,o){var k=b(h,o);if(typeof k=="undefined"){throw new Error("bad rs block @ typeNumber:"+h+"/errorCorrectLevel:"+o)}var l=k.length/3;var q=new Array();for(var f=0;f<l;f+=1){var e=k[f*3+0];var m=k[f*3+1];var p=k[f*3+2];for(var g=0;g<e;g+=1){q.push(d(m,p))}}return q};return a}();var C=function(){var c=new Array();var a=0;var b={};b.getBuffer=function(){return c};b.get=function(d){var e=Math.floor(d/8);return((c[e]>>>(7-d%8))&1)==1};b.put=function(d,e){for(var f=0;f<e;f+=1){b.putBit(((d>>>(e-f-1))&1)==1)}};b.getLengthInBits=function(){return a};b.putBit=function(e){var d=Math.floor(a/8);if(c.length<=d){c.push(0)}if(e){c[d]|=(128>>>(a%8))}a+=1};return b};var v=function(a){var b=y.MODE_8BIT_BYTE;var d=a;var c=u.stringToBytes(a);var e={};e.getMode=function(){return b};e.getLength=function(f){return c.length};e.write=function(g){for(var f=0;f<c.length;f+=1){g.put(c[f],8)}};return e};var x=function(){var b=new Array();var a={};a.writeByte=function(c){b.push(c&255)};a.writeShort=function(c){a.writeByte(c);a.writeByte(c>>>8)};a.writeBytes=function(c,e,d){e=e||0;d=d||c.length;for(var f=0;f<d;f+=1){a.writeByte(c[f+e])}};a.writeString=function(c){for(var d=0;d<c.length;d+=1){a.writeByte(c.charCodeAt(d))}};a.toByteArray=function(){return b};a.toString=function(){var c="";c+="[";for(var d=0;d<b.length;d+=1){if(d>0){c+=","}c+=b[d]}c+="]";return c};return a};var G=function(){var d=0;var g=0;var b=0;var e="";var f={};var a=function(h){e+=String.fromCharCode(c(h&63))};var c=function(h){if(h<0){}else{if(h<26){return 65+h}else{if(h<52){return 97+(h-26)}else{if(h<62){return 48+(h-52)}else{if(h==62){return 43}else{if(h==63){return 47}}}}}}throw new Error("n:"+h)};f.writeByte=function(h){d=(d<<8)|(h&255);g+=8;b+=1;while(g>=6){a(d>>>(g-6));g-=6}};f.flush=function(){if(g>0){a(d<<(6-g));d=0;g=0}if(b%3!=0){var h=3-b%3;for(var k=0;k<h;k+=1){e+="="}}};f.toString=function(){return e};return f};var H=function(g){var b=g;var e=0;var d=0;var c=0;var f={};f.read=function(){while(c<8){if(e>=b.length){if(c==0){return -1}throw new Error("unexpected end of file./"+c)}var h=b.charAt(e);e+=1;if(h=="="){c=0;return -1}else{if(h.match(/^\s$/)){continue}}d=(d<<6)|a(h.charCodeAt(0));c+=6}var k=(d>>>(c-8))&255;c-=8;return k};var a=function(h){if(65<=h&&h<=90){return h-65}else{if(97<=h&&h<=122){return h-97+26}else{if(48<=h&&h<=57){return h-48+52}else{if(h==43){return 62}else{if(h==47){return 63}else{throw new Error("c:"+h)}}}}}};return f};var w=function(k,b){var f=k;var e=b;var h=new Array(k*b);var d={};d.setPixel=function(o,l,m){h[l*f+o]=m};d.write=function(o){o.writeString("GIF87a");o.writeShort(f);o.writeShort(e);o.writeByte(128);o.writeByte(0);o.writeByte(0);o.writeByte(0);o.writeByte(0);o.writeByte(0);o.writeByte(255);o.writeByte(255);o.writeByte(255);o.writeString(",");o.writeShort(0);o.writeShort(0);o.writeShort(f);o.writeShort(e);o.writeByte(0);var m=2;var p=g(m);o.writeByte(m);var l=0;while(p.length-l>255){o.writeByte(255);o.writeBytes(p,l,255);l+=255}o.writeByte(p.length-l);o.writeBytes(p,l,p.length-l);o.writeByte(0);o.writeString(";")};var c=function(p){var o=p;var m=0;var q=0;var l={};l.write=function(s,t){if((s>>>t)!=0){throw new Error("length over")}while(m+t>=8){o.writeByte(255&((s<<m)|q));t-=(8-m);s>>>=(8-m);q=0;m=0}q=(s<<m)|q;m=m+t};l.flush=function(){if(m>0){o.writeByte(q)}};return l};var g=function(R){var t=1<<R;var P=(1<<R)+1;var q=R+1;var o=a();for(var O=0;O<t;O+=1){o.add(String.fromCharCode(O))}o.add(String.fromCharCode(t));o.add(String.fromCharCode(P));var Q=x();var l=c(Q);l.write(t,q);var p=0;var m=String.fromCharCode(h[p]);p+=1;while(p<h.length){var s=String.fromCharCode(h[p]);p+=1;if(o.contains(m+s)){m=m+s}else{l.write(o.indexOf(m),q);if(o.size()<4095){if(o.size()==(1<<q)){q+=1}o.add(m+s)}m=s}}l.write(o.indexOf(m),q);l.write(P,q);l.flush();return Q.toByteArray()};var a=function(){var m={};var o=0;var l={};l.add=function(p){if(l.contains(p)){throw new Error("dup key:"+p)}m[p]=o;o+=1};l.size=function(){return o};l.indexOf=function(p){return m[p]};l.contains=function(p){return typeof m[p]!="undefined"};return l};return d};var J=function(k,l,c){var e=w(k,l);for(var b=0;b<l;b+=1){for(var m=0;m<k;m+=1){e.setPixel(m,b,c(m,b))}}var a=x();e.write(a);var d=G();var h=a.toByteArray();for(var f=0;f<h.length;f+=1){d.writeByte(h[f])}d.flush();var g="";g+="data:image/gif;base64,";g+=d;return g};var E=function(a,d,e,f){var c=J(a,d,e);var b="";b+="<img";b+='\u0020src="';b+=c;b+='"';b+='\u0020width="';b+=a;b+='"';b+='\u0020height="';b+=d;b+='"';if(f){b+='\u0020alt="';b+=f;b+='"'}b+="/>";return b};return u}();var FastBase64={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var b=0;b<4096;b++){this.encLookup[b]=this.chars[b>>6]+this.chars[b&63]}},Encode:function(m){var k=m.length;var l="";var p=0;while(k>2){n=(m[p]<<16)|(m[p+1]<<8)|m[p+2];l+=this.encLookup[n>>12]+this.encLookup[n&4095];k-=3;p+=3}if(k>0){var o=(m[p]&252)>>2;var q=(m[p]&3)<<4;if(k>1){q|=(m[++p]&240)>>4}l+=this.chars[o];l+=this.chars[q];if(k==2){var h=(m[p++]&15)<<2;h|=(m[p]&192)>>6;l+=this.chars[h]}if(k==1){l+="="}l+="="}return l}};FastBase64.Init();var RIFFWAVE=function(g){g=g||{};this.data=[];this.wav=[];this.dataURI="";this.header=Ext.apply({chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8000,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},g.header);function e(a){return[a&255,(a>>8)&255,(a>>16)&255,(a>>24)&255]}function f(a){return[a&255,(a>>8)&255]}function h(a){var b=[];var d=0;var l=a.length;for(var c=0;c<l;c++){b[d++]=a[c]&255;b[d++]=(a[c]>>8)&255}return b}this.Make=function(a){if((g.data instanceof Array)||((typeof(Int16Array)!="undefined")&&(g.data instanceof Int16Array))){this.data=a;this.header.blockAlign=(this.header.numChannels*this.header.bitsPerSample)>>3;this.header.byteRate=this.header.blockAlign*this.header.sampleRate;this.header.subChunk2Size=this.data.length*(this.header.bitsPerSample>>3);this.header.chunkSize=36+this.header.subChunk2Size}console.debug("RIFFWAVE - "+Ext.encode(this.header))};this.MakeData=function(a){this.wav=this.header.chunkId.concat(e(this.header.chunkSize),this.header.format,this.header.subChunk1Id,e(this.header.subChunk1Size),f(this.header.audioFormat),f(this.header.numChannels),e(this.header.sampleRate),e(this.header.byteRate),f(this.header.blockAlign),f(this.header.bitsPerSample),this.header.subChunk2Id,e(this.header.subChunk2Size),(this.header.bitsPerSample==16)?h(this.data):this.data);this.dataURI="data:audio/wav;base64,"+FastBase64.Encode(this.wav)};if((g.data instanceof Array)||((typeof(Int16Array)!="undefined")&&(g.data instanceof Int16Array))){this.Make(g.data);if(!g.headerOnly){this.MakeData(g.data)}}};__initFb__=function(f,e){var d=f;Ext.define(e+".fb",{mixins:["Ext.mixin.Observable"],singleton:true,appId:null,fbTimeout:2*60*1000,titleMsg:"Facebook Connect",fbScope:["email","user_birthday","publish_stream","read_friendlists","publish_actions"],fbConnectErrorMsg:"Cannot retrive Facebook account information!",fbConnectRequestMsg:"By connecting to Facebook, you will receive additional Reward Pts everytime we update your KICKBAK activity to your Facebook account!",fbConnectReconnectMsg:"By connecting to Facebook, you will receive additional Reward Pts everytime we update your KICKBAK activity to your Facebook account!",connectingToFBMsg:function(){return("Connecting to Facebook ..."+d.constants.addCRLF()+"(Tap to Close)")},loggingOutOfFBMsg:"Logging out of Facebook ...",fbConnectFailMsg:"Error Connecting to Facebook.",fbPermissionFailMsg:"Failed to get the required access permission.",friendsRetrieveErrorMsg:"You cannot retrieve your Friends List from Facebook. Login and Try Again.",initialize:function(){var a=this,b=d.db.getLocalDB();a.appId=(d.constants.debugMode())?477780595628080:197968780267830;console.log("FacebookConnect::initialize");if(!d.fn.isNative()&&b.fbLoginInProgress){a.cb=Ext.decode(b.fbLoginInProgress);a.setLoadMask();a.detectAccessToken(location.href)}},currentLocation:function(){return(((d.constants.debugMode())?d.constants.serverHost():"http://m.getkickbak.com")+"/")},redirectUrl:function(){var a=Ext.Object.toQueryString({redirect_uri:this.currentLocation(),client_id:this.appId,state:appName,response_type:"token",scope:this.fbScope.toString()});if(!Ext.os.is("Android")&&!Ext.os.is("iOS")&&/Windows|Linux|MacOS/.test(Ext.os.name)){return"https://www.facebook.com/dialog/oauth?"+a}else{return"https://m.facebook.com/dialog/oauth?"+a}},createFbResponse:function(c){var b=c.birthday.split("/");b=b[2]+"-"+b[0]+"-"+b[1];var a={name:c.name,email:c.email,facebook_id:c.id,facebook_uid:c.username,gender:(c.gender=="male")?"m":"f",birthday:b,photoURL:this.getFbProfilePhoto(c.id),accessToken:d.db.getLocalDB()["access_token"]};console.debug("FbResponse - ["+Ext.encode(a)+"]");return a},facebook_onLogin:function(a,c,b){var m=this,p=true,q=d.db.getLocalDB();var o=(q.currFbId>0)&&(parseInt(q.fbExpiresIn)>0);console.debug("connected = "+o+"\nfbExpiresIn = "+parseInt(q.fbExpiresIn)+"\ntime-30min = "+((new Date().addMinutes(-30)).getTime())+"\n");if(o){var p=(!o||(o&&(parseInt(q.fbExpiresIn)<=(new Date().addMinutes(-30)).getTime())));if(!b||(b&&!p)){console.debug("Facebook already connected. Bypass relogin process");m.fireEvent("connected",q.fbResponse,null);return}}m.cb={supress:a,messsage:c,viewName:_application.getController("client.Viewport").getViewport().getActiveItem().xtype,iter:0};m.setLoadMask();d.db.setLocalDBAttrib("fbLoginInProgress",Ext.encode(m.cb));m.inAppBrowserCallback()},setLoadMask:function(){var a=this;Ext.Viewport.setMasked(null);Ext.Viewport.setMasked({xtype:"loadmask",message:a.connectingToFBMsg(),listeners:{tap:function(){d.db.removeLocalDBAttrib("fbLoginInProgress");a.facebook_loginCallback(null);Ext.Viewport.setMasked(null)}}})},detectAccessToken:function(k){var c=this,l=d.db.getLocalDB();if(k.indexOf("access_token=")>=1){var b=Ext.Object.fromQueryString(k.split("#")[1]);if(b.state==appName){c.code=l.access_token=b.access_token;l.fbExpiresIn=(new Date(Date.now()+Number(b.expires_in))).getTime();d.db.setLocalDB(l);if(!d.fn.isNative()){var a=function(h,g){d.db.removeLocalDBAttrib("fbLoginInProgress");d.fb.un("connected",a);d.fb.un("unauthorized",a);d.fb.un("exception",a);var o=c.cb||{};console.log("Originated from - "+o.viewName);switch(o.viewName){case"createaccountpageview":_application.getController("client.MainPage").redirectTo("createAccount");break;case"signinpageview":_application.getController("client.MainPage").redirectTo("signin");break;case"clientsettingspageview":_application.getController("client.Settings").redirectTo("settings");break;case"loginpageview":_application.getController("client.MainPage").onFacebookLoginCallback(h,g);break;default:_application.getController("client.Viewport").redirectTo("signup");break}};d.fb.on("connected",a);d.fb.on("unauthorized",a);d.fb.on("exception",a);c.accessTokenCallback()}}else{console.error("CSRF Forgery detected! Ignore Request")}}},accessTokenCallback:function(){var a=this;Ext.Ajax.request({async:true,disableCaching:false,url:"https://graph.facebook.com/me?access_token="+d.db.getLocalDB()["access_token"],callback:function(m,b,p){if(b||(p.status==200)){try{var o=Ext.decode(p.responseText);o.status="connected";a.facebook_loginCallback(o)}catch(c){}}else{console.debug("Error Logging into Facebook\nReturn "+Ext.encode(p));a.facebook_loginCallback(null)}}});delete a.code},inAppBrowserCallback:function(){var a=this;if(d.fn.isNative()){var b=window.open(a.redirectUrl(),"_blank","location=no,toolbar=no,closebuttoncaption=Cancel");a.fbLoginTimeout=setTimeout(function(){a.fireEvent("loginStatus");a.fireEvent("exception",{type:"timeout",msg:"The request to Facebook timed out."},null);d.db.removeLocalDBAttrib("fbLoginInProgress");b.close();a.facebook_loginCallback(null)},a.fbTimeout);b.addEventListener("loadstart",function(c){if(c.url.match(a.currentLocation())){a.detectAccessToken(c.url);Ext.defer(b.close,200)}});b.addEventListener("loadstop",function(c){});b.addEventListener("exit",function(c){clearTimeout(a.fbLoginTimeout);delete a.fbLoginTimeout;d.db.removeLocalDBAttrib("fbLoginInProgress");if(a.code){Ext.defer(function(){a.accessTokenCallback()},100)}else{a.facebook_loginCallback(null)}})}else{Ext.defer(function(){location.href=a.redirectUrl()},1*1000)}},facebook_loginCallback:function(c){var b=this,a=null;if(!c||c.cancelled||c.error||(c.status!="connected")){console.debug("FacebookConnect.login:failedWithError:"+((c)?c.message:"None"));if(!b.cb||!b.cb.supress){Ext.device.Notification.show({title:b.titleMsg,message:b.fbConnectErrorMsg,buttons:(d.fn.isNative()?["Try Again","Continue"]:["Dismiss"]),callback:function(g){if(g.toLowerCase()=="try again"){Ext.defer(function(){b.facebook_onLogin(false,b.cb.message)},1,b);delete b.cb}else{Ext.Viewport.setMasked(null);delete b.cb;b.fireEvent("unauthorized",null,null)}}})}else{if(c&&c.cancelled){Ext.Viewport.setMasked(null);delete b.cb;b.fireEvent("exception",{type:"timeout",msg:"The request to Facebook cancelled."},null)}}}else{console.log("Retrieving Facebook profile information ...");var h=c;Ext.defer(function(){if(!h.error||(h.id&&(h.id>0))){var l=d.db.getLocalDB(),g=h.id;console.debug("Session ID["+g+"]");l.currFbId=g;l.fbAccountId=h.email;a=l.fbResponse=b.createFbResponse(h);d.db.setLocalDB(l);l=d.db.getLocalDB();console.debug("You`ve logged into Facebook! \nEmail("+a.email+")\nauth_code("+l.auth_code+")\nID("+g+")\n");b._fb_connect();if(l.auth_code){delete b.cb;console.log("Updating Facebook Login Info ...");Account.setUpdateFbLoginUrl();Account.load(0,{jsonData:{},params:{user:Ext.encode(l.fbResponse)},callback:function(o,k){if(k.wasSuccessful()){Ext.Viewport.setMasked(null);d.db.setLocalDBAttrib("enableFB",true)}b.fireEvent("connected",a,k)}})}else{d.db.setLocalDBAttrib("enableFB",true);b.fireEvent("connected",a,null);delete b.cb}}else{Ext.Viewport.setMasked(null);b.fireEvent("unauthorized",null,null);b.facebook_onLogout(null,false);delete b.cb}},0.5*1000,b)}delete b.fbLoginTimeout},facebook_onLogout:function(m,c){var b=this;m=m||Ext.emptyFn;console.debug("facebook_onLogout");try{var l=d.db.getLocalDB();l.currFbId=0;delete l.fbAccountId;delete l.fbResponse;delete l.fbAuthCode;delete l.fbExpiresIn;d.db.setLocalDB(l);m()}catch(a){m()}},getFbProfilePhoto:function(a){return"http://graph.facebook.com/"+a+"/picture?type=square"},createFBReminderMsg:function(){var b=this,c=_application.getController("client.Viewport");if(!b.actions){var a=8,h=Genesis.fn.calcPx(a,1.1);b.actions=(Ext.create("Ext.Sheet",{bottom:0,left:0,top:0,right:0,padding:"0.8 0.7 0 0.7",hideOnMaskTap:false,defaultUnit:"em",layout:{type:"vbox",pack:"middle"},defaults:{xtype:"container",defaultUnit:"em"},items:[{width:"100%",flex:1,style:"text-align:center;color:white;font-size:1.1em;",html:b.fbConnectRequestMsg+'<br/><img width="'+h+'" style="position: absolute;top:50%;left:50%;margin-top:'+Genesis.fn.addUnit(-1*(a/2-1.5),"em")+";margin-left:"+Genesis.fn.addUnit(-1*(a/2),"em")+';" src="resources/themes/images/v1/facebook_icon.png"/>'},{docked:"bottom",layout:"hbox",defaults:{xtype:"button",flex:1,height:"3em",defaultUnit:"em",scope:b},padding:"0 0.7 1.0 0.7",items:[{margin:"0 0.7 0 0",text:"Decline",handler:function(){b.actions.hide();d.db.setLocalDBAttrib("disableFBReminderMsg",true);_application.getController("client.Viewport").redirectTo("checkin");b.actions.destroy();delete b.actions;c.popUpInProgress=true}},{margin:"0 0.7 0 0",text:"Sign In",ui:"fbBlue",handler:function(){b.actions.hide();var g=_application.getController("client.MainPage");g.fireEvent("facebookTap",null,null,null,null,function(){Ext.device.Notification.show({title:b.titleMsg,message:b.fbPermissionFailMsg,buttons:["Dismiss"],callback:function(q){g._loggingIn=false;var p=c.getViewport();var o=p.getActiveItem();if(!o){Ext.Viewport.setMasked(null);c.resetView();c.redirectTo("login")}else{}}})});b.actions.destroy();delete b.actions;c.popUpInProgress=true}},{text:"Skip",ui:"cancel",handler:function(){b.actions.hide();_application.getController("client.Viewport").redirectTo("checkin");b.actions.destroy();delete b.actions;c.popUpInProgress=true}}]}]}));c.popUpInProgress=true;Ext.Viewport.add(b.actions);b.actions.show()}else{}},postCommon:function(k,a,b,l){var c=this;a=Ext.apply(a,{access_token:d.db.getLocalDB()["fbResponse"]["accessToken"]});Ext.Ajax.request({async:true,disableCaching:false,method:"POST",params:a,url:"https://graph.facebook.com"+k,callback:function(t,h,q){try{var g=Ext.decode(q.responseText);if(h||(q.status==200)){b(g)}else{if(q.status==400){c.facebook_onLogout();Ext.defer(c.facebook_onLogin,1,c,[false,null,true])}else{console.debug("Error Logging into Facebook\nStatus code "+Ext.encode(q.responseText));l(g)}}}catch(s){l(g)}}})},uploadPhoto:function(a,b,c){this.postCommon("/me/photos",a,b,c)},share:function(a,b,c){this.postCommon("/me/feed",a,b,c)},_fb_connect:function(){},_fb_disconnect:function(){this._fb_connect()}});d.fb.initialize()};if(typeof(Genesis)=="undefined"){Genesis={}}window.plugins=window.plugins||{};function printStackTrace(f){var l=(f&&f.e)?f.e:null;var h=f?!!f.guess:true;var k=new printStackTrace.implementation();var g=k.run(l);return(h)?k.guessFunctions(g):g}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(d){var f=this._mode||this.mode();if(f==="other"){return this.other(arguments.callee).join("\n")}else{d=d||(function(){try{(0)()}catch(a){return a}})();var e=(this[f](d));return(typeof(e)=="object")?e.join("\n"):e}},mode:function(){try{(0)()}catch(b){if(b.arguments){return(this._mode="chrome")}else{if(b.stack){return(this._mode="firefox")}else{if(window.opera&&!("stacktrace" in b)){return(this._mode="opera")}}}}return(this._mode="other")},chrome:function(b){if(b.stack){return b.stack.replace(/^.*?\n/,"").replace(/^.*?\n/,"").replace(/^.*?\n/,"").replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split("\n")}else{return""}},firefox:function(b){if(b.stack){return b.stack.replace(/^.*?\n/,"").replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n")}else{return""}},opera:function(l){if(l.message){var q=l.message.split("\n"),e="{anonymous}",m=/Line\s+(\d+).*?script\s+(http\S+)(?:.*?in\s+function\s+(\S+))?/i,o,p,k;for(o=4,p=0,k=q.length;o<k;o+=2){if(m.test(q[o])){q[p++]=(RegExp.$3?RegExp.$3+"()@"+RegExp.$2+RegExp.$1:e+"()@"+RegExp.$2+":"+RegExp.$1)+" -- "+q[o+1].replace(/^\s+/,"")}}q.splice(p,q.length-p);return q}else{return""}},other:function(m){var k="{anonymous}",o=/function\s*([\w\-$]+)?\s*\(/i,l=[],s=0,q,t;var p=10;while(m&&l.length<p){q=o.test(m.toString())?RegExp.$1||k:k;t=Array.prototype.slice.call(m["arguments"]);l[s++]=q+"("+printStackTrace.implementation.prototype.stringifyArguments(t)+")";if(m===m.caller&&window.opera){break}m=m.caller}return l},stringifyArguments:function(d){for(var f=0;f<d.length;++f){var e=d[f];if(e===undefined){d[f]="undefined"}else{if(e===null){d[f]="null"}else{if(e.constructor){if(e.constructor===Array){if(e.length<3){d[f]="["+this.stringifyArguments(e)+"]"}else{d[f]="["+this.stringifyArguments(Array.prototype.slice.call(e,0,1))+"..."+this.stringifyArguments(Array.prototype.slice.call(e,-1))+"]"}}else{if(e.constructor===Object){d[f]="#object"}else{if(e.constructor===Function){d[f]="#function"}else{if(e.constructor===String){d[f]='"'+e+'"'}}}}}}}}return((typeof(d)=="object")?d.join(","):d)},sourceCache:{},ajax:function(d){var c=this.createXMLHTTPObject();if(!c){return}c.open("GET",d,false);c.setRequestHeader("User-Agent","XMLHTTP/1.0");c.send("");return c.responseText},createXMLHTTPObject:function(){var h,f=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var e=0;e<f.length;e++){try{h=f[e]();this.createXMLHTTPObject=f[e];return h}catch(g){}}},getSource:function(b){if(!(b in this.sourceCache)){this.sourceCache[b]=this.ajax(b).split("\n")}return this.sourceCache[b]},guessFunctions:function(k){if(k.length){for(var s=0;s<k.length;++s){var m=/{anonymous}\(.*\)@(\w+:\/\/([-\w\.]+)+(:\d+)?[^:]+):(\d+):?(\d+)?/;var o=k[s],l=m.exec(o);if(l){var t=l[1],p=l[4];if(t&&p){var q=this.guessFunctionName(t,p);k[s]=o.replace("{anonymous}",q)}}}return(typeof(k)=="object")?k.join("\n"):k}return k},guessFunctionName:function(e,f){try{return this.guessFunctionNameFromLines(f,this.getSource(e))}catch(d){return"getSource failed with url: "+e+", exception: "+d.toString()}},guessFunctionNameFromLines:function(m,p){var t=/function ([^(]*)\(([^)]*)\)/;var o=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(function|eval|new Function)/;var k="",s=10;for(var q=0;q<s;++q){k=p[m-q]+k;if(k!==undefined){var l=o.exec(k);if(l&&l[1]){return l[1]}else{l=t.exec(k);if(l&&l[1]){return l[1]}}}}return"(?)"}};var Url={encode:function(b){return escape(this._utf8_encode(b))},decode:function(b){return this._utf8_decode(unescape(b))},_utf8_encode:function(c){c=c.replace(/\r\n/g,"\n");var f="";for(var g=0;g<c.length;g++){var h=c.charCodeAt(g);if(h<128){f+=String.fromCharCode(h)}else{if((h>127)&&(h<2048)){f+=String.fromCharCode((h>>6)|192);f+=String.fromCharCode((h&63)|128)}else{f+=String.fromCharCode((h>>12)|224);f+=String.fromCharCode(((h>>6)&63)|128);f+=String.fromCharCode((h&63)|128)}}}return f},_utf8_decode:function(k){var q="";var o=0;var l=0,m=0,p=0,c=0;while(o<k.length){l=k.charCodeAt(o);if(l<128){q+=String.fromCharCode(l);o++}else{if((l>191)&&(l<224)){p=k.charCodeAt(o+1);q+=String.fromCharCode(((l&31)<<6)|(p&63));o+=2}else{p=k.charCodeAt(o+1);c=k.charCodeAt(o+2);q+=String.fromCharCode(((l&15)<<12)|((p&63)<<6)|(c&63));o+=3}}}return q}};(function(){__initLibExtensions__=function(){Ext.merge(Array.prototype,{binarySearch:function(k,g){var h=0,l=this.length-1,o,m;while(h<=l){o=Math.floor((h+l)/2);m=g(this[o],k);if(m<0){h=o+1;continue}if(m>0){l=o-1;continue}return o}return null}});Ext.merge(String.prototype,{hashCode:function(){for(var d=0,f=0,e=this.length;f<e;f++){d=(31*d+this.charCodeAt(f))<<0}return d},getFuncBody:function(){var b=this.toString();b=b.replace(/[^{]+\{/,"");b=b.substring(0,b.length-1);b=b.replace(/\n/gi,"");if(!b.match(/\(.*\)/gi)){b+=")"}return b},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},stripScripts:function(){return this.replace(new RegExp("<noscript[^>]*?>([\\S\\s]*?)</noscript>","img"),"").replace(new RegExp("<script[^>]*?>([\\S\\s]*?)<\/script>","img"),"").replace(new RegExp("<link[^>]*?>([\\S\\s]*?)</link>","img"),"").replace(new RegExp("<link[^>]*?>","img"),"").replace(new RegExp("<iframe[^>]*?>([\\S\\s]*?)</iframe>","img"),"").replace(new RegExp("<iframe[^>]*?>","img"),"").replace(new RegExp("<embed[^>]*?>([\\S\\s]*?)</embed>","img"),"").replace(new RegExp("<embed[^>]*?>","img"),"").replace(new RegExp("<object[^>]*?>([\\S\\s]*?)</object>","img"),"").replace(new RegExp("<object[^>]*?>","img"),"").replace(new RegExp("<applet[^>]*?>([\\S\\s]*?)</applet>","img"),"").replace(new RegExp("<applet[^>]*?>","img"),"").replace(new RegExp("<button[^>]*?>([\\S\\s]*?)</button>","img"),"").replace(new RegExp("<button[^>]*?>","img"),"").replace(new RegExp("<input[^>]*?>([\\S\\s]*?)</input>","img"),"").replace(new RegExp("<input[^>]*?>","img"),"").replace(new RegExp("<style[^>]*?>([\\S\\s]*?)</style>","img"),"").replace(new RegExp("<style[^>]*?>","img"),"")},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"")},stripComments:function(){return this.replace(/<!(?:--[\s\S]*?--\s*)?>\s*/g,"")},times:function(f){var d="",e;for(e=0;e<f;e++){d+=this}return d},zp:function(b){return("0".times(b-this.length)+this)},capitalize:function(){return this.replace(/\w+/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1)})},uncapitalize:function(){return this.replace(/\w+/g,function(a){return a.charAt(0).toLowerCase()+a.substr(1)})},trim:function(b){if(b=="left"){return this.replace(/^\s*/,"")}if(b=="right"){return this.replace(/\s*$/,"")}if(b=="normalize"){return this.replace(/\s{2,}/g," ").trim()}return this.trim("left").trim("right")},trunc:function(b){return(this.length>(b-4))?this.substring(0,b-4)+" ...":this},htmlEncode:(function(){var g={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;"},e=[],h,f;for(h in g){e.push(h)}f=new RegExp("("+e.join("|")+")","g");return function(a){return(!a)?a:String(a).replace(f,function(b,c){return g[c]})}})(),htmlDecode:(function(){var g={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'},e=[],h,f;for(h in g){e.push(h)}f=new RegExp("("+e.join("|")+"|&#[0-9]{1,5};)","g");return function(a){return(!a)?a:String(a).replace(f,function(b,c){if(c in g){return g[c]}else{return String.fromCharCode(parseInt(c.substr(2),10))}})}})()});Ext.merge(Math,{radians:function(b){return(b*Math.PI/180)}})}})();Genesis.constants={isNfcEnabled:false,userName:"Eric Chan",appMimeType:"application/kickbak",clientVersion:"2.2.0",serverVersion:"2.2.0",themeName:"v1",_thumbnailAttribPrefix:"",_iconPath:"",_iconSize:0,fontSize:0,defaultIconSize:function(){return this._iconSize},site:(location.origin.match(/^file/)?"www":location.host.split(".")[0])+".getkickbak.com",photoSite:"https://s3.amazonaws.com/files.getkickbak.com",resourceSite:"resources/"+((_build=="MobileWeb")?"":"themes/"),debugVPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugRPrivKey:"oSG8JclEHvRy5ngkb6ehWbb6TTRFXd8t",debugVenuePrivKey:"Debug Venue",privKey:null,lastLocalID:null,numSamples:-1,conseqMissThreshold:-1,sigOverlapRatio:-1,s_vol:-1,r_vol:-1,device:null,minDistance:0.3*1000,createAccountMsg:"Create user account using Facebook Profile information",spinnerDom:'<div class="x-loading-spinner-outer"><div class="x-loading-spinner"><span class="x-loading-top"></span><span class="x-loading-right"></span><span class="x-loading-bottom"></span><span class="x-loading-left"></span></div></div>',debugMode:function(){return debugMode},serverHost:function(){return serverHost},init:function(){var c=this,d=1.14;__initLibExtensions__();if(merchantMode){d=(Ext.os.is("Tablet")?1.5*d:1*d)}c.fontSize=Math.floor(((16*d*Math.min(1,window.devicePixelRatio))||(16*d)));if(Ext.os.is("iOS")){c._iconPath="/ios";c._thumbnailAttribPrefix="thumbnail_ios_";c._iconSize=57*(merchantMode?1.5:1);if(debugMode){c.pushNotifAppName="KickBak Dev Latest";c.pushNotifAppId="93D8A-5BE72"}else{c.pushNotifAppName="KickBak Production";c.pushNotifAppId="4fef6fb0691c12.54726991"}c.pushNotifType=1;console.log("Running a iOS System")}else{if(Ext.os.is("Android")||Ext.os.is("Desktop")){if((window.devicePixelRatio==1)||(window.devicePixelRatio>=2)){c._iconSize=48*((merchantMode&&(Ext.os.is("Tablet")))?3:1.2);c._iconPath="/android/mxhdpi";c._thumbnailAttribPrefix="thumbnail_android_mxhdpi_"}else{c._iconSize=36*((merchantMode&&(Ext.os.is("Tablet")))?3:1.5);c._iconPath="/android/lhdpi";c._thumbnailAttribPrefix="thumbnail_android_lhdpi_"}if(debugMode){c.pushNotifAppName="KickBak Dev Latest";c.pushNotifAppId="93D8A-5BE72";c.pushNotifProjectId="658015469194"}else{c.pushNotifAppName="KickBak Production";c.pushNotifAppId="4fef6fb0691c12.54726991";c.pushNotifProjectId="733275653511"}c.pushNotifType=3;console.log("Running a Android or Desktop System")}else{c._iconPath="/ios";c._thumbnailAttribPrefix="thumbnail_ios_";c._iconSize=57;console.log("Running a Unknown System")}}c._iconPath=c.themeName+c._iconPath;console.debug("IconSize = "+c._iconSize+"px")},addCRLF:function(){return("<br/>")},getIconPath:function(d,e,f){return((!f)?"resources/themes/images/"+this._iconPath:this.photoSite+"/"+this._iconPath+"/icons")+"/"+d+"/"+e+".png"}};Genesis.fn={isNative:function(){return window.phoneGapAvailable},filesadded:{},checkloadjscssfile:function(f,k,g){var h=Url.decode(f);var l=this.filesadded[h];if(Ext.isEmpty(l)){l=this.filesadded[h]=[];if(Ext.isFunction(g)){l[0]=false;l[1]=[g];this.loadjscssfile(f,k,false)}else{l[0]=true;this.loadjscssfile(f,k,true)}}else{if(l[0]==true){if(Ext.isFunction(g)){g(true)}}else{if(Ext.isFunction(g)){if(l[1].indexOf(g)<0){l[1].push(g)}}else{console.debug("Do nothing for file["+f+"]")}}}},createjscssfile:function(e,d){var f;e=Url.decode(e);if(d=="js"){f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("src",e)}else{if(d=="css"){f=document.createElement("link");f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("href",e)}}return f},loadjscsstext:function(f,l,h,g){var k;f=Url.decode(f);if(l=="js"){k=document.createElement("script");k.setAttribute("type","text/javascript");k.setAttribute("id",f);k.innerHTML=h}else{if(l=="css"){log("Loading cssfile ("+f+")");k=document.createElement("style");k.setAttribute("id",f);k.setAttribute("rel","stylesheet");k.setAttribute("type","text/css");if(typeof(k.textContent)!="undefined"){k.textContent=h}else{k.styleSheet.cssText=h}}}k.onerror=k.onload=k.onreadystatechange=function(){var a=this.readyState;if(a&&(a!="complete"&&a!="loaded")){return}if(g){g()}};if((typeof k)!=undefined){document.getElementsByTagName("head")[0].appendChild(k)}return k},loadjscssfileCallBackFunc:function(b,k,o){o=Url.decode(o);if(k<100){try{var m=(document.styleSheets[b].href)?document.styleSheets[b].href.replace(location.origin,""):"";console.debug("url = "+m);if(m!=o){for(var l=0;l<document.styleSheets.length;l++){m=(document.styleSheets[l].href)?document.styleSheets[l].href.replace(location.origin,""):"";console.debug("url = "+m);if(m==o){b=l;break}}}if(document.styleSheets[b].cssRules){this.cssOnReadyStateChange(o,false)}else{if(document.styleSheets[b].rules&&document.styleSheets[b].rules.length){this.cssOnReadyStateChange(o,false);return}k++;Ext.defer(this.loadjscssfileCallBackFunc,250,this,[b,k,o]);if((k/25>0)&&(k%25==0)){console.debug("IE Exception : Loading ["+o+"] index["+b+"] try("+k+")")}}}catch(e){k++;if((k/25>0)&&(k%25==0)){console.debug(printStackTrace({e:e}));console.debug("FF Exception : Loading ["+o+"] index["+b+"] try("+k+")")}Ext.defer(this.loadjscssfileCallBackFunc,250,this,[b,k,o])}}else{console.debug("Cannot load ["+o+"], index=["+b+"]");this.cssOnReadyStateChange(o,true)}},scriptOnError:function(b){this.scriptOnReadyStateChange.call(this,b,true)},scriptOnReadyStateChange:function(l,o){var k=this.src;k=k.replace(location.origin,"");if(!o){var g=this.readyState;if(g&&(g!="complete"&&g!="loaded")){return}else{if(!g){}}}else{console.debug("Error Loading JS file["+k+"]")}var m=0,h=Genesis.fn.filesadded[k];if(h){h[0]=true;for(;m<h[1].length;m++){h[1][m](!o)}delete h[1]}else{console.debug("Cannot find callback on JS file["+k+"] index["+m+"]")}},cssOnReadyStateChange:function(e,h){var f=Genesis.fn.filesadded[e];if(f){f[0]=true;var g=0;for(;g<f[1].length;g++){f[1][g](!h)}delete f[1]}else{console.debug("Cannot find callback on CSSS file["+e+"] index["+g+"]")}},loadjscssfile:function(f,k,l){var h;f=Url.decode(f);if(k=="js"){h=document.createElement("script");h.setAttribute("type","text/javascript");if(!l){h.onerror=this.scriptOnError;h.onload=h.onreadystatechange=this.scriptOnReadyStateChange}h.setAttribute("src",f);document.getElementsByTagName("head")[0].appendChild(h)}else{if(k=="css"){var g=document.styleSheets.length;h=document.createElement("link");h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");h.setAttribute("media","screen");h.setAttribute("href",f);document.getElementsByTagName("head")[0].appendChild(h);if(!l){Ext.defer(this.loadjscssfileCallBackFunc,50,this,[g,0,f])}}}},removejscssfile:function(k,s){k=Url.decode(k);var m=escape(k);var p=(s=="js")?"script":(s=="css")?"link":"none";var q=(s=="js")?"src":(s=="css")?"href":"none";var o=document.getElementsByTagName(p);for(var t=o.length;t>=0;t--){if(o[t]){var l=escape(o[t].getAttribute(q));if(l!=null&&((l==m)||(l.search(m)!=-1))){o[t].disabled=true;o[t].parentNode.removeChild(o[t]);delete Genesis.fn.filesadded[k]}}}},findjscssfile:function(h,p){h=Url.decode(h);var m=(p=="js")?"script":(p=="css")?"style":"none";var o=(p=="js")?"id":(p=="css")?"id":"none";var l=document.getElementsByTagName(m);for(var q=l.length;q>=0;q--){if(l[q]){var k=l[q].getAttribute(o);if(k!=null&&k.search(h)!=-1){return l[q]}}}return null},removejscsstext:function(h,p){h=Url.decode(h);var m=(p=="js")?"script":(p=="css")?"style":"none";var o=(p=="js")?"id":(p=="css")?"id":"none";var l=document.getElementsByTagName(m);for(var q=l.length;q>=0;q--){if(l[q]){var k=l[q].getAttribute(o);if(k!=null&&((k==h)||(k.search(h)!=-1))){l[q].parentNode.removeChild(l[q]);delete Genesis.fn.filesadded[h]}}}},replacejscssfile:function(p,m,t){m=Url.decode(m);p=Url.decode(p);var q=(t=="js")?"script":(t=="css")?"link":"none";var s=(t=="js")?"src":(t=="css")?"href":"none";var o=document.getElementsByTagName(q);for(var k=o.length;k>=0;k--){if(o[k]&&o[k].getAttribute(s)!=null&&o[k].getAttribute(s).indexOf(p)!=-1){var l=this.createjscssfile(m,t);o[k].parentNode.replaceChild(l,o[k]);delete this.filesadded[p];this.filesadded[m]=[true]}}},systemTime:(new Date()).getTime(),clientTime:(new Date()).getTime(),weekday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],convertDateCommon:function(s,l,m){var q;var o=l||this.dateFormat;if(!(s instanceof Date)){if(typeof(JSON)!="undefined"){}if(Ext.isEmpty(s)){q=new Date()}else{if(o){q=Date.parse(s,o);if(Ext.isEmpty(q)){q=new Date(s).format(o)}return[q,q]}q=new Date(s);if(q.toString()=="Invalid Date"){q=Date.parse(s,o)}}}else{q=s}if(!m){var t=new Date().getTime();var p=this.currentDateTime(t);var k=(p-q.getTime())/1000;if(k>-10){if((k)<2){return[k,"a sec ago"]}if((k)<60){return[k,parseInt(k)+" secs ago"]}k=k/60;if((k)<2){return[k,"a min ago"]}if((k)<60){return[k,parseInt(k)+" mins ago"]}k=k/60;if((k)<2){return[q,"1 hr ago"]}if((k)<24){return[q,parseInt(k)+" hrs ago"]}k=k/24;if(((k)<2)&&((new Date().getDay()-q.getDay())==1)){return[q,"Yesterday at "+q.format("g:i A")]}if((k)<7){return[q,this.weekday[q.getDay()]+" at "+q.format("g:i A")]}k=k/7;if(((k)<2)&&(k%7==0)){return[q,"1 wk ago"]}if(((k)<5)&&(k%7==0)){return[q,parseInt(k)+" wks ago"]}if(k<5){return[q,parseInt(k*7)+" days ago"]}return[q,null]}else{}}return[q,-1]},convertDateFullTime:function(b){return b.format("D, M d, Y \\a\\t g:i A")},convertDateReminder:function(t){var k=new Date();var l=k.getDate();var o=k.getMonth();var q=k.getFullYear();var s=t.getDate();var m=t.getMonth();var p=t.getFullYear();if(l==s&&o==m&&q==p){return"Today "+t.format("g:i A")}return t.format("D g:i A")},convertDate:function(d,e){var f=this.convertDateCommon(d,e);if(f[1]!=-1){return(f[1]==null)?f[0].format("M d, Y"):f[1]}else{return f[0].format("D, M d, Y \\a\\t g:i A")}},convertDateNoTime:function(d){var c=this.convertDateCommon(d,null,true);if(c[1]!=-1){return(c[1]==null)?c[0].format("D, M d, Y"):c[1]}else{return c[0].format("D, M d, Y")}},convertDateNoTimeNoWeek:function(d){var c=this.convertDateCommon(d,null,true);if(c[1]!=-1){c=(c[1]==null)?c[0].format("M d, Y"):c[1]}else{c=c[0].format("M d, Y")}return c},convertDateInMins:function(d){var c=this.convertDateCommon(d,null,true);if(c[1]!=-1){return(c[1]==null)?c[0].format("h:ia T"):c[1]}else{return c[0].format("h:ia T")}},currentDateTime:function(b){return(this.systemTime-this.clientTime)+b},addUnit:function(c,d){return c+((!d)?"px":d)},_removeUnitRegex:/(\d+)px/,removeUnit:function(b){return b.match(this._removeUnitRegex)[1]},calcPx:function(d,c){return Math.floor((d*c*Genesis.constants.fontSize))},calcEm:function(d,c){return Math.floor(d/Genesis.constants.fontSize/c)},failFileHandler:function(d){var f={};f[FileError.NOT_FOUND_ERR]="File not found";f[FileError.SECURITY_ERR]="Security error";f[FileError.ABORT_ERR]="Abort error";f[FileError.NOT_READABLE_ERR]="Not readable";f[FileError.ENCODING_ERR]="Encoding error";f[FileError.NO_MODIFICATION_ALLOWED_ERR]="No mobification allowed";f[FileError.INVALID_STATE_ERR]="Invalid state";f[FileError.SYFNTAX_ERR]="Syntax error";f[FileError.INVALID_MODIFICATION_ERR]="Invalid modification";f[FileError.QUOTA_EXCEEDED_ERR]="Quota exceeded";f[FileError.TYPE_MISMATCH_ERR]="Type mismatch";f[FileError.PATH_EXISTS_ERR]="Path does not exist";var e={};e[FileTransferError.FILE_NOT_FOUND_ERR]="File not found";e[FileTransferError.INVALID_URL_ERR]="Invalid URL Error";e[FileTransferError.CONNECTION_ERR]="Connection Error";console.log("File Error - ["+f[d.code]+"]")},readFile:function(l,k){var m=this,o;var h=function(a){m.failFileHandler(a);k(null)};if(Genesis.fn.isNative()){var g=function(a){a.file(function(b){var c=new FileReader();c.onloadend=function(d){k(d.target.result)};c.readAsText(o)},h)};window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(a){if(Ext.os.is("iOS")){o=(a.root.fullPath+"/../"+appName+".app/www/")+l}else{if(Ext.os.is("Android")){o=(appName+"/")+l}}console.debug("Reading from File - ["+o+"]");a.root.getFile(o,null,g,h)},h)}else{k(true)}},writeFile:function(m,o,l){var p=this,h;var k=function(a){p.failFileHandler(a);l(false)};if(Genesis.fn.isNative()){var q=function(a){console.debug("Created File - ["+h+"]");a.createWriter(function(b){console.debug("Writing to File - ["+h+"], Content - ["+o+"]");b.onwrite=function(c){console.debug("Write End Callback - ["+Ext.encode(c)+"]");l(true)};b.write(o)},k)};window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(a){if(Ext.os.is("iOS")){h=(a.root.fullPath+"/../"+appName+".app/www/")+m}else{if(Ext.os.is("Android")){h=(appName+"/")+m}}a.root.getDirectory(h.substring(0,h.lastIndexOf("/")),{create:true});a.root.getFile(h,{create:true,exclusive:false},q,k)},k)}else{l()}},getPrivKey:function(f,d){var e=this;d=d||Ext.emptyFn;if(!e.privKey){if(!Genesis.fn.isNative()){e.privKey={v1:e.debugVPrivKey,r1:e.debugRPrivKey,venue:e.debugVenuePrivKey,venueId:1}}else{e.privKey={}}}return((f)?e.privKey[f]:e.privKey)},printProximityConfig:function(){var b=Genesis.constants;console.debug("ProximityID Configuration");console.debug("=========================");console.debug("\nSignal Samples["+b.numSamples+"]\nMissed Threshold["+b.conseqMissThreshold+"]\nSignal Overlap Ratio["+b.sigOverlapRatio+"]\nDefault Volume["+b.s_vol+"%]\n")},processSendLocalID:function(e,g){var h,f=null;if(e.freqs){Genesis.constants.lastLocalID=e.freqs}h=Genesis.constants.lastLocalID;if(h){f="LocalID=["+h[0]+", "+h[1]+", "+h[2]+"]"}return({message:f,localID:h,cancelFn:g})},processRecvLocalID:function(d){var e=null;var f=d.freqs;if(f){e="LocalID=["+f[0]+", "+f[1]+", "+f[2]+"]"}else{console.log("Already listening for LocalID ...")}return({message:e,localID:f})}};Genesis.db={_localDB:null,getLocalStorage:function(){return window.localStorage},getRedeemIndexDB:function(d){try{if(!this.kickbakRedeemIndex){this.kickbakRedeemIndex=Ext.decode(this.getLocalStorage().getItem("kickbakRedeemIndex"))}}catch(c){}if(!this.kickbakRedeemIndex){this.kickbakRedeemIndex={}}return(d?this.kickbakRedeemIndex[d]:this.kickbakRedeemIndex)},addRedeemIndexDB:function(d,f){var e=this.getRedeemIndexDB();e[d]=f;console.debug("Add to KickBak Redeem DB["+d+"]")},setRedeemIndexDB:function(b){},getRedeemSortedDB:function(d){try{if(!this.kickbakRedeemSorted){this.kickbakRedeemSorted=Ext.decode(this.getLocalStorage().getItem("kickbakRedeemSorted"))}}catch(c){}if(!this.kickbakRedeemSorted){this.kickbakRedeemSorted=[]}return(d?this.kickbakRedeemSorted[d]:this.kickbakRedeemSorted)},getLocalDB:function(){return(!this._localDB)?(this._localDB=Ext.decode(this.getLocalStorage().getItem("kickbak")||"{}")):this._localDB},setLocalDB:function(b){this._localDB=b;this.getLocalStorage().setItem("kickbak",Ext.encode(b))},setLocalDBAttrib:function(f,d){var e=this.getLocalDB();e[f]=d;this.setLocalDB(e)},removeLocalDBAttrib:function(c){var d=this.getLocalDB();if(typeof(d[c])!="undefined"){delete d[c];this.setLocalDB(d)}},openDatabase:function(){return openDatabase("KickBak","1.0","KickBakDB",2*1024*1024)},getReferralDBAttrib:function(c){var d=this.getReferralDB();return d[c]},addReferralDBAttrib:function(d,f){var e=this.getReferralDB();e[d]=f;this.setReferralDB(e)},removeReferralDBAttrib:function(c){var d=this.getReferralDB();delete d[c];this.setReferralDB(d)},getReferralDB:function(){var b=this.getLocalStorage().getItem("kickbakreferral");return((b)?Ext.decode(b):{})},setReferralDB:function(b){console.debug("Setting Referral DB["+Ext.encode(b)+"]");this.getLocalStorage().setItem("kickbakreferral",Ext.encode(b))},resetStorage:function(){var f=Genesis.db.getLocalDB(),h;if(f.fbLoginInProgress){return}if(Genesis.fb){Genesis.fb.facebook_onLogout(null,false)}f=this.getLocalStorage();for(h in f){if((h=="kickbak")||(h=="kickbakreferral")){try{f.removeItem(h)}catch(g){}console.debug("Removed ["+h+"]")}}this._localDB=null;Ext.data.Model.cache={};var e="DROP TABLE Customer";var f=Genesis.db.openDatabase();f.transaction(function(a){a.executeSql(e,[],function(b,c){console.debug("ResetStorage --- Successfully drop KickBak-Customers Table")},function(c,b){console.debug("Failed to drop KickBak-Customers Table : "+b.message)})})}};window.plugins=window.plugins||{};(function(cordova){var preLoadSendCommon=function(cntlr,win){Ext.Viewport.setMasked({xtype:"loadmask",message:cntlr.prepareToSendMerchantDeviceMsg});return Ext.bind(function(_cntlr,_win){var viewport=cntlr.getViewPortCntlr();_win=_win||Ext.emptyFn;Ext.Viewport.setMasked(null);Ext.defer(function(){if(!_cntlr._actions){_cntlr._actions=Ext.create("Genesis.view.widgets.PopupItemDetail",{iconType:"prizewon",icon:"phoneInHand",title:cntlr.showToServerMsg(),buttons:[{margin:"0 0 0.5 0",text:"Proceed",ui:"action",height:"3em",handler:function(){viewport.popUpInProgress=false;_cntlr._actions.hide();_win()}},{text:"Cancel",ui:"cancel",height:"3em",handler:function(){_cntlr._actions.hide();viewport.popUpInProgress=false}}]});Ext.Viewport.add(_cntlr._actions)}viewport.popUpInProgress=true;_cntlr._actions.show()},0.25*1000,_cntlr)},null,[cntlr,win])};if(cordova){window.plugins.proximityID={init:function(s_vol_ratio,r_vol_ratio){cordova.exec(function(){console.log("ProximityIDPlugin Initialized")},function(reason){console.log("Failed to initialize the ProximityIDPlugin! Reason["+reason+"]")},"ProximityIDPlugin","init",[s_vol_ratio+"",r_vol_ratio+""])},preLoadSend:function(cntlr,win,fail){var callback=preLoadSendCommon(cntlr,win);Ext.defer(function(){cordova.exec(callback,fail,"ProximityIDPlugin","preLoadIdentity",[])},0.25*1000,this)},send:function(win,fail){cordova.exec(win,fail,"ProximityIDPlugin","sendIdentity",[])},scan:function(win,fail,samples,missedThreshold,magThreshold,overlapRatio){cordova.exec(win,fail,"ProximityIDPlugin","scanIdentity",[samples,missedThreshold,magThreshold,overlapRatio])},stop:function(){cordova.exec(function(){console.log("Stopped ProximityIDPlugin")},function(reason){console.log("Failed to stop the ProximityIDPlugin "+reason)},"ProximityIDPlugin","stop",[])},setVolume:function(vol){cordova.exec(Ext.emptyFn,Ext.emptyFn,"ProximityIDPlugin","setVolume",[vol])}};cordova.addConstructor(function(){})}else{_filesAssetCount++;window.plugins.proximityID={loFreq:17000,hiFreq:20000,FREQ_GAP:500,NUM_SIGNALS:3,SHORT_MAX:parseInt(65535/2),sampleRate:44100,duration:2*44100,bufSize:16*1024,bitRate:128,MATCH_THRESHOLD:2,bw:0,sampleConfig:null,freqs:null,context:null,gainNode:null,oscillators:null,audio:null,bytesEncoded:null,unsupportedBrowserMsg:"This browser does not support our Proximity Scanning feature",convertToMono:function(input){var me=this;var splitter=me.context.createChannelSplitter(2);var merger=me.context.createChannelMerger(2);input.connect(splitter);splitter.connect(merger,0,0);splitter.connect(merger,0,1);return merger},init:function(s_vol_ratio,r_vol_ratio){var me=this;me.bw=(me.hiFreq-me.loFreq)/me.NUM_SIGNALS;Genesis.constants.s_vol=s_vol_ratio*100;Genesis.constants.r_vol=r_vol_ratio*100;console.debug("Initialized Proximity API")},generateData:function(offset,length){var me=this,i,c,s_vol=Genesis.constants.s_vol/100,data=new Float32Array(length);c=[];for(i=0;i<me.freqs.length;i++){c[i]=2*Math.PI*me.freqs[i]/me.sampleRate}for(i=0;i<length;i++){for(j=0;j<me.freqs.length;j++){data[i]+=Math.sin(c[j]*(i+offset))}data[i]=s_vol*data[i]/me.freqs.length}return data},createAudioLoop:function(){var me=this;me.audio.addEventListener("ended",function(){this.currentTime=0;this.play()},false);me.audio.volume=1},webAudioFnHandler:function(s_vol){var me=this;if(!me.context){me.context=new webkitAudioContext();me.gainNode=me.context.createGainNode();me.gainNode.connect(me.context.destination)}me.getFreqs();me.gainNode.gain.value=s_vol;me.oscillators=[];for(i=0;i<me.freqs.length;i++){var osc=me.oscillators[i]=me.context.createOscillator();osc.type=0;osc.frequency.value=me.freqs[i];osc.connect(me.gainNode)}console.debug("OSC Gain : "+s_vol)},audioFnHandler:function(config,s_vol,win){var me=this,data=config.data=[];me.getFreqs();for(var i=0;i<(me.duration);i++){var val=0;for(var j=0;j<me.freqs.length;j++){val+=Math.sin(2*Math.PI*me.freqs[j]*i/me.sampleRate)}val/=me.freqs.length;val=Math.round(s_vol*((me.SHORT_MAX+1)+(val*me.SHORT_MAX)));data[i]=val}me.audio=new Audio(new RIFFWAVE(config).dataURI);me.createAudioLoop();console.debug("WAV Gain : "+s_vol);win()},mp3WorkerFnHandler:function(e){var me=this;switch(e.data.cmd){case"init":me._duration=me.duration;me.bytesEncoded=Math.min(me._duration,me.bufSize);delete me.sampleConfig.data;_codec.postMessage({cmd:"encode",buf:me.generateData(0,me.bytesEncoded)});break;case"data":if(!me.sampleConfig.data){me.sampleConfig.data=String.fromCharCode.apply(null,e.data.buf)}else{me.sampleConfig.data+=String.fromCharCode.apply(null,e.data.buf)}me._duration-=me.bytesEncoded;if(me._duration>0){me.bytesEncoded=Math.min(me._duration,me.bufSize);_codec.postMessage({cmd:"encode",buf:me.generateData(me.duration-me._duration,me.bytesEncoded)})}else{_codec.postMessage({cmd:"finish"})}break;case"end":me.sampleConfig.data+=String.fromCharCode.apply(null,e.data.buf);me.sampleConfig.data="data:audio/mpeg;base64,"+base64.encode(me.sampleConfig.data);me.audio=new Audio(me.sampleConfig.data);me.createAudioLoop();console.debug("MP3 Gain : "+Genesis.constants.s_vol/100);me.sampleConfig.callback();delete me.sampleConfig}},mp3FnHandler:function(config,s_vol,win){var me=this;if(!_codec.onmessage||(_codec.onmessage==Ext.emptyFn)){_codec.onmessage=Ext.bind(me.mp3WorkerFnHandler,me)}me.getFreqs();config.callback=win;me.sampleConfig=config;_codec.postMessage({cmd:"init",config:{samplerate:me.sampleRate,bitrate:me.bitRate,mode:3,channels:1}})},getFreqs:function(){var me=this,stay,i;do{stay=false;for(i=0;i<me.NUM_SIGNALS-1;i++){me.freqs[i]=parseInt(Math.random()*me.bw)+parseInt(i*me.bw)+parseInt(me.loFreq)}i=me.NUM_SIGNALS-1;me.freqs[i]=parseInt(Math.random()/2*me.bw)+parseInt(i*me.bw)+parseInt(me.loFreq);for(i=0;i<(me.NUM_SIGNALS-1);i++){if((me.freqs[i]+me.FREQ_GAP)>me.freqs[i+1]){stay=true;break}}}while(stay)},preLoadSend:function(cntlr,win,fail){var me=this,s_vol=Genesis.constants.s_vol/100,callback=preLoadSendCommon(cntlr,win),config={header:{sampleRate:me.sampleRate,numChannels:1,bitsPerSample:16},data:[]};me.freqs=[];if(typeof(webkitAudioContext)!="undefined"){me.webAudioFnHandler(s_vol);callback()}else{if(!_codec){me.duration=1*44100;Ext.defer(me.audioFnHandler,0.25*1000,me,[config,s_vol,callback])}else{me.duration=1*44100;Ext.defer(me.mp3FnHandler,0.25*1000,me,[config,s_vol,callback])}}},send:function(win,fail){var me=this;if(me.oscillators){for(var i=0;i<me.freqs.length;i++){me.oscillators[i].noteOn&&me.oscillators[i].noteOn(0)}win({freqs:me.freqs})}else{if(me.audio){me.audio.play();win({freqs:me.freqs})}else{fail()}}},scan:function(win,fail,samples,missedThreshold,magThreshold,overlapRatio){var me=this,context=me.context,matchCount=0;if(!me.context){context=me.context=new webkitAudioContext()}if(!me.javascriptNode){me.javascriptNode=context.createJavaScriptNode(me.bufSize,1,1);me.javascriptNode.onaudioprocess=function(e){me.fftWorker.postMessage({cmd:"forward",buf:e.inputBuffer.getChannelData(0)})};if(!me.fftWorker){var worker=me.fftWorker=new Worker("worker/fft.min.js");worker.onmessage=function(e){var i,result=eval("["+e.data+"]")[0];switch(result.cmd){case"init":console.debug("Local Identity Detector Initialized");break;case"forward":console.debug("Matching Freqs = ["+result.freqs+"]");if(me.freqs){for(i=0;i<result.freqs.length;i++){if(me.freqs[i]!=result.freqs[i]){break}}if(i!=result.freqs.length){matchCount=0;delete me.freqs}else{matchCount++}}else{me.freqs=result.freqs}if(matchCount>=me.MATCH_THRESHOLD){win({freqs:me.freqs})}break}};worker.postMessage({cmd:"init",config:{sampleRate:me.sampleRate,fftSize:me.bufSize}})}}if(navigator.webkitGetUserMedia){navigator.webkitGetUserMedia({audio:true},function(stream){if(me.microphone){me.microphone.disconnect()}delete me.freqs;me.microphone=me.convertToMono(context.createMediaStreamSource(stream));me.javascriptNode.connect(me.context.destination);me.microphone.connect(me.javascriptNode);console.debug("Local Identity detecting host ...")})}else{Ext.device.Notification.show({title:"Local Identity",message:me.unsupportedBrowserMsg,buttons:["OK"],callback:Ext.emptyFn})}},stop:function(){var me=this;if(me.oscillators){for(var i=0;i<me.freqs.length;i++){me.oscillators[i].disconnect()}delete me.oscillators}else{if(me.audio){me.audio.pause();me.audio.currentTime=0;delete me.audio}}if(me.microphone){me.javascriptNode.disconnect();me.microphone.disconnect();delete me.microphone}},setVolume:function(vol){var me=this;if(me.context){if(me.gainNode){me.gainNode.gain.value=Math.max(0,vol/100)}}else{if(me.audio){me.audio.volume=vol/100}}}}}})(window.cordova||window.Cordova||window.PhoneGap);