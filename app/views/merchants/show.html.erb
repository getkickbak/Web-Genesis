<% content_for :link do %>
<link rel="stylesheet" href="/javascripts/desktop/css/pages/merchant.css"/>
<% end %>
<% content_for :script do %>
<script type="text/javascript" src="/javascripts/desktop/src/base.js"></script>
<script type="text/javascript" src="/javascripts/desktop/src/venue.js"></script>
<% end %>
<div class="main">
	<div class="main-inner">
		<div class="container">
			<div class="row">
				<div class="span4">
					<div class="widget">
						<div class="widget-content">
							<div>
								<div class="sub-header"><h4><%= @merchant.name %></h4></div>
								<div class="merchant-photo">
									<%= image_tag @merchant.photo.url %>
								</div>
								<div class="merchant-website">
									<%= link_to @merchant.website, @merchant.website %>
								</div>
								<div>
									<div class="sub-header">
										<h5>Locations</h5>
									</div>
									<% @merchant.venues.each do |venue| %>
									<address>
										<%= venue.name %><br>
										<%= venue.address %><br>
										<%= "#{venue.city}, #{venue.state} #{venue.zipcode}" %><br>
										<%= number_to_phone(venue.phone) %>
									</address>
									<% end %>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="span8">
					<div class="widget">
						<div class="widget-content">
							<div class="sub-header"><h5>About Us</h5></div>
							<div>
								<p>
									<%= @merchant.description %>
								</p>
							</div>
						</div>
					</div>
					<div class="widget">
						<div class="widget-content">
							<p class="lead">
								You have <span class="merchant-points"><%= @customer.points %> points</span> and <span class="merchant-points"><%= @customer.prize_points %> prize points</span>
							</p>
							<div>
								<% if @customer.badge.custom %>
								<%= image_tag @customer.badge.custom_type.thumbnail_medium_url, :class => "pull-left merchant-badge" %>
								<div>
									<p class="sub-lead">You are our <span class="merchant-badge-name"><%= @customer.badge.custom_type.display_value %></span></p>
									<p class="sub-lead"><%= @next_badge.visits - @customer.next_badge_visits %> more visits to be our <span class="merchant-badge-name"><%= @next_badge.custom_type.display_value %></span></p>
								</div>
								<% else %>
								<%= image_tag @customer.badge.type.thumbnail_medium_url, :class => "pull-left merchant-badge" %>
								<div>
									<p class="sub-lead">You are our <span class="merchant-badge-name"><%= @customer.badge.type.display_value %></span></p>
									<p class="sub-lead"><%=@next_badge.visits - @customer.next_badge_visits %> more visits to be our <span class="merchant-badge-name"><%= @next_badge.type.display_value %></span></p>
								</div>
								<% end %>
							</div>
						</div>
					</div>
					<% rewards = @customer_rewards.all(:mode => :reward, :order => [:points.asc]) %>
					<% prizes = @customer_rewards.all(:mode => :prize, :order => [:points.asc]) %>
					<div class="widget widget-table action-table">
						<div class="widget-header">
							<i class="icon-gift"></i>
							<h3>Rewards</h3>
						</div>
						<div class="widget-content">
							<table class="table">
								<thead>
									<tr>
										<th>Rewards</th>
										<th class="td-actions">Points</th>
									</tr>
								</thead>
								<tbody>
									<% rewards.each do |customer_reward| %>
									<tr>
										<td>
											<% if customer_reward.photo_url.to_s.empty? %>
											<%= image_tag Common.get_default_customer_reward_file_path(@merchant.type.value, customer_reward.type.value, :ios, :mxhdpi), :style => "width:50px;margin-right:10px;" %>
											<% else %>
											<%= image_tag customer_reward.photo.thumbnail_ios_small.url, :style => "width:50px;margin-right:10px;" %>
											<% end %>
											<%= customer_reward.title %>
										</td>
										<td class="td-actions"><%= customer_reward.points %></td>
									</tr>
									<% end %>
								</tbody>
							</table>
						</div>
					</div>
					<div class="widget widget-table action-table">
						<div class="widget-header">
							<i class="icon-star"></i>
							<h3>Prizes</h3>
						</div>
						<div class="widget-content">
							<table class="table">
								<thead>
									<tr>
										<th>Prizes</th>
										<th class="td-actions">Points</th>
									</tr>
								</thead>
								<tbody>
									<% prizes.each do |customer_reward| %>
									<tr>
										<td>
											<% if customer_reward.photo_url.to_s.empty? %>
											<%= image_tag Common.get_default_customer_reward_file_path(@merchant.type.value, customer_reward.type.value, :ios, :mxhdpi), :style => "width:50px;margin-right:10px;" %>
											<% else %>
											<%= image_tag customer_reward.photo.thumbnail_ios_small.url, :style => "width:50px;margin-right:10px;" %>
											<% end %>
											<%= customer_reward.title %>
										</td>
										<td class="td-actions"><%= customer_reward.points %></td>
									</tr>
									<% end %>
								</tbody>
							</table>
						</div>
					</div>
					<!-- -->
				</div>
			</div>
		</div>
	</div>
</div>
